//   _  /._  _  r13.dissolve 2018-09-14 3:52pm
//  /_|///_'/ /
Promise.create=function(){let t,e;const i=new Promise(function(i,s){t=i,e=s});return i.resolve=t,i.reject=e,i},Math.sign=function(t){return 0===(t=+t)||isNaN(t)?Number(t):t>0?1:-1},Math.degrees=function(t){return t*(180/Math.PI)},Math.radians=function(t){return t*(Math.PI/180)},Math.clamp=function(t,e,i){return Math.min(Math.max(t,Math.min(e,i)),Math.max(e,i))},Math.range=function(t,e,i,s,n,r){const a=(t-e)*(n-s)/(i-e)+s;return r?Math.clamp(a,s,n):a},Math.mix=function(t,e,i){return t*(1-i)+e*i},Math.step=function(t,e){return e<t?0:1},Math.smoothStep=function(t,e,i){const s=Math.max(0,Math.min(1,(i-t)/(e-t)));return s*s*(3-2*s)},Math.fract=function(t){return t-Math.floor(t)},Math.mod=function(t,e){return(t%e+e)%e},Array.prototype.shuffle=function(){let t,e,i=this.length;for(;0!==i;)e=Math.floor(Math.random()*i),t=this[i-=1],this[i]=this[e],this[e]=t;return this},Array.storeRandom=function(t){t.randomStore=[]},Array.prototype.random=function(t){let e=Math.floor(Math.random()*this.length);if(t&&!this.randomStore&&Array.storeRandom(this),!this.randomStore)return this[e];if(t>this.length-1&&(t=this.length),t>1){for(;~this.randomStore.indexOf(e);)e++>this.length-1&&(e=0);this.randomStore.push(e),this.randomStore.length>=t&&this.randomStore.shift()}return this[e]},Array.prototype.remove=function(t){const e=this.indexOf(t);if(~e)return this.splice(e,1)},Array.prototype.last=function(){return this[this.length-1]},String.prototype.includes=function(t){if(!Array.isArray(t))return~this.indexOf(t);for(let e=0;e<t.length;e++)if(~this.indexOf(t[e]))return!0;return!1},String.prototype.clip=function(t,e){return this.length>t?this.slice(0,t)+e:this},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.replaceAll=function(t,e){return this.split(t).join(e)},Date.prototype.addDays=function(t){const e=new Date(this.valueOf());return e.setDate(e.getDate()+t),e},window.get=function(t,e={}){const i=Promise.create();return e.method="GET",window.fetch(t,e).then(function(t){if(!t.ok)return i.reject(t);t.text().then(function(t){if(t.charAt(0).includes(["[","{"]))try{i.resolve(JSON.parse(t))}catch(e){i.resolve(t)}else i.resolve(t)})}).catch(i.reject),i},window.post=function(t,e,i={}){const s=Promise.create();return i.method="POST",i.body=JSON.stringify(e),window.fetch(t,i).then(function(t){if(!t.ok)return s.reject(t);t.text().then(function(t){if(t.charAt(0).includes(["[","{"]))try{s.resolve(JSON.parse(t))}catch(e){s.resolve(t)}else s.resolve(t)})}).catch(s.reject),s},window.getURL=function(t,e="_blank"){window.open(t,e)},window.Config||(window.Config={}),window.Global||(window.Global={});class Utils{static random(t,e,i=0){if(void 0===t)return Math.random();if(t===e)return t;t=t||0,e=e||1;const s=Math.pow(10,i);return Math.round((t+Math.random()*(e-t))*s)/s}static headsTails(t,e){return this.random(0,1)?e:t}static queryString(t){const e=decodeURI(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+encodeURI(t).replace(/[.+*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"));return!(!e.length||"0"===e||"false"===e)&&e}static getConstructorName(t){return t.constructor.name||t.constructor.toString().match(/function ([^(]+)/)[1]}static nullObject(t){for(let e in t)void 0!==t[e]&&(t[e]=null);return null}static cloneObject(t){return JSON.parse(JSON.stringify(t))}static mergeObject(...t){const e={};for(let i of t)for(let t in i)e[t]=i[t];return e}static toArray(t){return Object.keys(t).map(e=>t[e])}static cloneArray(t){return t.slice(0)}static basename(t,e){const i=t.split("/").last();return e?i:i.split(".")[0]}static extension(t){return t.split(".").last().split("?")[0].toLowerCase()}static base64(t){return window.btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,(t,e)=>String.fromCharCode("0x"+e)))}static date(t){const e=t.split(/[^0-9]/);return new Date(e[0],e[1]-1,e[2],e[3],e[4],e[5])}static timestamp(){return(Date.now()+this.random(0,99999)).toString()}static pad(t){return t<10?"0"+t:t}static get hash(){return window.location.hash.slice(1)}}class Render{static init(){const t=this,e=[],i=200;let s=performance.now();function n(r){const a=Math.min(i,r-s);s=r,t.TIME=r,t.DELTA=a;for(let t=e.length-1;t>=0;t--){const i=e[t];if(i)if(i.fps){if(r-i.last<1e3/i.fps)continue;i(++i.frame),i.last=r}else i(r,a);else e.remove(i)}t.paused||requestAnimationFrame(n)}requestAnimationFrame(n),this.start=((t,i)=>{i&&(t.fps=i,t.last=-1/0,t.frame=-1),~e.indexOf(t)||e.unshift(t)}),this.stop=(t=>{e.remove(t)}),this.tick=(()=>{this.TIME=performance.now(),n(this.TIME)}),this.pause=(()=>{this.paused=!0}),this.resume=(()=>{this.paused&&(this.paused=!1,requestAnimationFrame(n))})}}Render.init();class Timer{static init(){const t=[],e=[];Render.start(function(i,s){for(let i=0;i<e.length;i++){const s=e[i];s.callback=null,t.remove(s)}e.length&&(e.length=0);for(let i=0;i<t.length;i++){const n=t[i];n?(n.current+=s)>=n.time&&(n.callback&&n.callback(...n.args),e.push(n)):t.remove(n)}}),this.clearTimeout=(e=>{const i=function(e){for(let i=0;i<t.length;i++)if(t[i].ref===e)return t[i];return null}(e);return!!i&&(i.callback=null,t.remove(i),!0)}),this.create=((e,i=1,...s)=>{const n={time:Math.max(1,i),current:0,ref:Utils.timestamp(),callback:e,args:s};return t.push(n),n.ref}),window.defer=this.defer=(t=>this.create(t,1))}}Timer.init();class Events{constructor(){class t{constructor(){this.events=[],this.links=[]}add(t,e,i){this.events.push({event:t,callback:e,object:i})}remove(t,e){for(let i=this.events.length-1;i>=0;i--)this.events[i].event===t&&this.events[i].callback===e&&(this.events[i].removed=!0,this.events.splice(i,1)[0]=null)}fire(t,e={}){let i=!1;const s=Utils.cloneArray(this.events);for(let n=0;n<s.length;n++)s[n].event!==t||s[n].removed||(s[n].callback(e),i=!0);return i}destroy(t){for(let e=this.events.length-1;e>=0;e--)this.events[e].object===t&&(this.events.splice(e,1)[0]=null)}link(t){~this.links.indexOf(t)||this.links.push(t)}}Events.initialized||(Events.emitter=new t,Events.VISIBILITY="visibility",Events.KEYBOARD_PRESS="keyboard_press",Events.KEYBOARD_DOWN="keyboard_down",Events.KEYBOARD_UP="keyboard_up",Events.RESIZE="resize",Events.COMPLETE="complete",Events.PROGRESS="progress",Events.UPDATE="update",Events.LOADED="loaded",Events.ERROR="error",Events.READY="ready",Events.HOVER="hover",Events.CLICK="click",Events.initialized=!0);const e=[];this.emitter=new t,this.add=((t,i,s)=>{if("object"!=typeof t&&(s=i,i=t,t=null),t){const n=t.events.emitter;n.add(i,s,this),n.link(this),e.push(n)}else Events.emitter.add(i,s,this)}),this.remove=((t,e,i)=>{"object"!=typeof t&&(i=e,e=t,t=null),t?t.events.emitter.remove(e,i):Events.emitter.remove(e,i)}),this.fire=((t,e={},i)=>{this.emitter.fire(t,e)||i||Events.emitter.fire(t,e)}),this.bubble=((t,e)=>{this.add(t,e,t=>this.fire(e,t))}),this.destroy=(()=>(Events.emitter.destroy(this),e.forEach(t=>t.destroy(this)),this.emitter.links.forEach(t=>{t.unlink&&t.unlink(this.emitter)}),Utils.nullObject(this))),this.unlink=(t=>{e.remove(t)})}}class Device{static init(){this.agent=navigator.userAgent.toLowerCase(),this.pixelRatio=window.devicePixelRatio,this.webcam=!!(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia),this.language=navigator.userLanguage||navigator.language,this.webaudio=!!window.AudioContext,this.os=(()=>this.detect(["iphone","ipad"])?"ios":this.detect(["android"])?"android":this.detect(["blackberry"])?"blackberry":this.detect(["mac os"])?"mac":this.detect(["windows"])?"windows":this.detect(["linux"])?"linux":"unknown")(),this.browser=(()=>"ios"===this.os?this.detect(["safari"])?"safari":"unknown":"android"===this.os?this.detect(["chrome"])?"chrome":this.detect(["firefox"])?"firefox":"browser":this.detect(["msie"])?"ie":this.detect(["trident"])&&this.detect(["rv:"])?"ie":this.detect(["windows"])&&this.detect(["edge"])?"ie":this.detect(["chrome"])?"chrome":this.detect(["safari"])?"safari":this.detect(["firefox"])?"firefox":"unknown")(),this.mobile=this.detect(["iphone","ipad","android","blackberry"]),this.tablet=Math.max(window.screen?screen.width:window.innerWidth,window.screen?screen.height:window.innerHeight)>1e3,this.phone=!this.tablet,this.webgl=(()=>{try{const t=["webgl","experimental-webgl","webkit-3d","moz-webgl"],e=document.createElement("canvas");let i;for(let s=0;s<t.length&&!(i=e.getContext(t[s]));s++);const s=i.getExtension("WEBGL_debug_renderer_info"),n={};return s&&(n.gpu=i.getParameter(s.UNMASKED_RENDERER_WEBGL).toLowerCase()),n.renderer=i.getParameter(i.RENDERER).toLowerCase(),n.version=i.getParameter(i.VERSION).toLowerCase(),n.glsl=i.getParameter(i.SHADING_LANGUAGE_VERSION).toLowerCase(),n.extensions=i.getSupportedExtensions(),n.detect=(t=>{if(n.gpu&&n.gpu.includes(t))return!0;if(n.version&&n.version.includes(t))return!0;for(let e=0;e<n.extensions.length;e++)if(n.extensions[e].toLowerCase().includes(t))return!0;return!1}),n}catch(t){return!1}})()}static detect(t){return this.agent.includes(t)}static vibrate(t){navigator.vibrate&&navigator.vibrate(t)}}Device.init();class Component{constructor(){this.events=new Events,this.classes=[],this.timers=[],this.loops=[]}initClass(t,...e){const i=new t(...e);return this.add(i),i}add(t){return t.destroy&&(this.classes.push(t),t.parent=this),this}delayedCall(t,e=0,...i){if(!this.timers)return;const s=Timer.create(()=>{t&&t(...i)},e);return this.timers.push(s),this.timers.length>50&&this.timers.shift(),s}clearTimers(){for(let t=this.timers.length-1;t>=0;t--)Timer.clearTimeout(this.timers[t]);this.timers.length=0}startRender(t,e){this.loops.push(t),Render.start(t,e)}stopRender(t){this.loops.remove(t),Render.stop(t)}clearRenders(){for(let t=this.loops.length-1;t>=0;t--)this.stopRender(this.loops[t]);this.loops.length=0}destroy(){if(this.classes){this.removed=!0;const t=this.parent;t&&!t.removed&&t.remove&&t.remove(this);for(let t=this.classes.length-1;t>=0;t--){const e=this.classes[t];e&&e.destroy&&e.destroy()}this.classes.length=0,this.clearRenders(),this.clearTimers(),this.events.destroy()}return Utils.nullObject(this)}remove(t){this.classes.remove(t)}}class Assets{static init(){const t={},e={};this.CDN="",this.CORS=null,this.getPath=(t=>~t.indexOf("//")?t:(this.CDN&&!~t.indexOf(this.CDN)&&(t=this.CDN+t),t)),this.createImage=((e,i,s)=>{"boolean"!=typeof i&&(s=i,i=null);const n=new Image;return n.crossOrigin=this.CORS,n.onload=s,n.onerror=s,n.src=this.getPath(e),i&&(t[e]=n),n}),this.getImage=(e=>t[e]),this.storeData=((t,i)=>(e[t]=i,e[t])),this.getData=(t=>e[t])}static loadImage(t){"string"==typeof t&&(t=this.createImage(t));const e=Promise.create();return t.onload=(()=>e.resolve(t)),t.onerror=(()=>e.resolve(t)),e}}Assets.init();class Interpolation{static init(){function t(t,n,r){return((e(n,r)*t+i(n,r))*t+s(n))*t}function e(t,e){return 1-3*e+3*t}function i(t,e){return 3*e-6*t}function s(t){return 3*t}this.convertEase=(t=>(()=>{let e;switch(t){case"easeInQuad":e=this.Quad.In;break;case"easeInCubic":e=this.Cubic.In;break;case"easeInQuart":e=this.Quart.In;break;case"easeInQuint":e=this.Quint.In;break;case"easeInSine":e=this.Sine.In;break;case"easeInExpo":e=this.Expo.In;break;case"easeInCirc":e=this.Circ.In;break;case"easeInElastic":e=this.Elastic.In;break;case"easeInBack":e=this.Back.In;break;case"easeInBounce":e=this.Bounce.In;break;case"easeOutQuad":e=this.Quad.Out;break;case"easeOutCubic":e=this.Cubic.Out;break;case"easeOutQuart":e=this.Quart.Out;break;case"easeOutQuint":e=this.Quint.Out;break;case"easeOutSine":e=this.Sine.Out;break;case"easeOutExpo":e=this.Expo.Out;break;case"easeOutCirc":e=this.Circ.Out;break;case"easeOutElastic":e=this.Elastic.Out;break;case"easeOutBack":e=this.Back.Out;break;case"easeOutBounce":e=this.Bounce.Out;break;case"easeInOutQuad":e=this.Quad.InOut;break;case"easeInOutCubic":e=this.Cubic.InOut;break;case"easeInOutQuart":e=this.Quart.InOut;break;case"easeInOutQuint":e=this.Quint.InOut;break;case"easeInOutSine":e=this.Sine.InOut;break;case"easeInOutExpo":e=this.Expo.InOut;break;case"easeInOutCirc":e=this.Circ.InOut;break;case"easeInOutElastic":e=this.Elastic.InOut;break;case"easeInOutBack":e=this.Back.InOut;break;case"easeInOutBounce":e=this.Bounce.InOut;break;case"linear":e=this.Linear.None}if(!e){const i=TweenManager.getEase(t);if(i){const t=i.split("(")[1].slice(0,-1).split(",");for(let e=0;e<t.length;e++)t[e]=parseFloat(t[e]);e=t}else e=this.Cubic.Out}return e})()),this.solve=((n,r)=>n[0]===n[1]&&n[2]===n[3]?r:t(function(n,r,a){let o=n;for(let u=0;u<4;u++){const u=(h=o,3*e(l=r,c=a)*h*h+2*i(l,c)*h+s(l));if(0===u)return o;o-=(t(o,r,a)-n)/u}var h,l,c;return o}(r,n[0],n[2]),n[1],n[3])),this.Linear={None:t=>t},this.Quad={In:t=>t*t,Out:t=>t*(2-t),InOut:t=>(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},this.Cubic={In:t=>t*t*t,Out:t=>--t*t*t+1,InOut:t=>(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},this.Quart={In:t=>t*t*t*t,Out:t=>1- --t*t*t*t,InOut:t=>(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},this.Quint={In:t=>t*t*t*t*t,Out:t=>--t*t*t*t*t+1,InOut:t=>(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},this.Sine={In:t=>1-Math.cos(t*Math.PI/2),Out:t=>Math.sin(t*Math.PI/2),InOut:t=>.5*(1-Math.cos(Math.PI*t))},this.Expo={In:t=>0===t?0:Math.pow(1024,t-1),Out:t=>1===t?1:1-Math.pow(2,-10*t),InOut:t=>0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},this.Circ={In:t=>1-Math.sqrt(1-t*t),Out:t=>Math.sqrt(1- --t*t),InOut:t=>(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},this.Elastic={In(t,e=1,i=.4){let s;return 0===t?0:1===t?1:(!e||e<1?(e=1,s=i/4):s=i*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*(t-=1))*Math.sin((t-s)*(2*Math.PI)/i))},Out(t,e=1,i=.4){let s;return 0===t?0:1===t?1:(!e||e<1?(e=1,s=i/4):s=i*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-s)*(2*Math.PI)/i)+1)},InOut(t,e=1,i=.4){let s;return 0===t?0:1===t?1:(!e||e<1?(e=1,s=i/4):s=i*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*(t-=1))*Math.sin((t-s)*(2*Math.PI)/i)*-.5:e*Math.pow(2,-10*(t-=1))*Math.sin((t-s)*(2*Math.PI)/i)*.5+1)}},this.Back={In(t){const e=1.70158;return t*t*((e+1)*t-e)},Out(t){const e=1.70158;return--t*t*((e+1)*t+e)+1},InOut(t){const e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},this.Bounce={In:t=>1-Interpolation.Bounce.Out(1-t),Out:t=>t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375,InOut:t=>t<.5?.5*Interpolation.Bounce.In(2*t):.5*Interpolation.Bounce.Out(2*t-1)+.5}}}Interpolation.init();class MathTween{constructor(t,e,i,s,n,r,a){const o=this;let h,l,c,u,d,p,m,v;function f(){if(!t&&!e)return!1;t.mathTween=null,TweenManager.removeMathTween(o),Utils.nullObject(o),t.mathTweens&&t.mathTweens.remove(o)}!function(){!t.multiTween&&t.mathTween&&TweenManager.clearTween(t);TweenManager.addMathTween(o),t.mathTween=o,t.multiTween&&(t.mathTweens||(t.mathTweens=[]),t.mathTweens.push(o));s=Interpolation.convertEase(s),u="function"==typeof s,h=performance.now(),h+=n,c=e,l={},e.spring&&(p=e.spring);e.damping&&(m=e.damping);for(let e in c)"number"==typeof t[e]&&(l[e]=t[e])}(),this.update=(t=>{if(d||t<h)return;v=(v=(t-h)/i)>1?1:v;const e=this.interpolate(v);r&&r(e),1===v&&(a&&a(),f())}),this.stop=(()=>{f()}),this.pause=(()=>{d=!0}),this.resume=(()=>{d=!1,h=performance.now()-v*i}),this.interpolate=(e=>{const i=u?s(e,p,m):Interpolation.solve(s,e);for(let e in l)if("number"==typeof l[e]&&"number"==typeof c[e]){const s=l[e],n=c[e];t[e]=s+(n-s)*i}return i})}}class TweenManager{static init(){const t=this,e=[];this.TRANSFORMS=["x","y","z","scale","scaleX","scaleY","rotation","rotationX","rotationY","rotationZ","skewX","skewY","perspective"],this.CSS_EASES={easeOutCubic:"cubic-bezier(0.215, 0.610, 0.355, 1.000)",easeOutQuad:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",easeOutQuart:"cubic-bezier(0.165, 0.840, 0.440, 1.000)",easeOutQuint:"cubic-bezier(0.230, 1.000, 0.320, 1.000)",easeOutSine:"cubic-bezier(0.390, 0.575, 0.565, 1.000)",easeOutExpo:"cubic-bezier(0.190, 1.000, 0.220, 1.000)",easeOutCirc:"cubic-bezier(0.075, 0.820, 0.165, 1.000)",easeOutBack:"cubic-bezier(0.175, 0.885, 0.320, 1.275)",easeInCubic:"cubic-bezier(0.550, 0.055, 0.675, 0.190)",easeInQuad:"cubic-bezier(0.550, 0.085, 0.680, 0.530)",easeInQuart:"cubic-bezier(0.895, 0.030, 0.685, 0.220)",easeInQuint:"cubic-bezier(0.755, 0.050, 0.855, 0.060)",easeInSine:"cubic-bezier(0.470, 0.000, 0.745, 0.715)",easeInCirc:"cubic-bezier(0.600, 0.040, 0.980, 0.335)",easeInBack:"cubic-bezier(0.600, -0.280, 0.735, 0.045)",easeInOutCubic:"cubic-bezier(0.645, 0.045, 0.355, 1.000)",easeInOutQuad:"cubic-bezier(0.455, 0.030, 0.515, 0.955)",easeInOutQuart:"cubic-bezier(0.770, 0.000, 0.175, 1.000)",easeInOutQuint:"cubic-bezier(0.860, 0.000, 0.070, 1.000)",easeInOutSine:"cubic-bezier(0.445, 0.050, 0.550, 0.950)",easeInOutExpo:"cubic-bezier(1.000, 0.000, 0.000, 1.000)",easeInOutCirc:"cubic-bezier(0.785, 0.135, 0.150, 0.860)",easeInOutBack:"cubic-bezier(0.680, -0.550, 0.265, 1.550)",easeInOut:"cubic-bezier(0.420, 0.000, 0.580, 1.000)",linear:"linear"},Render.start(function(i){for(let s=e.length-1;s>=0;s--){const n=e[s];n.update?n.update(i):t.removeMathTween(n)}}),this.addMathTween=(t=>{e.push(t)}),this.removeMathTween=(t=>{e.remove(t)}),this.tween=((t,e,i,s,n,r,a)=>{"number"!=typeof n&&(a=r,r=n,n=0);let o=null;"undefined"!=typeof Promise&&(o=Promise.create(),r&&o.then(r),r=o.resolve);const h=new MathTween(t,e,i,s,n,a,r);return o||h}),this.clearTween=(t=>{if(t.mathTween&&t.mathTween.stop(),t.mathTweens){const e=t.mathTweens;for(let t=e.length-1;t>=0;t--){const i=e[t];i&&i.stop()}t.mathTweens=null}}),this.isTransform=(t=>~this.TRANSFORMS.indexOf(t)),this.getEase=(t=>this.CSS_EASES[t]||this.CSS_EASES.easeOutCubic),this.getAllTransforms=(t=>{const e={};for(let i=0;i<this.TRANSFORMS.length;i++){const s=this.TRANSFORMS[i],n=t[s];0!==n&&"number"==typeof n&&(e[s]=n)}return e}),this.parseTransform=(t=>{let e="";if(void 0!==t.x||void 0!==t.y||void 0!==t.z){const i=t.x||0,s=t.y||0,n=t.z||0;let r="";r+=i+"px, ",r+=s+"px, ",e+="translate3d("+(r+=n+"px")+")"}return void 0!==t.scale?e+="scale("+t.scale+")":(void 0!==t.scaleX&&(e+="scaleX("+t.scaleX+")"),void 0!==t.scaleY&&(e+="scaleY("+t.scaleY+")")),void 0!==t.rotation&&(e+="rotate("+t.rotation+"deg)"),void 0!==t.rotationX&&(e+="rotateX("+t.rotationX+"deg)"),void 0!==t.rotationY&&(e+="rotateY("+t.rotationY+"deg)"),void 0!==t.rotationZ&&(e+="rotateZ("+t.rotationZ+"deg)"),void 0!==t.skewX&&(e+="skewX("+t.skewX+"deg)"),void 0!==t.skewY&&(e+="skewY("+t.skewY+"deg)"),void 0!==t.perspective&&(e+="perspective("+t.perspective+"px)"),e}),this.interpolate=((t,e,i)=>{const s=Interpolation.convertEase(i);return t*("function"==typeof s?s(e):Interpolation.solve(s,e))}),this.interpolateValues=((t,e,i,s)=>{const n=Interpolation.convertEase(s);return t+(e-t)*("function"==typeof n?n(i):Interpolation.solve(n,i))})}}TweenManager.init();class CSSTransition{constructor(t,e,i,s,n,r){const a=this;let o,h;function l(){return!a||a.kill||!t||!t.element}function c(){l()||(a.kill=!0,t.element.style.transition="",t.willChange(null),t.cssTween=null,t=e=null,Utils.nullObject(a))}!function(){const i=TweenManager.getAllTransforms(t),s=[];for(let t in e)TweenManager.isTransform(t)?(i.use=!0,i[t]=e[t],delete e[t]):("number"==typeof e[t]||~t.indexOf("-"))&&s.push(t);i.use&&(s.push("transform"),delete i.use);o=i,h=s}(),function(){if(l())return;t.cssTween&&t.cssTween.stop();t.cssTween=a;const u=function(t,e,i){let s="",n="";for(let r=0;r<h.length;r++){const a=h[r];s+=(s.length?", ":"")+a,n+=(n.length?", ":"")+a+" "+t+"ms "+TweenManager.getEase(e)+" "+i+"ms"}return{props:s,transition:n}}(i,s,n);t.willChange(u.props),Timer.create(()=>{l()||(t.element.style.transition=u.transition,t.css(e),t.transform(o),Timer.create(()=>{l()||(c(),r&&r())},i+n))},35)}(),this.stop=c}}class Interface{constructor(t,e="div",i){if(this.events=new Events,this.classes=[],this.timers=[],this.loops=[],void 0!==t){if("string"==typeof t){if(this.name=t,this.type=e,"svg"===e){const t=i||"svg";i=!0,this.element=document.createElementNS("http://www.w3.org/2000/svg",t),this.element.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink")}else this.element=document.createElement(e),"."!==t.charAt(0)?this.element.id=t:this.element.className=t.substr(1);this.element.style.position="absolute",i||document.body.appendChild(this.element)}else this.element=t;this.element.object=this}}initClass(t,...e){const i=new t(...e);return this.add(i),i}add(t){return t.destroy&&(this.classes.push(t),t.parent=this),t.element?this.element.appendChild(t.element):t.nodeName&&this.element.appendChild(t),this}delayedCall(t,e=0,...i){if(!this.timers)return;const s=Timer.create(()=>{t&&t(...i)},e);return this.timers.push(s),this.timers.length>50&&this.timers.shift(),s}clearTimers(){for(let t=this.timers.length-1;t>=0;t--)Timer.clearTimeout(this.timers[t]);this.timers.length=0}startRender(t,e){this.loops.push(t),Render.start(t,e)}stopRender(t){this.loops.remove(t),Render.stop(t)}clearRenders(){for(let t=this.loops.length-1;t>=0;t--)this.stopRender(this.loops[t]);this.loops.length=0}destroy(){if(!this.classes)return;this.removed=!0;const t=this.parent;t&&!t.removed&&t.remove&&t.remove(this);for(let t=this.classes.length-1;t>=0;t--){const e=this.classes[t];e&&e.destroy&&e.destroy()}return this.classes.length=0,this.element.object=null,this.clearRenders(),this.clearTimers(),this.events.destroy(),Utils.nullObject(this)}remove(t){t.element?t.element.parentNode.removeChild(t.element):t.nodeName&&t.parentNode.removeChild(t),this.classes.remove(t)}create(t,e){const i=new Interface(t,e);return this.add(i),i}clone(){return new Interface(this.element.cloneNode(!0))}empty(){return this.element.innerHTML="",this}text(t){return void 0===t?this.element.textContent:(this.element.textContent=t,this)}html(t){return void 0===t?this.element.innerHTML:(this.element.innerHTML=t,this)}hide(){return this.element.style.display="none",this}show(){return this.element.style.display="",this}visible(){return this.element.style.visibility="visible",this}invisible(){return this.element.style.visibility="hidden",this}setZ(t){return this.element.style.zIndex=t,this}clearOpacity(){return this.element.style.opacity="",this}size(t,e=t,i){return"boolean"==typeof e&&(i=e,e=t),void 0!==t&&("string"==typeof t||"string"==typeof e?("string"!=typeof t&&(t+="px"),"string"!=typeof e&&(e+="px"),this.element.style.width=t,this.element.style.height=e):(this.element.style.width=t+"px",this.element.style.height=e+"px",i||(this.element.style.backgroundSize=t+"px "+e+"px"))),this.width=this.element.offsetWidth,this.height=this.element.offsetHeight,this}mouseEnabled(t){return this.element.style.pointerEvents=t?"auto":"none",this}fontStyle(t,e,i,s){return this.css({fontFamily:t,fontSize:e,color:i,fontStyle:s}),this}bg(t,e,i,s){return~t.indexOf(".")&&(t=Assets.getPath(t)),t.includes(["data:","."])?this.element.style.backgroundImage="url("+t+")":this.element.style.backgroundColor=t,void 0!==e&&(e="number"==typeof e?e+"px":e,i="number"==typeof i?i+"px":i,this.element.style.backgroundPosition=e+" "+i),s&&(this.element.style.backgroundSize="",this.element.style.backgroundRepeat=s),"cover"!==e&&"contain"!==e||(s="number"==typeof s?s+"px":s,this.element.style.backgroundSize=e,this.element.style.backgroundRepeat="no-repeat",this.element.style.backgroundPosition=void 0!==i?i+" "+s:"center"),this}center(t,e,i){const s={};return void 0===t?(s.left="50%",s.top="50%",s.marginLeft=-this.width/2,s.marginTop=-this.height/2):(t&&(s.left="50%",s.marginLeft=-this.width/2),e&&(s.top="50%",s.marginTop=-this.height/2)),i&&(delete s.left,delete s.top),this.css(s),this}mask(t){return this.element.style.mask=(~t.indexOf(".")?"url("+t+")":t)+" no-repeat",this.element.style.maskSize="contain",this}blendMode(t,e){return this.element.style[e?"background-blend-mode":"mix-blend-mode"]=t,this}css(t,e){if("object"!=typeof t){if(e)return this.element.style[t]=e,this;{let e=this.element.style[t];return"number"!=typeof e&&(~e.indexOf("px")&&(e=Number(e.slice(0,-2))),"opacity"===t&&(e=isNaN(Number(this.element.style.opacity))?1:Number(this.element.style.opacity))),e||0}}for(let e in t){let i=t[e];"string"!=typeof i&&"number"!=typeof i||("string"!=typeof i&&"opacity"!==e&&"zIndex"!==e&&(i+="px"),this.element.style[e]=i)}return this}transform(t){if(t)for(let e in t)"number"==typeof t[e]&&(this[e]=t[e]);else t=this;return this.element.style.transform=TweenManager.parseTransform(t),this}willChange(t){const e="string"==typeof t;this.element.style.willChange=t?e?t:"transform, opacity":""}backfaceVisibility(t){return this.element.style.backfaceVisibility=t?"visible":"hidden",this}enable3D(t,e,i){return this.element.style.transformStyle="preserve-3d",t&&(this.element.style.perspective=t+"px"),void 0!==e&&(e="number"==typeof e?e+"px":e,i="number"==typeof i?i+"px":i,this.element.style.perspectiveOrigin=e+" "+i),this}disable3D(){return this.element.style.transformStyle="",this.element.style.perspective="",this}transformPoint(t,e,i){let s="";return void 0!==t&&(s+="number"==typeof t?t+"px":t),void 0!==e&&(s+="number"==typeof e?" "+e+"px":" "+e),void 0!==i&&(s+="number"==typeof i?" "+i+"px":" "+i),this.element.style.transformOrigin=s,this}tween(t,e,i,s,n){"number"!=typeof s&&(n=s,s=0);let r=null;"undefined"!=typeof Promise&&(r=Promise.create(),n&&r.then(n),n=r.resolve);const a=new CSSTransition(this,t,e,i,s,n);return r||a}clearTransform(){return"number"==typeof this.x&&(this.x=0),"number"==typeof this.y&&(this.y=0),"number"==typeof this.z&&(this.z=0),"number"==typeof this.scale&&(this.scale=1),"number"==typeof this.scaleX&&(this.scaleX=1),"number"==typeof this.scaleY&&(this.scaleY=1),"number"==typeof this.rotation&&(this.rotation=0),"number"==typeof this.rotationX&&(this.rotationX=0),"number"==typeof this.rotationY&&(this.rotationY=0),"number"==typeof this.rotationZ&&(this.rotationZ=0),"number"==typeof this.skewX&&(this.skewX=0),"number"==typeof this.skewY&&(this.skewY=0),this.element.style.transform="",this}clearTween(){return this.cssTween&&this.cssTween.stop(),this.mathTween&&this.mathTween.stop(),this}attr(t,e){return void 0===e?this.element.getAttribute(t):(""===e?this.element.removeAttribute(t):this.element.setAttribute(t,e),this)}convertTouchEvent(t){const e={x:0,y:0};return t?(t.touches||t.changedTouches?t.touches.length?(e.x=t.touches[0].pageX,e.y=t.touches[0].pageY):(e.x=t.changedTouches[0].pageX,e.y=t.changedTouches[0].pageY):(e.x=t.pageX,e.y=t.pageY),e):e}click(t){return this.element.addEventListener("click",e=>{if(!this.element)return!1;e.object="hit"===this.element.className?this.parent:this,e.action="click",t&&t(e)},!0),this.element.style.cursor="pointer",this}hover(t){const e=e=>{if(!this.element)return!1;e.object="hit"===this.element.className?this.parent:this,e.action="mouseout"===e.type?"out":"over",t&&t(e)};return this.element.addEventListener("mouseover",e,!0),this.element.addEventListener("mouseout",e,!0),this}bind(t,e){"touchstart"!==t||Device.mobile?"touchmove"!==t||Device.mobile?"touchend"!==t||Device.mobile||(t="mouseup"):t="mousemove":t="mousedown",this.events["bind_"+t]||(this.events["bind_"+t]=[]);const i=this.events["bind_"+t];i.push({target:this.element,callback:e});const s=t=>{const e=this.convertTouchEvent(t);t instanceof MouseEvent||(t.x=e.x,t.y=e.y),i.forEach(e=>{e.target===t.currentTarget&&e.callback(t)})};return this.events["fn_"+t]||(this.events["fn_"+t]=s,this.element.addEventListener(t,s,!0)),this}unbind(t,e){"touchstart"!==t||Device.mobile?"touchmove"!==t||Device.mobile?"touchend"!==t||Device.mobile||(t="mouseup"):t="mousemove":t="mousedown";const i=this.events["bind_"+t];return i?(i.forEach((t,s)=>{t.callback===e&&i.splice(s,1)}),this.events["fn_"+t]&&!i.length&&(this.element.removeEventListener(t,this.events["fn_"+t],!0),this.events["fn_"+t]=null),this):this}interact(t,e){return this.hit=this.create(".hit"),this.hit.css({position:"absolute",left:0,top:0,width:"100%",height:"100%",zIndex:99999}),Device.mobile?this.hit.touchClick(t,e):this.hit.hover(t).click(e),this}touchClick(t,e){const i={};let s,n,r;const a=t=>{const e=this.convertTouchEvent(t);t.touchX=e.x,t.touchY=e.y,i.x=t.touchX,i.y=t.touchY};return this.element.addEventListener("touchmove",t=>{if(!this.element)return!1;r=this.convertTouchEvent(t),n=((t,e)=>{const i=e.x-t.x,s=e.y-t.y;return Math.sqrt(i*i+s*s)})(i,r)>5},{passive:!0}),this.element.addEventListener("touchstart",e=>{if(!this.element)return!1;s=performance.now(),e.object="hit"===this.element.className?this.parent:this,e.action="over",a(e),t&&!n&&t(e)},{passive:!0}),this.element.addEventListener("touchend",i=>{if(!this.element)return!1;const r=performance.now();i.object="hit"===this.element.className?this.parent:this,a(i),s&&r-s<750&&e&&!n&&(i.action="click",e(i)),t&&(i.action="out",t(i)),n=!1},{passive:!0}),this}touchSwipe(t,e=75){const i={};let s,n,r=!1;const a=a=>{if(r){const r=this.convertTouchEvent(a),h=s-r.x,l=n-r.y;i.direction=null,i.moving=null,i.x=null,i.y=null,i.evt=a,Math.abs(h)>=e?(o(),i.direction=h>0?"left":"right"):Math.abs(l)>=e?(o(),i.direction=l>0?"up":"down"):(i.moving=!0,i.x=h,i.y=l),t&&t(i,a)}},o=()=>{s=n=r=!1,this.element.removeEventListener("touchmove",a)};return this.element.addEventListener("touchstart",t=>{const e=this.convertTouchEvent(t);1===t.touches.length&&(s=e.x,n=e.y,r=!0,this.element.addEventListener("touchmove",a,{passive:!0}))},{passive:!0}),this.element.addEventListener("touchend",o,{passive:!0}),this.element.addEventListener("touchcancel",o,{passive:!0}),this}preventScroll(){if(!Device.mobile)return;this.element.addEventListener("touchstart",t=>{let e=t.target;if("INPUT"===e.nodeName||"TEXTAREA"===e.nodeName||"SELECT"===e.nodeName||"A"===e.nodeName)return;let i=!0;for(;e.parentNode&&i;)e.scrollParent&&(i=!1),e=e.parentNode;i&&t.preventDefault()},{passive:!1})}overflowScroll(t){if(!Device.mobile)return;const e=!!t.x,i=!!t.y,s={"-webkit-overflow-scrolling":"touch"};(!e&&!i||e&&i)&&(s.overflow="scroll"),!e&&i&&(s.overflowY="scroll",s.overflowX="hidden"),e&&!i&&(s.overflowX="scroll",s.overflowY="hidden"),this.css(s),this.element.scrollParent=!0,this.element.preventEvent=(t=>t.stopPropagation()),this.bind("touchmove",this.element.preventEvent)}removeOverflowScroll(){Device.mobile&&(this.css({overflow:"hidden",overflowX:"",overflowY:"","-webkit-overflow-scrolling":""}),this.unbind("touchmove",this.element.preventEvent))}split(t=""){const e={position:"relative",display:"inline-block",width:"auto",height:"auto",margin:0,padding:0},i=[],s=this.text().split(t);this.empty()," "===t&&(t="&nbsp;");for(let n=0;n<s.length;n++)" "===s[n]&&(s[n]="&nbsp;"),i.push(this.create(".t","span").html(s[n]).css(e)),""!==t&&n<s.length-1&&i.push(this.create(".t","span").html(t).css(e));return i}}class Accelerometer{static init(){if(!this.active){this.active=!0,this.x=0,this.y=0,this.z=0,this.alpha=0,this.beta=0,this.gamma=0,this.heading=0,this.rotationRate={},this.rotationRate.alpha=0,this.rotationRate.beta=0,this.rotationRate.gamma=0,this.toRadians="ios"===Device.os?Math.PI/180:1;const t=t=>{switch(window.orientation){case 0:this.x=-t.accelerationIncludingGravity.x,this.y=t.accelerationIncludingGravity.y,this.z=t.accelerationIncludingGravity.z,t.rotationRate&&(this.rotationRate.alpha=t.rotationRate.beta*this.toRadians,this.rotationRate.beta=-t.rotationRate.alpha*this.toRadians,this.rotationRate.gamma=t.rotationRate.gamma*this.toRadians);break;case 180:this.x=t.accelerationIncludingGravity.x,this.y=-t.accelerationIncludingGravity.y,this.z=t.accelerationIncludingGravity.z,t.rotationRate&&(this.rotationRate.alpha=-t.rotationRate.beta*this.toRadians,this.rotationRate.beta=t.rotationRate.alpha*this.toRadians,this.rotationRate.gamma=t.rotationRate.gamma*this.toRadians);break;case 90:this.x=t.accelerationIncludingGravity.y,this.y=t.accelerationIncludingGravity.x,this.z=t.accelerationIncludingGravity.z,t.rotationRate&&(this.rotationRate.alpha=t.rotationRate.alpha*this.toRadians,this.rotationRate.beta=t.rotationRate.beta*this.toRadians,this.rotationRate.gamma=t.rotationRate.gamma*this.toRadians);break;case-90:this.x=-t.accelerationIncludingGravity.y,this.y=-t.accelerationIncludingGravity.x,this.z=t.accelerationIncludingGravity.z,t.rotationRate&&(this.rotationRate.alpha=-t.rotationRate.alpha*this.toRadians,this.rotationRate.beta=-t.rotationRate.beta*this.toRadians,this.rotationRate.gamma=t.rotationRate.gamma*this.toRadians)}},e=t=>{for(let e in t)~e.toLowerCase().indexOf("heading")&&(this.heading=t[e]);switch(window.orientation){case 0:this.alpha=t.beta*this.toRadians,this.beta=-t.alpha*this.toRadians,this.gamma=t.gamma*this.toRadians;break;case 180:this.alpha=-t.beta*this.toRadians,this.beta=t.alpha*this.toRadians,this.gamma=t.gamma*this.toRadians;break;case 90:this.alpha=t.alpha*this.toRadians,this.beta=t.beta*this.toRadians,this.gamma=t.gamma*this.toRadians;break;case-90:this.alpha=-t.alpha*this.toRadians,this.beta=-t.beta*this.toRadians,this.gamma=t.gamma*this.toRadians}this.tilt=t.beta*this.toRadians,this.yaw=t.alpha*this.toRadians,this.roll=-t.gamma*this.toRadians,"Android"===Device.os&&(this.heading=i(t.alpha,t.beta,t.gamma))},i=(t,e,i)=>{const s=Math.PI/180,n=e?e*s:0,r=i?i*s:0,a=t?t*s:0,o=Math.cos(r),h=Math.cos(a),l=Math.sin(n),c=Math.sin(r),u=Math.sin(a),d=-h*c-u*l*o,p=-u*c+h*l*o;let m=Math.atan(d/p);return p<0?m+=Math.PI:d<0&&(m+=2*Math.PI),m*(180/Math.PI)};window.addEventListener("devicemotion",t),window.addEventListener("deviceorientation",e),this.stop=(()=>{this.active=!1,window.removeEventListener("devicemotion",t),window.removeEventListener("deviceorientation",e)})}}}class Mouse{static init(){if(!this.active){this.active=!0,this.x=0,this.y=0,this.normal={x:0,y:0},this.tilt={x:0,y:0},this.inverseNormal={x:0,y:0};const t=t=>{this.x=t.x,this.y=t.y,this.normal.x=t.x/Stage.width,this.normal.y=t.y/Stage.height,this.tilt.x=2*this.normal.x-1,this.tilt.y=1-2*this.normal.y,this.inverseNormal.x=this.normal.x,this.inverseNormal.y=1-this.normal.y};this.input=Stage.initClass(Interaction),Stage.events.add(this.input,Interaction.START,t),Stage.events.add(this.input,Interaction.MOVE,t),t({x:Stage.width/2,y:Stage.height/2}),this.stop=(()=>{this.active=!1,Stage.events.remove(this.input,Interaction.START,t),Stage.events.remove(this.input,Interaction.MOVE,t)})}}}window.AudioContext||(window.AudioContext=window.webkitAudioContext||window.mozAudioContext||window.oAudioContext);class WebAudio{static init(){if(!this.active){this.active=!0;const t=this,e={};let i;window.AudioContext&&(i=new AudioContext,this.output=i.createGain(),this.volume=1,this.output.connect(i.destination),this.gain={set value(e){t.volume=e,t.output.gain.linearRampToValueAtTime(e,i.currentTime+.015)},get value(){return t.volume}},this.context=i),this.loadSound=((t,e)=>{const s=Promise.create();e&&s.then(e),e=s.resolve;const n=this.getSound(t);window.fetch(n.asset).then(t=>{if(!t.ok)return e();t.arrayBuffer().then(t=>{i.decodeAudioData(t,t=>{n.buffer=t,n.complete=!0,e()},()=>{e()})})}).catch(()=>{e()}),n.ready=(()=>s)}),this.createSound=((t,i,s)=>(e[t]=new class{constructor(t){const e=this;this.asset=Assets.getPath(t),WebAudio.context.createStereoPanner&&(this.stereo=WebAudio.context.createStereoPanner()),this.output=WebAudio.context.createGain(),this.volume=1,this.rate=1,this.stereo&&this.stereo.connect(this.output),this.output.connect(WebAudio.output),this.output.gain.setValueAtTime(0,WebAudio.context.currentTime),this.gain={set value(t){e.volume=t,e.output.gain.linearRampToValueAtTime(t,WebAudio.context.currentTime+.015)},get value(){return e.volume}},this.playbackRate={set value(t){e.rate=t,e.source&&e.source.playbackRate.linearRampToValueAtTime(t,WebAudio.context.currentTime+.015)},get value(){return e.rate}},this.stereoPan={set value(t){e.pan=t,e.stereo&&e.stereo.pan.linearRampToValueAtTime(t,WebAudio.context.currentTime+.015)},get value(){return e.pan}},this.stop=(()=>{this.source&&(this.source.stop(),this.playing=!1)})}}(i),"ios"===Device.os&&s?s():this.loadSound(t,s),e[t])),this.getSound=(t=>e[t]),this.trigger=(t=>{if(!i)return;"suspended"===i.state&&i.resume();const e=this.getSound(t);e.ready||this.loadSound(t),e.ready().then(()=>{if(e.complete){if(e.stopping&&e.loop)return void(e.stopping=!1);e.playing=!0,e.source=i.createBufferSource(),e.source.buffer=e.buffer,e.source.loop=e.loop,e.source.playbackRate.setValueAtTime(e.rate,i.currentTime),e.source.connect(e.stereo?e.stereo:e.output),e.source.start(),e.output.gain.linearRampToValueAtTime(e.volume,i.currentTime+.015)}})}),this.play=((t,e=1,s)=>{if(!i)return;"boolean"==typeof e&&(s=e,e=1);const n=this.getSound(t);n&&(n.volume=e,n.loop=!!s,this.trigger(t))}),this.fadeInAndPlay=((t,e,s,n,r,a=0)=>{if(!i)return;const o=this.getSound(t);o&&(o.volume=0,o.loop=!!s,this.trigger(t),TweenManager.tween(o.gain,{value:e},n,r,a))}),this.fadeOutAndStop=((t,e,s,n=0)=>{if(!i)return;const r=this.getSound(t);r&&r.playing&&(TweenManager.tween(r.gain,{value:0},e,s,n,()=>{r.stopping&&(r.stopping=!1,r.stop())}),r.stopping=!0)}),this.remove=(t=>{const i=this.getSound(t);i&&i.source&&(i.source.buffer=null,i.source.stop(),i.source.disconnect(),i.source=null,i.playing=!1,delete e[t])}),this.mute=(()=>{i&&TweenManager.tween(this.gain,{value:0},300,"easeOutSine")}),this.unmute=(()=>{i&&TweenManager.tween(this.gain,{value:1},500,"easeOutSine")}),this.stop=(()=>{if(this.active=!1,i){for(let t in e){const i=e[t];i&&i.stop()}i.close()}})}window.WebAudio=this}}const Stage=new class extends Interface{constructor(){super("Stage");const t=this;let e;function i(){"focus"!==e&&(e="focus",Events.emitter.fire(Events.VISIBILITY,{type:"focus"}))}function s(){"blur"!==e&&(e="blur",Events.emitter.fire(Events.VISIBILITY,{type:"blur"}))}function n(t){Events.emitter.fire(Events.KEYBOARD_DOWN,t)}function r(t){Events.emitter.fire(Events.KEYBOARD_UP,t)}function a(t){Events.emitter.fire(Events.KEYBOARD_PRESS,t)}function o(e){t.size(),t.orientation=window.innerWidth>window.innerHeight?"landscape":"portrait",Events.emitter.fire(Events.RESIZE,e)}t.css({overflow:"hidden"}),t.preventScroll(),window.addEventListener("focus",i),window.addEventListener("blur",s),window.addEventListener("keydown",n),window.addEventListener("keyup",r),window.addEventListener("keypress",a),window.addEventListener("resize",o),window.addEventListener("orientationchange",o),o(),this.destroy=(()=>(Accelerometer.active&&Accelerometer.stop(),Mouse.active&&Mouse.stop(),WebAudio.active&&WebAudio.stop(),window.removeEventListener("focus",i),window.removeEventListener("blur",s),window.removeEventListener("keydown",n),window.removeEventListener("keyup",r),window.removeEventListener("keypress",a),window.removeEventListener("resize",o),window.removeEventListener("orientationchange",o),super.destroy()))}};class Vector2{constructor(t,e){this.x="number"==typeof t?t:0,this.y="number"==typeof e?e:0,this.type="vector2"}set(t,e){return this.x=t||0,this.y=e||0,this}clear(){return this.x=0,this.y=0,this}copyTo(t){return t.x=this.x,t.y=this.y,this}copy(t){return this.x=t.x||0,this.y=t.y||0,this}lengthSq(){return this.x*this.x+this.y*this.y||1e-5}length(){return Math.sqrt(this.lengthSq())}normalize(){const t=this.length();return this.x/=t,this.y/=t,this}setLength(t){return this.normalize().multiplyScalar(t),this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}multiplyVectors(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.x/=t,this.y/=t,this}perpendicular(){const t=this.x,e=this.y;return this.x=-e,this.y=t,this}lerp(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this}deltaLerp(t,e,i=1){for(let s=0;s<i;s++)this.lerp(t,e);return this}interp(t,e,i,s=5e3){this.calc||(this.calc=new Vector2),this.calc.subVectors(this,t);const n=Interpolation.convertEase(i)(Math.clamp(Math.range(this.calc.lengthSq(),0,s*s,1,0),0,1)*(e/10));return this.lerp(t,n)}setAngleRadius(t,e){return this.x=Math.cos(t)*e,this.y=Math.sin(t)*e,this}addAngleRadius(t,e){return this.x+=Math.cos(t)*e,this.y+=Math.sin(t)*e,this}dot(t,e=this){return t.x*e.x+t.y*e.y}clone(){return new Vector2(this.x,this.y)}distanceTo(t,e){const i=this.x-t.x,s=this.y-t.y;return e?i*i+s*s:Math.sqrt(i*i+s*s)}solveAngle(t,e=this){return Math.atan2(t.y-e.y,t.x-e.x)}equals(t){return this.x===t.x&&this.y===t.y}toString(t=" "){return this.x+t+this.y}}class Interaction extends Component{constructor(t=Stage){if(!Interaction.initialized){Interaction.CLICK="interaction_click",Interaction.START="interaction_start",Interaction.MOVE="interaction_move",Interaction.DRAG="interaction_drag",Interaction.END="interaction_end";const t={touchstart:[],touchmove:[],touchend:[]},e=e=>t.touchstart.forEach(t=>t(e)),i=e=>t.touchmove.forEach(t=>t(e)),s=e=>t.touchend.forEach(t=>t(e));Interaction.bind=((e,i)=>t[e].push(i)),Interaction.unbind=((e,i)=>t[e].remove(i)),Stage.bind("touchstart",e),Stage.bind("touchmove",i),Stage.bind("touchend",s),Stage.bind("touchcancel",s),Interaction.initialized=!0}super();const e=this;let i,s,n;function r(t){e.isTouching=!0,e.x=t.x,e.y=t.y,e.hold.x=e.last.x=t.x,e.hold.y=e.last.y=t.y,e.delta.x=e.move.x=e.velocity.x=0,e.delta.y=e.move.y=e.velocity.y=0,i=0,e.events.fire(Interaction.START,t,!0),s=n=Render.TIME}function a(t){e.isTouching&&(e.move.x=t.x-e.hold.x,e.move.y=t.y-e.hold.y),e.x=t.x,e.y=t.y,e.delta.x=t.x-e.last.x,e.delta.y=t.y-e.last.y,e.last.x=t.x,e.last.y=t.y,i+=e.delta.length();const s=Math.max(.001,Render.TIME-(n||Render.TIME));n=Render.TIME,e.velocity.x=Math.abs(e.delta.x)/s,e.velocity.y=Math.abs(e.delta.y)/s,e.events.fire(Interaction.MOVE,t,!0),e.isTouching&&e.events.fire(Interaction.DRAG,t,!0)}function o(t){if(!e.isTouching)return;e.isTouching=!1,e.move.x=0,e.move.y=0,Math.max(.001,Render.TIME-(n||Render.TIME))>100&&(e.delta.x=0,e.delta.y=0),e.events.fire(Interaction.END,t,!0),i<20&&Render.TIME-s<2e3&&e.events.fire(Interaction.CLICK,t,!0)}this.x=0,this.y=0,this.hold=new Vector2,this.last=new Vector2,this.delta=new Vector2,this.move=new Vector2,this.velocity=new Vector2,function(){t===Stage?Interaction.bind("touchstart",r):t.bind("touchstart",r);Interaction.bind("touchmove",a),Interaction.bind("touchend",o)}(),this.destroy=(()=>(Interaction.unbind("touchstart",r),Interaction.unbind("touchmove",a),Interaction.unbind("touchend",o),t!==Stage&&t.unbind&&t.unbind("touchstart",r),super.destroy()))}}class AssetLoader extends Component{constructor(t,e){Array.isArray(t)&&(t=t.map(t=>Utils.basename(t)).reduce((e,i,s)=>(e[i]=t[s],e),{})),super();const i=this,s=Object.keys(t).length;let n=0;for(let e in t)r(e,t[e]);function r(t,e){const i=Utils.extension(e);if(!i.includes(["jpg","jpeg","png","gif","svg"]))return i.includes(["mp3","m4a","ogg","wav","aif"])?window.AudioContext&&window.WebAudio?void window.WebAudio.createSound(t,e,a):a():void window.get(Assets.getPath(e),Assets.OPTIONS).then(e=>{"json"===i&&Assets.storeData(t,e),"js"===i&&window.eval(e.replace("use strict","")),a()}).catch(()=>{a()});Assets.createImage(e,a)}function a(){i.percent=++n/s,i.events.fire(Events.PROGRESS,{percent:i.percent},!0),n===s&&(i.events.fire(Events.COMPLETE,null,!0),e&&e())}}static loadAssets(t,e){const i=Promise.create();return e||(e=i.resolve),i.loader=new AssetLoader(t,e),i}}class FontLoader extends Component{constructor(t,e){super();const i=this;let s;!function(){Array.isArray(t)||(t=[t]);s=document.createElement("canvas").getContext("2d"),t.forEach(t=>(t=t.replace(/"/g,"'"),s.font=`12px "${t}"`,void s.fillText("LOAD",0,0))),function(){const t=()=>{i.percent=1,i.events.fire(Events.PROGRESS,{percent:i.percent},!0),i.events.fire(Events.COMPLETE,null,!0),e&&e()};document.fonts&&document.fonts.ready?document.fonts.ready.then(t):i.delayedCall(t,500)}();var n}()}static loadFonts(t,e){const i=Promise.create();return e||(e=i.resolve),i.loader=new FontLoader(t,e),i}}class CanvasValues{constructor(t){this.styles={},t?this.styled=!1:this.data=new Float32Array(6)}setTRSA(t,e,i,s,n,r){const a=this.data;a[0]=t,a[1]=e,a[2]=i,a[3]=s,a[4]=n,a[5]=r}calculate(t){const e=t.data,i=this.data;i[0]=i[0]+e[0],i[1]=i[1]+e[1],i[2]=i[2]+e[2],i[3]=i[3]*e[3],i[4]=i[4]*e[4],i[5]=i[5]*e[5]}calculateStyle(t){if(!t.styled)return!1;this.styled=!0;const e=t.values;for(let t in e)this.styles[t]||(this.styles[t]=e[t])}set shadowOffsetX(t){this.styled=!0,this.styles.shadowOffsetX=t}get shadowOffsetX(){return this.styles.shadowOffsetX}set shadowOffsetY(t){this.styled=!0,this.styles.shadowOffsetY=t}get shadowOffsetY(){return this.styles.shadowOffsetY}set shadowBlur(t){this.styled=!0,this.styles.shadowBlur=t}get shadowBlur(){return this.styles.shadowBlur}set shadowColor(t){this.styled=!0,this.styles.shadowColor=t}get shadowColor(){return this.styles.shadowColor}get values(){return this.styles}}class CanvasObject{constructor(){this.visible=!0,this.blendMode="source-over",this.x=0,this.y=0,this.px=0,this.py=0,this.clipX=0,this.clipY=0,this.clipWidth=0,this.clipHeight=0,this.width=0,this.height=0,this.rotation=0,this.scale=1,this.opacity=1,this.values=new CanvasValues,this.styles=new CanvasValues(!0),this.children=[]}updateValues(){this.values.setTRSA(this.x,this.y,Math.radians(this.rotation),this.scaleX||this.scale,this.scaleY||this.scale,this.opacity),this.parent.values&&this.values.calculate(this.parent.values),this.parent.styles&&this.styles.calculateStyle(this.parent.styles)}render(t){if(!this.visible)return!1;this.updateValues(),this.draw&&this.draw(t);for(let e=0;e<this.children.length;e++)this.children[e].render(t)}startDraw(t=0,e=0,i){const s=this.canvas.context,n=this.values.data,r=n[0]+t,a=n[1]+e;if(s.save(),i||(s.globalCompositeOperation=this.blendMode),s.translate(r,a),s.rotate(n[2]),s.scale(n[3],n[4]),s.globalAlpha=n[5],this.styles.styled){const t=this.styles.values;for(let e in t)s[e]=t[e]}}endDraw(){this.canvas.context.restore()}add(t){t.setCanvas(this.canvas),t.parent=this,this.children.push(t),t.z=this.children.length}setCanvas(t){this.canvas=t;for(let e=0;e<this.children.length;e++)this.children[e].setCanvas(t)}remove(t){t.canvas=null,t.parent=null,this.children.remove(t)}isMask(){let t=this;for(;t;){if(t.masked)return!0;t=t.parent}return!1}unmask(){this.masked.mask(null),this.masked=null}setZ(t){this.z=t,this.parent.children.sort((t,e)=>t.z-e.z)}follow(t){return this.x=t.x,this.y=t.y,this.px=t.px,this.py=t.py,this.clipX=t.clipX,this.clipY=t.clipY,this.clipWidth=t.clipWidth,this.clipHeight=t.clipHeight,this.width=t.width,this.height=t.height,this.rotation=t.rotation,this.scale=t.scale,this.scaleX=t.scaleX||t.scale,this.scaleY=t.scaleY||t.scale,this}visible(){return this.visible=!0,this}invisible(){return this.visible=!1,this}transform(t){for(let e in t)"number"==typeof t[e]&&(this[e]=t[e]);return this}transformPoint(t,e){return this.px="number"==typeof t?t:this.width*(parseFloat(t)/100),this.py="number"==typeof e?e:this.height*(parseFloat(e)/100),this}clip(t,e,i,s){return this.clipX=t,this.clipY=e,this.clipWidth=i,this.clipHeight=s,this}destroy(){if(this.children)for(let t=this.children.length-1;t>=0;t--)this.children[t].destroy();return Utils.nullObject(this)}}class CanvasGraphics extends CanvasObject{constructor(t=0,e=t){super();const i=this;let s,n=[];this.width=t,this.height=e,this.props={},this.draw=(t=>{if(this.isMask()&&!t)return!1;const e=this.canvas.context;this.startDraw(this.px,this.py,t),function(t){for(let e in i.props)t[e]=i.props[e]}(e),this.clipWidth&&this.clipHeight&&(e.beginPath(),e.rect(this.clipX,this.clipY,this.clipWidth,this.clipHeight),e.clip());for(let t=0;t<n.length;t++){const i=n[t];if(!i)continue;const s=i.shift();e[s].apply(e,i),i.unshift(s)}this.endDraw(),s&&(e.globalCompositeOperation=s.blendMode,s.render(!0))}),this.clear=(()=>{for(let t=n.length-1;t>=0;t--)n[t].length=0;n.length=0}),this.arc=((t=0,e=0,i=this.radius||this.width/2,s=0,r=2*Math.PI,a=!1)=>{t&&!e&&(s=Math.radians(-90),r=t,t=0,e=0),n.push(["arc",t,e,i,s,r,a])}),this.quadraticCurveTo=((t,e,i,s)=>{n.push(["quadraticCurveTo",t,e,i,s])}),this.bezierCurveTo=((t,e,i,s,r,a)=>{n.push(["bezierCurveTo",t,e,i,s,r,a])}),this.fillRect=((t,e,i,s)=>{n.push(["fillRect",t,e,i,s])}),this.clearRect=((t,e,i,s)=>{n.push(["clearRect",t,e,i,s])}),this.strokeRect=((t,e,i,s)=>{n.push(["strokeRect",t,e,i,s])}),this.moveTo=((t,e)=>{n.push(["moveTo",t,e])}),this.lineTo=((t,e)=>{n.push(["lineTo",t,e])}),this.stroke=(()=>{n.push(["stroke"])}),this.fill=(()=>{s||n.push(["fill"])}),this.beginPath=(()=>{n.push(["beginPath"])}),this.closePath=(()=>{n.push(["closePath"])}),this.fillText=((t,e=0,i=0)=>{n.push(["fillText",t,e,i])}),this.strokeText=((t,e=0,i=0)=>{n.push(["strokeText",t,e,i])}),this.setLineDash=(t=>{n.push(["setLineDash",t])}),this.drawImage=((t,e=0,i=0,s=t.width,r=t.height,a=0,o=0,h=t.width,l=t.height)=>{n.push(["drawImage",t,e,i,s,r,a+-this.px,o+-this.py,h,l])}),this.mask=(t=>{if(!t)return s=null;s=t,t.masked=this;for(let t=0;t<n.length;t++)"fill"!==n[t][0]&&"stroke"!==n[t][0]||(n[t].length=0,n.splice(t,1))}),this.clone=(()=>{const t=new CanvasGraphics(this.width,this.height);return t.visible=this.visible,t.blendMode=this.blendMode,t.opacity=this.opacity,t.follow(this),t.props=Utils.cloneObject(this.props),t.setDraw(Utils.cloneArray(n)),t}),this.setDraw=(t=>{n=t})}set strokeStyle(t){this.props.strokeStyle=t}get strokeStyle(){return this.props.strokeStyle}set fillStyle(t){this.props.fillStyle=t}get fillStyle(){return this.props.fillStyle}set lineWidth(t){this.props.lineWidth=t}get lineWidth(){return this.props.lineWidth}set lineCap(t){this.props.lineCap=t}get lineCap(){return this.props.lineCap}set lineDashOffset(t){this.props.lineDashOffset=t}get lineDashOffset(){return this.props.lineDashOffset}set lineJoin(t){this.props.lineJoin=t}get lineJoin(){return this.props.lineJoin}set miterLimit(t){this.props.miterLimit=t}get miterLimit(){return this.props.miterLimit}set font(t){this.props.font=t}get font(){return this.props.font}set textAlign(t){this.props.textAlign=t}get textAlign(){return this.props.textAlign}set textBaseline(t){this.props.textBaseline=t}get textBaseline(){return this.props.textBaseline}}class Canvas{constructor(t,e=t,i,s){"boolean"==typeof e&&(i=e,e=t);const n=this;function r(t,e){const r=i?2:1;if(n.element.width=t*r,n.element.height=e*r,n.width=t,n.height=e,n.scale=r,n.object.size(n.width,n.height),n.context.scale(r,r),n.element.style.width=t+"px",n.element.style.height=e+"px",s){const t=new CanvasGraphics(n.width,n.height);t.fillStyle="rgba(255, 255, 255, 0.002)",t.fillRect(0,0,n.width,n.height),t.setCanvas(n),t.parent=n,n.children[0]=t,t.z=1}}this.element=document.createElement("canvas"),this.context=this.element.getContext("2d"),this.object=new Interface(this.element),this.children=[],this.retina=i,r(t,e),this.size=r,this.toDataURL=((t,e)=>this.element.toDataURL(t,e)),this.render=(t=>{"boolean"==typeof t&&t||this.clear();for(let t=0;t<this.children.length;t++)this.children[t].render()}),this.clear=(()=>{this.context.clearRect(0,0,this.element.width,this.element.height)}),this.add=(t=>{t.setCanvas(this),t.parent=this,this.children.push(t),t.z=this.children.length}),this.remove=(t=>{t.canvas=null,t.parent=null,this.children.remove(t)}),this.destroy=(()=>{if(this.children)for(let t=this.children.length-1;t>=0;t--)this.children[t].destroy();return this.object.destroy(),Utils.nullObject(this)}),this.getImageData=((t=0,e=0,i=this.element.width,s=this.element.height)=>(this.imageData=this.context.getImageData(t,e,i,s),this.imageData)),this.getPixel=((t,e,i)=>{this.imageData&&!i||this.getImageData();const s={},n=4*(t+e*this.element.width),r=this.imageData.data;return s.r=r[n],s.g=r[n+1],s.b=r[n+2],s.a=r[n+3],s}),this.putImageData=(t=>{this.context.putImageData(t,0,0)})}}class CanvasFont{static createText(t,e,i,s,n,r,{textBaseline:a="alphabetic",lineHeight:o=i,letterSpacing:h=0,textAlign:l="start"}){const c=t.context;if(i===o)return u(t,e,i,s,n,r,a,h,l);{const d=new CanvasGraphics(e,i),p=s.split(" "),m=[];let v="";d.totalWidth=0,d.totalHeight=0,c.font=n;for(let t=0;t<p.length;t++){const i=v+p[t]+" ",s=i.split("");let n=0;for(let t=0;t<s.length;t++)n+=c.measureText(s[t]).width+h;n>e&&t>0?(m.push(v),v=p[t]+" "):v=i}return m.push(v),m.forEach((i,s)=>{const c=u(t,e,o,i.slice(0,-1),n,r,a,h,l);c.y=s*o,d.add(c),d.totalWidth=Math.max(c.totalWidth,d.totalWidth),d.totalHeight+=o}),d}function u(t,e,i,s,n,r,a,o,h){const l=t.context,c=new CanvasGraphics(e,i);c.font=n,c.fillStyle=r,c.textBaseline=a,c.totalWidth=0,c.totalHeight=i;const u=s.split("");let d,p=0,m=0;l.font=n;for(let t=0;t<u.length;t++)c.totalWidth+=l.measureText(u[t]).width+o;switch(h){case"start":case"left":m=0;break;case"end":case"right":m=e-c.totalWidth;break;case"center":m=(e-c.totalWidth)/2}do{d=u[p++],c.fillText(d,m,0),m+=l.measureText(d).width+o}while(p<s.length);return c}}}navigator.getUserMedia||(navigator.getUserMedia=navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia);class Shader extends Component{constructor(t,e,i){super();const s=this;function n(t,e){let i;return(t=(i="vs"===e?["precision highp float;","precision highp int;","attribute vec2 uv;","attribute vec3 position;","attribute vec3 normal;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;"].join("\n"):[~t.indexOf("dFdx")?"#extension GL_OES_standard_derivatives : enable":"","precision highp float;","precision highp int;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;"].join("\n"))+"\n\n"+t).replace(/#s?chunk\(\s?(\w+)\s?\);/g,(t,e)=>THREE.ShaderChunk[e]+"\n")}this.uniforms={},this.properties={},function(){for(let t in i)void 0!==i[t].value?s.uniforms[t]=i[t]:s.properties[t]=i[t]}(),function(){const i={};i.vertexShader=n(t,"vs"),i.fragmentShader=n(e,"fs"),i.uniforms=s.uniforms;for(let t in s.properties)i[t]=s.properties[t];s.material=new THREE.RawShaderMaterial(i),s.material.shader=s,s.uniforms=s.material.uniforms}(),this.destroy=(()=>(this.material.dispose(),super.destroy()))}}var vertBasicShader="#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragBasicShader="#define GLSLIFY 1\nuniform float time;\nuniform vec2 resolution;\nuniform sampler2D texture;\nuniform float opacity;\n\nvarying vec2 vUv;\n\nvoid main() {\n    vec4 color = texture2D(texture, vUv);\n    color.a *= opacity;\n    gl_FragColor = color;\n}\n",vertDissolve="#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main() {\n    vUv = uv;\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragDissolve="#define GLSLIFY 1\n// Based on https://www.shadertoy.com/view/4s3GWj by NemoKradXNA\n\nuniform float time;\nuniform vec2 resolution;\nuniform sampler2D texture1;\nuniform sampler2D texture2;\nuniform float opacity;\nuniform float progress;\n\nvarying vec2 vUv;\n\nvoid main() {\n    vec4 color = mix(texture2D(texture1, vUv), texture2D(texture2, vUv), progress);\n    color.a *= opacity;\n    gl_FragColor = color;\n}\n";Config.UI_COLOR="white",Config.ASSETS=["assets/js/lib/three.min.js","assets/images/NGC_1672_1920px.jpg","assets/images/Orion_Nebula_1920px.jpg"],Assets.CORS="anonymous",Assets.OPTIONS={mode:"cors"};class TitleTexture extends Component{constructor(){super();const t=this,e=Device.phone?28:66;let i,s,n;i=t.initClass(Canvas,Stage.width,Stage.height,!0,!0),(s=new THREE.Texture(i.element)).minFilter=THREE.LinearFilter,t.texture=s,this.update=(()=>{i.size(Stage.width,Stage.height),n&&(i.remove(n),n=n.destroy()),n=CanvasFont.createText(i,Stage.width,Stage.height,"Dissolve".toUpperCase(),`200 ${e}px Oswald`,Config.UI_COLOR,{lineHeight:Device.phone?35:80,letterSpacing:0,textAlign:"center"});const t=Device.phone?55:120;n.y=(Stage.height-n.totalHeight+t)/2,i.add(n),i.render(),s.needsUpdate=!0})}}class Title extends Component{constructor(){super();const t=this;let e,i,s;this.object3D=new THREE.Object3D,World.scene.add(this.object3D),e=t.initClass(TitleTexture),i=t.initClass(Shader,vertBasicShader,fragBasicShader,{time:World.time,resolution:World.resolution,texture:{value:e.texture},opacity:{value:0},transparent:!0,depthWrite:!1,depthTest:!1}),s=new THREE.Mesh(new THREE.PlaneBufferGeometry(1,1),i.material),t.object3D.add(s),this.update=(()=>{e.update(),s.scale.set(Stage.width,Stage.height,1)}),this.animateIn=(()=>{i.uniforms.opacity.value=0,TweenManager.tween(i.uniforms.opacity,{value:1},250,"linear")})}}class Space extends Component{constructor(){super();const t=this,e=1920/1080;let i,s,n,r,a,o=0;function h(e){(i=new THREE.Texture(e[0])).minFilter=THREE.LinearFilter,i.needsUpdate=!0,(s=new THREE.Texture(e[1])).minFilter=THREE.LinearFilter,s.needsUpdate=!0,t.object3D.visible=!1,n=t.initClass(Shader,vertDissolve,fragDissolve,{time:World.time,resolution:World.resolution,texture1:{value:i},texture2:{value:s},opacity:{value:0},progress:{value:o},depthWrite:!1,depthTest:!1}),r=new THREE.Mesh(new THREE.PlaneBufferGeometry(1,1),n.material),t.object3D.add(r),a=t.initClass(Title),t.events.add(Events.RESIZE,u),t.events.add(Mouse.input,Interaction.START,l),t.events.add(Mouse.input,Interaction.END,c),c(),u(),t.startRender(d),t.object3D.visible=!0,n.uniforms.opacity.value=0,n.uniforms.progress.value=0,TweenManager.tween(n.uniforms.opacity,{value:1},1e3,"easeOutCubic"),TweenManager.tween(n.uniforms.progress,{value:1},7e3,"easeOutSine"),a.animateIn()}function l(){o=0}function c(){o=1}function u(){Stage.width/Stage.height>e?r.scale.set(Stage.width,Stage.width/e,1):r.scale.set(Stage.height*e,Stage.height,1),a.update()}function d(){t.object3D.visible&&(n.uniforms.progress.value+=.3*(o-n.uniforms.progress.value))}this.object3D=new THREE.Object3D,World.scene.add(this.object3D),Promise.all([Assets.loadImage("assets/images/Orion_Nebula_1920px.jpg"),Assets.loadImage("assets/images/NGC_1672_1920px.jpg")]).then(h)}}class World extends Component{static instance(){return this.singleton||(this.singleton=new World),this.singleton}static destroy(){return this.singleton&&this.singleton.destroy(),Utils.nullObject(this)}constructor(){super();const t=this;let e,i,s;function n(){e.setSize(Stage.width,Stage.height),s.left=-Stage.width/2,s.right=Stage.width/2,s.top=Stage.height/2,s.bottom=-Stage.height/2,s.updateProjectionMatrix(),World.resolution.value.set(Stage.width*World.dpr,Stage.height*World.dpr)}World.dpr=Math.min(2,Device.pixelRatio),(e=new THREE.WebGLRenderer({powerPreference:"high-performance"})).setPixelRatio(World.dpr),i=new THREE.Scene,s=new THREE.OrthographicCamera(-1,1,1,-1,0,1),World.scene=i,World.renderer=e,World.element=e.domElement,World.camera=s,World.time={value:0},World.resolution={value:new THREE.Vector2(Stage.width*World.dpr,Stage.height*World.dpr)},t.events.add(Events.RESIZE,n),n(),this.startRender(function(t,n){World.time.value+=.001*n,e.render(i,s)}),this.destroy=(()=>{for(let t=i.children.length-1;t>=0;t--){const e=i.children[t];i.remove(e),e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()}return e.dispose(),e.forceContextLoss(),e.context=null,e.domElement=null,s=null,i=null,e=null,Stage.remove(World.element),super.destroy()})}}class Progress extends Interface{constructor(){super("Progress");const t=this,e=90;let i,s;function n(){t.complete||(t.progress>=1&&(t.complete=!0,t.events.fire(Events.COMPLETE),t.stopRender(n)),function(){s.clear();const e=Math.radians(-90)+Math.radians(360*t.progress);s.beginPath(),s.arc(e),s.stroke()}(),i.render())}t.size(e),t.progress=0,i=t.initClass(Canvas,e,!0),(s=t.initClass(CanvasGraphics)).x=e/2,s.y=e/2,s.radius=.4*e,s.lineWidth=1.5,s.strokeStyle=Config.UI_COLOR,i.add(s),this.startRender(n),this.update=(t=>{this.complete||TweenManager.tween(this,{progress:t.percent},500,"easeOutCubic")}),this.animateOut=(t=>{this.tween({scale:.9,opacity:0},400,"easeInCubic",t)})}}class Loader extends Interface{constructor(){super("Loader");const t=this;let e,i;function s(t){i.update(t)}function n(){t.events.fire(Events.COMPLETE)}t.size("100%"),e=t.initClass(AssetLoader,Config.ASSETS),t.events.add(e,Events.PROGRESS,s),(i=t.initClass(Progress)).center(),t.events.add(i,Events.COMPLETE,n),this.animateOut=(t=>{i.animateOut(t)})}}class Main{constructor(){let t;function e(){t.animateOut(()=>{t=t.destroy(),Stage.events.fire(Events.COMPLETE)})}function i(){World.instance(),Stage.add(World),Stage.initClass(Space)}Stage.size("100%"),Mouse.init(),FontLoader.loadFonts(["Oswald","Karla"]).then(()=>{t=Stage.initClass(Loader),Stage.events.add(t,Events.COMPLETE,e)}),Stage.events.add(Events.COMPLETE,i)}}new Main;
