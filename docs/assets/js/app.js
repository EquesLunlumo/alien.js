//   _  /._  _  r14 2018-11-06 3:10pm
//  /_|///_'/ /
Promise.create=function(){let e,t;const i=new Promise(function(i,s){e=i,t=s});return i.resolve=e,i.reject=t,i},Math.sign=function(e){return 0===(e=+e)||isNaN(e)?Number(e):e>0?1:-1},Math.degrees=function(e){return e*(180/Math.PI)},Math.radians=function(e){return e*(Math.PI/180)},Math.clamp=function(e,t,i){return Math.min(Math.max(e,Math.min(t,i)),Math.max(t,i))},Math.range=function(e,t,i,s,n,a){const o=(e-t)*(n-s)/(i-t)+s;return a?Math.clamp(o,s,n):o},Math.mix=function(e,t,i){return e*(1-i)+t*i},Math.step=function(e,t){return t<e?0:1},Math.smoothStep=function(e,t,i){const s=Math.max(0,Math.min(1,(i-e)/(t-e)));return s*s*(3-2*s)},Math.fract=function(e){return e-Math.floor(e)},Math.mod=function(e,t){return(e%t+t)%t},Array.prototype.shuffle=function(){let e,t,i=this.length;for(;0!==i;)t=Math.floor(Math.random()*i),e=this[i-=1],this[i]=this[t],this[t]=e;return this},Array.storeRandom=function(e){e.randomStore=[]},Array.prototype.random=function(e){let t=Math.floor(Math.random()*this.length);if(e&&!this.randomStore&&Array.storeRandom(this),!this.randomStore)return this[t];if(e>this.length-1&&(e=this.length),e>1){for(;~this.randomStore.indexOf(t);)t++>this.length-1&&(t=0);this.randomStore.push(t),this.randomStore.length>=e&&this.randomStore.shift()}return this[t]},Array.prototype.remove=function(e){const t=this.indexOf(e);if(~t)return this.splice(t,1)},Array.prototype.last=function(){return this[this.length-1]},String.prototype.includes=function(e){if(!Array.isArray(e))return~this.indexOf(e);for(let t=0;t<e.length;t++)if(~this.indexOf(e[t]))return!0;return!1},String.prototype.clip=function(e,t){return this.length>e?this.slice(0,e)+t:this},String.prototype.capitalize=function(){return this.charAt(0).toUpperCase()+this.slice(1)},String.prototype.replaceAll=function(e,t){return this.split(e).join(t)},Date.prototype.addDays=function(e){const t=new Date(this.valueOf());return t.setDate(t.getDate()+e),t},window.get=function(e,t={}){const i=Promise.create();return t.method="GET",window.fetch(e,t).then(function(e){if(!e.ok)return i.reject(e);e.text().then(function(e){if(e.charAt(0).includes(["[","{"]))try{i.resolve(JSON.parse(e))}catch(t){i.resolve(e)}else i.resolve(e)})}).catch(i.reject),i},window.post=function(e,t,i={}){const s=Promise.create();return i.method="POST",i.body=JSON.stringify(t),window.fetch(e,i).then(function(e){if(!e.ok)return s.reject(e);e.text().then(function(e){if(e.charAt(0).includes(["[","{"]))try{s.resolve(JSON.parse(e))}catch(t){s.resolve(e)}else s.resolve(e)})}).catch(s.reject),s},window.getURL=function(e,t="_blank"){window.open(e,t)},window.Config||(window.Config={}),window.Global||(window.Global={});class Utils{static random(e,t,i=0){if(void 0===e)return Math.random();if(e===t)return e;e=e||0,t=t||1;const s=Math.pow(10,i);return Math.round((e+Math.random()*(t-e))*s)/s}static headsTails(e,t){return this.random(0,1)?t:e}static queryString(e){const t=decodeURI(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+encodeURI(e).replace(/[.+*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"));return!(!t.length||"0"===t||"false"===t)&&t}static getConstructorName(e){return e.constructor.name||e.constructor.toString().match(/function ([^(]+)/)[1]}static nullObject(e){for(let t in e)void 0!==e[t]&&(e[t]=null);return null}static cloneObject(e){return JSON.parse(JSON.stringify(e))}static mergeObject(...e){const t={};for(let i of e)Object.assign(t,i);return t}static cloneArray(e){return e.slice(0)}static basename(e,t){const i=e.split("/").last();return t?i:i.split(".")[0]}static extension(e){return e.split(".").last().split("?")[0].toLowerCase()}static base64(e){return window.btoa(encodeURIComponent(e).replace(/%([0-9A-F]{2})/g,(e,t)=>String.fromCharCode("0x"+t)))}static date(e){const t=e.split(/[^0-9]/);return new Date(t[0],t[1]-1,t[2],t[3],t[4],t[5])}static timestamp(){return(Date.now()+this.random(0,99999)).toString()}static pad(e){return e<10?"0"+e:e}static get hash(){return window.location.hash.slice(1)}}class Render{static init(){const e=this,t=[],i=200;let s=performance.now();function n(a){const o=Math.min(i,a-s);s=a,e.TIME=a,e.DELTA=o;for(let e=t.length-1;e>=0;e--){const i=t[e];if(i)if(i.fps){if(a-i.last<1e3/i.fps)continue;i(++i.frame),i.last=a}else i(a,o);else t.remove(i)}e.paused||requestAnimationFrame(n)}requestAnimationFrame(n),this.start=((e,i)=>{i&&(e.fps=i,e.last=-1/0,e.frame=-1),~t.indexOf(e)||t.unshift(e)}),this.stop=(e=>{t.remove(e)}),this.tick=(()=>{this.TIME=performance.now(),n(this.TIME)}),this.pause=(()=>{this.paused=!0}),this.resume=(()=>{this.paused&&(this.paused=!1,requestAnimationFrame(n))})}}Render.init();class Timer{static init(){const e=[],t=[];Render.start(function(i,s){for(let i=0;i<t.length;i++){const s=t[i];s.callback=null,e.remove(s)}t.length&&(t.length=0);for(let i=0;i<e.length;i++){const n=e[i];n?(n.current+=s)>=n.time&&(n.callback&&n.callback(...n.args),t.push(n)):e.remove(n)}}),this.clearTimeout=(t=>{const i=function(t){for(let i=0;i<e.length;i++)if(e[i].ref===t)return e[i];return null}(t);return!!i&&(i.callback=null,e.remove(i),!0)}),this.create=((t,i=1,...s)=>{const n={time:Math.max(1,i),current:0,ref:Utils.timestamp(),callback:t,args:s};return e.push(n),n.ref}),window.defer=this.defer=(e=>this.create(e,1))}}Timer.init();class Events{constructor(){class e{constructor(){this.events=[],this.links=[]}add(e,t,i){this.events.push({event:e,callback:t,object:i})}remove(e,t){for(let i=this.events.length-1;i>=0;i--)this.events[i].event===e&&this.events[i].callback===t&&(this.events[i].removed=!0,this.events.splice(i,1)[0]=null)}fire(e,t={}){let i=!1;const s=Utils.cloneArray(this.events);for(let n=0;n<s.length;n++)s[n].event!==e||s[n].removed||(s[n].callback(t),i=!0);return i}destroy(e){for(let t=this.events.length-1;t>=0;t--)this.events[t].object===e&&(this.events.splice(t,1)[0]=null)}link(e){~this.links.indexOf(e)||this.links.push(e)}}Events.initialized||(Events.emitter=new e,Events.VISIBILITY="visibility",Events.COMPLETE="complete",Events.PROGRESS="progress",Events.UPDATE="update",Events.LOADED="loaded",Events.ERROR="error",Events.READY="ready",Events.RESIZE="resize",Events.CLICK="click",Events.HOVER="hover",Events.FULLSCREEN="fullscreen",Events.KEYBOARD_PRESS="keyboard_press",Events.KEYBOARD_DOWN="keyboard_down",Events.KEYBOARD_UP="keyboard_up",Events.initialized=!0);const t=[];this.emitter=new e,this.add=((e,i,s)=>{if("object"!=typeof e&&(s=i,i=e,e=null),e){const n=e.events.emitter;n.add(i,s,this),n.link(this),t.push(n)}else Events.emitter.add(i,s,this)}),this.remove=((e,t,i)=>{"object"!=typeof e&&(i=t,t=e,e=null),e?e.events.emitter.remove(t,i):Events.emitter.remove(t,i)}),this.fire=((e,t={},i)=>{this.emitter.fire(e,t)||i||Events.emitter.fire(e,t)}),this.bubble=((e,t)=>{this.add(e,t,e=>this.fire(t,e))}),this.destroy=(()=>(Events.emitter.destroy(this),t.forEach(e=>e.destroy(this)),this.emitter.links.forEach(e=>{e.unlink&&e.unlink(this.emitter)}),Utils.nullObject(this))),this.unlink=(e=>{t.remove(e)})}}class Device{static init(){this.agent=navigator.userAgent.toLowerCase(),this.pixelRatio=window.devicePixelRatio,this.webcam=!!(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia),this.language=navigator.userLanguage||navigator.language,this.webaudio=!!window.AudioContext,this.os=(()=>this.detect(["iphone","ipad"])?"ios":this.detect(["android"])?"android":this.detect(["blackberry"])?"blackberry":this.detect(["mac os"])?"mac":this.detect(["windows"])?"windows":this.detect(["linux"])?"linux":"unknown")(),this.browser=(()=>"ios"===this.os?this.detect(["safari"])?"safari":"unknown":"android"===this.os?this.detect(["chrome"])?"chrome":this.detect(["firefox"])?"firefox":"browser":this.detect(["msie"])?"ie":this.detect(["trident"])&&this.detect(["rv:"])?"ie":this.detect(["windows"])&&this.detect(["edge"])?"ie":this.detect(["chrome"])?"chrome":this.detect(["safari"])?"safari":this.detect(["firefox"])?"firefox":"unknown")(),this.mobile=this.detect(["iphone","ipad","android","blackberry"]),this.mobile&&(this.tablet=Math.max(window.screen?screen.width:window.innerWidth,window.screen?screen.height:window.innerHeight)>1e3,this.phone=!this.tablet),this.webgl=(()=>{try{const e=["webgl","experimental-webgl","webkit-3d","moz-webgl"],t=document.createElement("canvas");let i;for(let s=0;s<e.length&&!(i=t.getContext(e[s]));s++);const s=i.getExtension("WEBGL_debug_renderer_info"),n={};return s&&(n.gpu=i.getParameter(s.UNMASKED_RENDERER_WEBGL).toLowerCase()),n.renderer=i.getParameter(i.RENDERER).toLowerCase(),n.version=i.getParameter(i.VERSION).toLowerCase(),n.glsl=i.getParameter(i.SHADING_LANGUAGE_VERSION).toLowerCase(),n.extensions=i.getSupportedExtensions(),n.detect=(e=>{if(n.gpu&&n.gpu.includes(e))return!0;if(n.version&&n.version.includes(e))return!0;for(let t=0;t<n.extensions.length;t++)if(n.extensions[t].toLowerCase().includes(e))return!0;return!1}),n}catch(e){return!1}})()}static detect(e){return this.agent.includes(e)}static vibrate(e){navigator.vibrate&&navigator.vibrate(e)}}Device.init();class Component{constructor(){this.events=new Events,this.classes=[],this.timers=[],this.loops=[]}initClass(e,...t){const i=new e(...t);return this.add(i),i}add(e){return e.destroy&&(this.classes.push(e),e.parent=this),this}delayedCall(e,t=0,...i){if(!this.timers)return;const s=Timer.create(()=>{e&&e(...i)},t);return this.timers.push(s),this.timers.length>50&&this.timers.shift(),s}clearTimers(){for(let e=this.timers.length-1;e>=0;e--)Timer.clearTimeout(this.timers[e]);this.timers.length=0}startRender(e,t){this.loops.push(e),Render.start(e,t)}stopRender(e){this.loops.remove(e),Render.stop(e)}clearRenders(){for(let e=this.loops.length-1;e>=0;e--)this.stopRender(this.loops[e]);this.loops.length=0}destroy(){if(this.classes){this.removed=!0;const e=this.parent;e&&!e.removed&&e.remove&&e.remove(this);for(let e=this.classes.length-1;e>=0;e--){const t=this.classes[e];t&&t.destroy&&t.destroy()}this.classes.length=0,this.clearRenders(),this.clearTimers(),this.events.destroy()}return Utils.nullObject(this)}remove(e){this.classes.remove(e)}}class Assets{static init(){const e={},t={};this.CDN="",this.CORS=null,this.getPath=(e=>~e.indexOf("//")?e:(this.CDN&&!~e.indexOf(this.CDN)&&(e=this.CDN+e),e)),this.createImage=((t,i,s)=>{"boolean"!=typeof i&&(s=i,i=null);const n=new Image;return n.crossOrigin=this.CORS,n.onload=s,n.onerror=s,n.src=this.getPath(t),i&&(e[t]=n),n}),this.getImage=(t=>e[t]),this.storeData=((e,i)=>(t[e]=i,t[e])),this.getData=(e=>t[e])}static loadImage(e){"string"==typeof e&&(e=this.createImage(e));const t=Promise.create();return e.onload=(()=>t.resolve(e)),e.onerror=(()=>t.resolve(e)),t}}Assets.init();class Interpolation{static init(){function e(e,n,a){return((t(n,a)*e+i(n,a))*e+s(n))*e}function t(e,t){return 1-3*t+3*e}function i(e,t){return 3*t-6*e}function s(e){return 3*e}this.convertEase=(e=>(()=>{let t;switch(e){case"easeInQuad":t=this.Quad.In;break;case"easeInCubic":t=this.Cubic.In;break;case"easeInQuart":t=this.Quart.In;break;case"easeInQuint":t=this.Quint.In;break;case"easeInSine":t=this.Sine.In;break;case"easeInExpo":t=this.Expo.In;break;case"easeInCirc":t=this.Circ.In;break;case"easeInElastic":t=this.Elastic.In;break;case"easeInBack":t=this.Back.In;break;case"easeInBounce":t=this.Bounce.In;break;case"easeOutQuad":t=this.Quad.Out;break;case"easeOutCubic":t=this.Cubic.Out;break;case"easeOutQuart":t=this.Quart.Out;break;case"easeOutQuint":t=this.Quint.Out;break;case"easeOutSine":t=this.Sine.Out;break;case"easeOutExpo":t=this.Expo.Out;break;case"easeOutCirc":t=this.Circ.Out;break;case"easeOutElastic":t=this.Elastic.Out;break;case"easeOutBack":t=this.Back.Out;break;case"easeOutBounce":t=this.Bounce.Out;break;case"easeInOutQuad":t=this.Quad.InOut;break;case"easeInOutCubic":t=this.Cubic.InOut;break;case"easeInOutQuart":t=this.Quart.InOut;break;case"easeInOutQuint":t=this.Quint.InOut;break;case"easeInOutSine":t=this.Sine.InOut;break;case"easeInOutExpo":t=this.Expo.InOut;break;case"easeInOutCirc":t=this.Circ.InOut;break;case"easeInOutElastic":t=this.Elastic.InOut;break;case"easeInOutBack":t=this.Back.InOut;break;case"easeInOutBounce":t=this.Bounce.InOut;break;case"linear":t=this.Linear.None}if(!t){const i=TweenManager.getEase(e);if(i){const e=i.split("(")[1].slice(0,-1).split(",");for(let t=0;t<e.length;t++)e[t]=parseFloat(e[t]);t=e}else t=this.Cubic.Out}return t})()),this.solve=((n,a)=>n[0]===n[1]&&n[2]===n[3]?a:e(function(n,a,o){let r=n;for(let u=0;u<4;u++){const u=(l=r,3*t(c=a,h=o)*l*l+2*i(c,h)*l+s(c));if(0===u)return r;r-=(e(r,a,o)-n)/u}var l,c,h;return r}(a,n[0],n[2]),n[1],n[3])),this.Linear={None:e=>e},this.Quad={In:e=>e*e,Out:e=>e*(2-e),InOut:e=>(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},this.Cubic={In:e=>e*e*e,Out:e=>--e*e*e+1,InOut:e=>(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},this.Quart={In:e=>e*e*e*e,Out:e=>1- --e*e*e*e,InOut:e=>(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},this.Quint={In:e=>e*e*e*e*e,Out:e=>--e*e*e*e*e+1,InOut:e=>(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},this.Sine={In:e=>1-Math.cos(e*Math.PI/2),Out:e=>Math.sin(e*Math.PI/2),InOut:e=>.5*(1-Math.cos(Math.PI*e))},this.Expo={In:e=>0===e?0:Math.pow(1024,e-1),Out:e=>1===e?1:1-Math.pow(2,-10*e),InOut:e=>0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))},this.Circ={In:e=>1-Math.sqrt(1-e*e),Out:e=>Math.sqrt(1- --e*e),InOut:e=>(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},this.Elastic={In(e,t=1,i=.4){let s;return 0===e?0:1===e?1:(!t||t<1?(t=1,s=i/4):s=i*Math.asin(1/t)/(2*Math.PI),-t*Math.pow(2,10*(e-=1))*Math.sin((e-s)*(2*Math.PI)/i))},Out(e,t=1,i=.4){let s;return 0===e?0:1===e?1:(!t||t<1?(t=1,s=i/4):s=i*Math.asin(1/t)/(2*Math.PI),t*Math.pow(2,-10*e)*Math.sin((e-s)*(2*Math.PI)/i)+1)},InOut(e,t=1,i=.4){let s;return 0===e?0:1===e?1:(!t||t<1?(t=1,s=i/4):s=i*Math.asin(1/t)/(2*Math.PI),(e*=2)<1?t*Math.pow(2,10*(e-=1))*Math.sin((e-s)*(2*Math.PI)/i)*-.5:t*Math.pow(2,-10*(e-=1))*Math.sin((e-s)*(2*Math.PI)/i)*.5+1)}},this.Back={In(e){const t=1.70158;return e*e*((t+1)*e-t)},Out(e){const t=1.70158;return--e*e*((t+1)*e+t)+1},InOut(e){const t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}},this.Bounce={In:e=>1-Interpolation.Bounce.Out(1-e),Out:e=>e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375,InOut:e=>e<.5?.5*Interpolation.Bounce.In(2*e):.5*Interpolation.Bounce.Out(2*e-1)+.5}}}Interpolation.init();class MathTween{constructor(e,t,i,s,n,a,o){const r=this;let l,c,h,u,d,p,m,g;function f(){if(!e&&!t)return!1;e.mathTween=null,TweenManager.removeMathTween(r),Utils.nullObject(r),e.mathTweens&&e.mathTweens.remove(r)}!function(){!e.multiTween&&e.mathTween&&TweenManager.clearTween(e);TweenManager.addMathTween(r),e.mathTween=r,e.multiTween&&(e.mathTweens||(e.mathTweens=[]),e.mathTweens.push(r));s=Interpolation.convertEase(s),u="function"==typeof s,l=performance.now(),l+=n,h=t,c={},t.spring&&(p=t.spring);t.damping&&(m=t.damping);for(let t in h)"number"==typeof e[t]&&(c[t]=e[t])}(),this.update=(e=>{if(d||e<l)return;g=(g=(e-l)/i)>1?1:g;const t=this.interpolate(g);a&&a(t),1===g&&(o&&o(),f())}),this.stop=(()=>{f()}),this.pause=(()=>{d=!0}),this.resume=(()=>{d=!1,l=performance.now()-g*i}),this.interpolate=(t=>{const i=u?s(t,p,m):Interpolation.solve(s,t);for(let t in c)if("number"==typeof c[t]&&"number"==typeof h[t]){const s=c[t],n=h[t];e[t]=s+(n-s)*i}return i})}}class TweenManager{static init(){const e=this,t=[];this.TRANSFORMS=["x","y","z","scale","scaleX","scaleY","rotation","rotationX","rotationY","rotationZ","skewX","skewY","perspective"],this.CSS_EASES={easeOutCubic:"cubic-bezier(0.215, 0.610, 0.355, 1.000)",easeOutQuad:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",easeOutQuart:"cubic-bezier(0.165, 0.840, 0.440, 1.000)",easeOutQuint:"cubic-bezier(0.230, 1.000, 0.320, 1.000)",easeOutSine:"cubic-bezier(0.390, 0.575, 0.565, 1.000)",easeOutExpo:"cubic-bezier(0.190, 1.000, 0.220, 1.000)",easeOutCirc:"cubic-bezier(0.075, 0.820, 0.165, 1.000)",easeOutBack:"cubic-bezier(0.175, 0.885, 0.320, 1.275)",easeInCubic:"cubic-bezier(0.550, 0.055, 0.675, 0.190)",easeInQuad:"cubic-bezier(0.550, 0.085, 0.680, 0.530)",easeInQuart:"cubic-bezier(0.895, 0.030, 0.685, 0.220)",easeInQuint:"cubic-bezier(0.755, 0.050, 0.855, 0.060)",easeInSine:"cubic-bezier(0.470, 0.000, 0.745, 0.715)",easeInCirc:"cubic-bezier(0.600, 0.040, 0.980, 0.335)",easeInBack:"cubic-bezier(0.600, -0.280, 0.735, 0.045)",easeInOutCubic:"cubic-bezier(0.645, 0.045, 0.355, 1.000)",easeInOutQuad:"cubic-bezier(0.455, 0.030, 0.515, 0.955)",easeInOutQuart:"cubic-bezier(0.770, 0.000, 0.175, 1.000)",easeInOutQuint:"cubic-bezier(0.860, 0.000, 0.070, 1.000)",easeInOutSine:"cubic-bezier(0.445, 0.050, 0.550, 0.950)",easeInOutExpo:"cubic-bezier(1.000, 0.000, 0.000, 1.000)",easeInOutCirc:"cubic-bezier(0.785, 0.135, 0.150, 0.860)",easeInOutBack:"cubic-bezier(0.680, -0.550, 0.265, 1.550)",easeInOut:"cubic-bezier(0.420, 0.000, 0.580, 1.000)",linear:"linear"},Render.start(function(i){for(let s=t.length-1;s>=0;s--){const n=t[s];n.update?n.update(i):e.removeMathTween(n)}}),this.addMathTween=(e=>{t.push(e)}),this.removeMathTween=(e=>{t.remove(e)}),this.tween=((e,t,i,s,n,a,o)=>{"number"!=typeof n&&(o=a,a=n,n=0);let r=null;"undefined"!=typeof Promise&&(r=Promise.create(),a&&r.then(a),a=r.resolve);const l=new MathTween(e,t,i,s,n,o,a);return r||l}),this.clearTween=(e=>{if(e.mathTween&&e.mathTween.stop(),e.mathTweens){const t=e.mathTweens;for(let e=t.length-1;e>=0;e--){const i=t[e];i&&i.stop()}e.mathTweens=null}}),this.isTransform=(e=>~this.TRANSFORMS.indexOf(e)),this.getEase=(e=>this.CSS_EASES[e]||this.CSS_EASES.easeOutCubic),this.getAllTransforms=(e=>{const t={};for(let i=0;i<this.TRANSFORMS.length;i++){const s=this.TRANSFORMS[i],n=e[s];0!==n&&"number"==typeof n&&(t[s]=n)}return t}),this.parseTransform=(e=>{let t="";if(void 0!==e.x||void 0!==e.y||void 0!==e.z){const i=e.x||0,s=e.y||0,n=e.z||0;let a="";a+=i+"px, ",a+=s+"px, ",t+="translate3d("+(a+=n+"px")+")"}return void 0!==e.scale?t+="scale("+e.scale+")":(void 0!==e.scaleX&&(t+="scaleX("+e.scaleX+")"),void 0!==e.scaleY&&(t+="scaleY("+e.scaleY+")")),void 0!==e.rotation&&(t+="rotate("+e.rotation+"deg)"),void 0!==e.rotationX&&(t+="rotateX("+e.rotationX+"deg)"),void 0!==e.rotationY&&(t+="rotateY("+e.rotationY+"deg)"),void 0!==e.rotationZ&&(t+="rotateZ("+e.rotationZ+"deg)"),void 0!==e.skewX&&(t+="skewX("+e.skewX+"deg)"),void 0!==e.skewY&&(t+="skewY("+e.skewY+"deg)"),void 0!==e.perspective&&(t+="perspective("+e.perspective+"px)"),t}),this.interpolate=((e,t,i)=>{const s=Interpolation.convertEase(i);return e*("function"==typeof s?s(t):Interpolation.solve(s,t))}),this.interpolateValues=((e,t,i,s)=>{const n=Interpolation.convertEase(s);return e+(t-e)*("function"==typeof n?n(i):Interpolation.solve(n,i))})}}TweenManager.init();class CSSTransition{constructor(e,t,i,s,n,a){const o=this;let r,l;function c(){return!o||o.kill||!e||!e.element}function h(){c()||(o.kill=!0,e.element.style.transition="",e.willChange(null),e.cssTween=null,e=t=null,Utils.nullObject(o))}this.playing=!0,function(){const i=TweenManager.getAllTransforms(e),s=[];for(let e in t)TweenManager.isTransform(e)?(i.use=!0,i[e]=t[e],delete t[e]):("number"==typeof t[e]||~e.indexOf("-"))&&s.push(e);i.use&&(s.push("transform"),delete i.use);r=i,l=s}(),function(){if(c())return;e.cssTween&&e.cssTween.stop();e.cssTween=o;const u=function(e,t,i){let s="",n="";for(let a=0;a<l.length;a++){const o=l[a];s+=(s.length?", ":"")+o,n+=(n.length?", ":"")+o+" "+e+"ms "+TweenManager.getEase(t)+" "+i+"ms"}return{props:s,transition:n}}(i,s,n);e.willChange(u.props),Timer.create(()=>{c()||(e.element.style.transition=u.transition,e.css(t),e.transform(r),Timer.create(()=>{c()||(o.playing=!1,Timer.create(()=>{c()||e.cssTween&&!e.cssTween.playing&&h()},1e3),a&&a())},i+n))},35)}(),this.stop=h}}class Interface{constructor(e,t="div",i){if(this.events=new Events,this.classes=[],this.timers=[],this.loops=[],void 0!==e){if("string"!=typeof e&&e)this.element=e;else{if(this.name=e,this.type=t,"svg"===t){const e=i||"svg";i=!0,this.element=document.createElementNS("http://www.w3.org/2000/svg",e)}else this.element=document.createElement(t),"."!==e.charAt(0)?this.element.id=e:this.element.className=e.substr(1),this.element.style.position="absolute";i||document.body.appendChild(this.element)}this.element.object=this}}initClass(e,...t){const i=new e(...t);return this.add(i),i}add(e){return e.destroy&&(this.classes.push(e),e.parent=this),e.element?this.element.appendChild(e.element):e.nodeName&&this.element.appendChild(e),this}delayedCall(e,t=0,...i){if(!this.timers)return;const s=Timer.create(()=>{e&&e(...i)},t);return this.timers.push(s),this.timers.length>50&&this.timers.shift(),s}clearTimers(){for(let e=this.timers.length-1;e>=0;e--)Timer.clearTimeout(this.timers[e]);this.timers.length=0}startRender(e,t){this.loops.push(e),Render.start(e,t)}stopRender(e){this.loops.remove(e),Render.stop(e)}clearRenders(){for(let e=this.loops.length-1;e>=0;e--)this.stopRender(this.loops[e]);this.loops.length=0}destroy(){if(!this.classes)return;this.removed=!0;const e=this.parent;e&&!e.removed&&e.remove&&e.remove(this);for(let e=this.classes.length-1;e>=0;e--){const t=this.classes[e];t&&t.destroy&&t.destroy()}return this.classes.length=0,this.element.object=null,this.clearRenders(),this.clearTimers(),this.events.destroy(),Utils.nullObject(this)}remove(e){e.element?e.element.parentNode.removeChild(e.element):e.nodeName&&e.parentNode.removeChild(e),this.classes.remove(e)}create(e,t){const i=new Interface(e,t);return this.add(i),i}clone(){return new Interface(this.element.cloneNode(!0))}empty(){return this.element.innerHTML="",this}text(e){return void 0===e?this.element.textContent:(this.element.textContent=e,this)}html(e){return void 0===e?this.element.innerHTML:(this.element.innerHTML=e,this)}hide(){return this.element.style.display="none",this}show(){return this.element.style.display="",this}visible(){return this.element.style.visibility="visible",this}invisible(){return this.element.style.visibility="hidden",this}setZ(e){return this.element.style.zIndex=e,this}clearOpacity(){return this.element.style.opacity="",this}size(e,t=e,i){return"boolean"==typeof t&&(i=t,t=e),void 0!==e&&("string"==typeof e||"string"==typeof t?("string"!=typeof e&&(e+="px"),"string"!=typeof t&&(t+="px"),this.element.style.width=e,this.element.style.height=t):(this.element.style.width=e+"px",this.element.style.height=t+"px",i||(this.element.style.backgroundSize=e+"px "+t+"px"))),this.width=this.element.offsetWidth,this.height=this.element.offsetHeight,this}mouseEnabled(e){return this.element.style.pointerEvents=e?"auto":"none",this}fontStyle(e,t,i,s){return this.css({fontFamily:e,fontSize:t,color:i,fontStyle:s}),this}bg(e,t,i,s){return~e.indexOf(".")&&(e=Assets.getPath(e)),e.includes(["data:","."])?this.element.style.backgroundImage="url("+e+")":this.element.style.backgroundColor=e,void 0!==t&&(t="number"==typeof t?t+"px":t,i="number"==typeof i?i+"px":i,this.element.style.backgroundPosition=t+" "+i),s&&(this.element.style.backgroundSize="",this.element.style.backgroundRepeat=s),"cover"!==t&&"contain"!==t||(s="number"==typeof s?s+"px":s,this.element.style.backgroundSize=t,this.element.style.backgroundRepeat="no-repeat",this.element.style.backgroundPosition=void 0!==i?i+" "+s:"center"),this}center(e,t,i){const s={};return void 0===e?(s.left="50%",s.top="50%",s.marginLeft=-this.width/2,s.marginTop=-this.height/2):(e&&(s.left="50%",s.marginLeft=-this.width/2),t&&(s.top="50%",s.marginTop=-this.height/2)),i&&(delete s.left,delete s.top),this.css(s),this}mask(e){return this.element.style.mask=(~e.indexOf(".")?"url("+e+")":e)+" no-repeat",this.element.style.maskSize="contain",this}blendMode(e,t){return this.element.style[t?"background-blend-mode":"mix-blend-mode"]=e,this}css(e,t){if("object"!=typeof e){if(void 0===t){let t=this.element.style[e];return"number"!=typeof t&&(~t.indexOf("px")&&(t=Number(t.slice(0,-2))),"opacity"===e&&(t=isNaN(Number(this.element.style.opacity))?1:Number(this.element.style.opacity))),t||0}return this.element.style[e]=t,this}for(let t in e){let i=e[t];"string"!=typeof i&&"number"!=typeof i||("string"!=typeof i&&"opacity"!==t&&"zIndex"!==t&&(i+="px"),this.element.style[t]=i)}return this}transform(e){if(e)for(let t in e)"number"==typeof e[t]&&(this[t]=e[t]);else e=this;return this.element.style.transform=TweenManager.parseTransform(e),this}willChange(e){const t="string"==typeof e;this.element.style.willChange=e?t?e:"transform, opacity":""}backfaceVisibility(e){return this.element.style.backfaceVisibility=e?"visible":"hidden",this}enable3D(e,t,i){return this.element.style.transformStyle="preserve-3d",e&&(this.element.style.perspective=e+"px"),void 0!==t&&(t="number"==typeof t?t+"px":t,i="number"==typeof i?i+"px":i,this.element.style.perspectiveOrigin=t+" "+i),this}disable3D(){return this.element.style.transformStyle="",this.element.style.perspective="",this}transformPoint(e,t,i){let s="";return void 0!==e&&(s+="number"==typeof e?e+"px":e),void 0!==t&&(s+="number"==typeof t?" "+t+"px":" "+t),void 0!==i&&(s+="number"==typeof i?" "+i+"px":" "+i),this.element.style.transformOrigin=s,this}tween(e,t,i,s,n){"number"!=typeof s&&(n=s,s=0);let a=null;"undefined"!=typeof Promise&&(a=Promise.create(),n&&a.then(n),n=a.resolve);const o=new CSSTransition(this,e,t,i,s,n);return a||o}clearTransform(){return"number"==typeof this.x&&(this.x=0),"number"==typeof this.y&&(this.y=0),"number"==typeof this.z&&(this.z=0),"number"==typeof this.scale&&(this.scale=1),"number"==typeof this.scaleX&&(this.scaleX=1),"number"==typeof this.scaleY&&(this.scaleY=1),"number"==typeof this.rotation&&(this.rotation=0),"number"==typeof this.rotationX&&(this.rotationX=0),"number"==typeof this.rotationY&&(this.rotationY=0),"number"==typeof this.rotationZ&&(this.rotationZ=0),"number"==typeof this.skewX&&(this.skewX=0),"number"==typeof this.skewY&&(this.skewY=0),this.element.style.transform="",this}clearTween(){return this.cssTween&&this.cssTween.stop(),this.mathTween&&this.mathTween.stop(),this}attr(e,t){if("object"!=typeof e)return void 0===t?this.element.getAttribute(e):(""===t?this.element.removeAttribute(e):this.element.setAttribute(e,t),this);for(let t in e){const i=e[t];"string"!=typeof i&&"number"!=typeof i||this.element.setAttribute(t,i)}return this}convertTouchEvent(e){const t={x:0,y:0};return e?(e.touches||e.changedTouches?e.touches.length?(t.x=e.touches[0].pageX,t.y=e.touches[0].pageY):(t.x=e.changedTouches[0].pageX,t.y=e.changedTouches[0].pageY):(t.x=e.pageX,t.y=e.pageY),t):t}click(e){return this.element.addEventListener("click",t=>{if(!this.element)return!1;t.object="hit"===this.element.className?this.parent:this,t.action="click",e&&e(t)},!0),this.element.style.cursor="pointer",this}hover(e){const t=t=>{if(!this.element)return!1;t.object="hit"===this.element.className?this.parent:this,t.action="mouseout"===t.type?"out":"over",e&&e(t)};return this.element.addEventListener("mouseover",t,!0),this.element.addEventListener("mouseout",t,!0),this}bind(e,t){"touchstart"!==e||Device.mobile?"touchmove"!==e||Device.mobile?"touchend"!==e||Device.mobile||(e="mouseup"):e="mousemove":e="mousedown",this.events["bind_"+e]||(this.events["bind_"+e]=[]);const i=this.events["bind_"+e];i.push({target:this.element,callback:t});const s=e=>{const t=this.convertTouchEvent(e);e instanceof MouseEvent||(e.x=t.x,e.y=t.y),i.forEach(t=>{t.target===e.currentTarget&&t.callback(e)})};return this.events["fn_"+e]||(this.events["fn_"+e]=s,this.element.addEventListener(e,s,!0)),this}unbind(e,t){"touchstart"!==e||Device.mobile?"touchmove"!==e||Device.mobile?"touchend"!==e||Device.mobile||(e="mouseup"):e="mousemove":e="mousedown";const i=this.events["bind_"+e];return i?(i.forEach((e,s)=>{e.callback===t&&i.splice(s,1)}),this.events["fn_"+e]&&!i.length&&(this.element.removeEventListener(e,this.events["fn_"+e],!0),this.events["fn_"+e]=null),this):this}interact(e,t){return this.hit=this.create(".hit"),this.hit.css({position:"absolute",left:0,top:0,width:"100%",height:"100%",zIndex:99999}),Device.mobile?this.hit.touchClick(e,t):this.hit.hover(e).click(t),this}touchClick(e,t){const i={};let s,n,a;const o=e=>{const t=this.convertTouchEvent(e);e.touchX=t.x,e.touchY=t.y,i.x=e.touchX,i.y=e.touchY};return this.element.addEventListener("touchmove",e=>{if(!this.element)return!1;a=this.convertTouchEvent(e),n=((e,t)=>{const i=t.x-e.x,s=t.y-e.y;return Math.sqrt(i*i+s*s)})(i,a)>5},{passive:!0}),this.element.addEventListener("touchstart",t=>{if(!this.element)return!1;s=performance.now(),t.object="hit"===this.element.className?this.parent:this,t.action="over",o(t),e&&!n&&e(t)},{passive:!0}),this.element.addEventListener("touchend",i=>{if(!this.element)return!1;const a=performance.now();i.object="hit"===this.element.className?this.parent:this,o(i),s&&a-s<750&&t&&!n&&(i.action="click",t(i)),e&&(i.action="out",e(i)),n=!1},{passive:!0}),this}touchSwipe(e,t=75){const i={};let s,n,a=!1;const o=e=>{const t=this.convertTouchEvent(e);1===e.touches.length&&(s=t.x,n=t.y,a=!0,this.element.addEventListener("touchmove",r,{passive:!0}))},r=o=>{if(a){const a=this.convertTouchEvent(o),r=s-a.x,c=n-a.y;i.direction=null,i.moving=null,i.x=null,i.y=null,i.evt=o,Math.abs(r)>=t?(l(),i.direction=r>0?"left":"right"):Math.abs(c)>=t?(l(),i.direction=c>0?"up":"down"):(i.moving=!0,i.x=r,i.y=c),e&&e(i,o)}},l=()=>{s=n=a=!1,this.element.removeEventListener("touchmove",r)};return Device.mobile&&(this.element.addEventListener("touchstart",o,{passive:!0}),this.element.addEventListener("touchend",l,{passive:!0}),this.element.addEventListener("touchcancel",l,{passive:!0})),this}overflowScroll(e){const t=!!e.x,i=!!e.y,s={};(!t&&!i||t&&i)&&(s.overflow="scroll"),!t&&i&&(s.overflowY="scroll",s.overflowX="hidden"),t&&!i&&(s.overflowX="scroll",s.overflowY="hidden"),Device.mobile&&(s["-webkit-overflow-scrolling"]="touch",this.element.scrollParent=!0,this.element.preventEvent=(e=>e.stopPropagation()),this.bind("touchmove",this.element.preventEvent)),this.css(s)}removeOverflowScroll(){this.css({overflow:"hidden",overflowX:"",overflowY:"","-webkit-overflow-scrolling":""}),Device.mobile&&this.unbind("touchmove",this.element.preventEvent)}split(e=""){const t={position:"relative",display:"inline-block",width:"auto",height:"auto",margin:0,padding:0},i=[],s=this.text().split(e);this.empty()," "===e&&(e="&nbsp;");for(let n=0;n<s.length;n++)" "===s[n]&&(s[n]="&nbsp;"),i.push(this.create(".t","span").html(s[n]).css(t)),""!==e&&n<s.length-1&&i.push(this.create(".t","span").html(e).css(t));return i}}const Stage=new class extends Interface{constructor(){super("Stage");const e=this;let t;function i(){"focus"!==t&&(t="focus",Events.emitter.fire(Events.VISIBILITY,{type:"focus"}))}function s(){"blur"!==t&&(t="blur",Events.emitter.fire(Events.VISIBILITY,{type:"blur"}))}function n(e){Events.emitter.fire(Events.KEYBOARD_DOWN,e)}function a(e){Events.emitter.fire(Events.KEYBOARD_UP,e)}function o(e){Events.emitter.fire(Events.KEYBOARD_PRESS,e)}function r(t){e.size(),e.orientation=window.innerWidth>window.innerHeight?"landscape":"portrait",Events.emitter.fire(Events.RESIZE,t)}function l(e){let t=e.target;if("INPUT"===t.nodeName||"TEXTAREA"===t.nodeName||"SELECT"===t.nodeName||"A"===t.nodeName)return;let i=!0;for(;t.parentNode&&i;)t.scrollParent&&(i=!1),t=t.parentNode;i&&e.preventDefault()}e.css({overflow:"hidden"}),function(){window.addEventListener("focus",i),window.addEventListener("blur",s),window.addEventListener("keydown",n),window.addEventListener("keyup",a),window.addEventListener("keypress",o),window.addEventListener("resize",r),window.addEventListener("orientationchange",r),Device.mobile&&window.addEventListener("touchstart",l,{passive:!1});r()}(),this.allowScroll=(()=>{Device.mobile&&window.removeEventListener("touchstart",l,{passive:!1})}),this.destroy=(()=>(this.Accelerometer&&this.Accelerometer.active&&this.Accelerometer.stop(),this.Mouse&&this.Mouse.active&&this.Mouse.stop(),this.WebAudio&&this.WebAudio.active&&this.WebAudio.stop(),window.removeEventListener("focus",i),window.removeEventListener("blur",s),window.removeEventListener("keydown",n),window.removeEventListener("keyup",a),window.removeEventListener("keypress",o),window.removeEventListener("resize",r),window.removeEventListener("orientationchange",r),Device.mobile&&window.removeEventListener("touchstart",l,{passive:!1}),super.destroy()))}};class Vector2{constructor(e,t){this.x="number"==typeof e?e:0,this.y="number"==typeof t?t:0,this.type="vector2"}set(e,t){return this.x=e||0,this.y=t||0,this}clear(){return this.x=0,this.y=0,this}copyTo(e){return e.x=this.x,e.y=this.y,this}copy(e){return this.x=e.x||0,this.y=e.y||0,this}lengthSq(){return this.x*this.x+this.y*this.y||1e-5}length(){return Math.sqrt(this.lengthSq())}normalize(){const e=this.length();return this.x/=e,this.y/=e,this}setLength(e){return this.normalize().multiplyScalar(e),this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}multiplyVectors(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.x/=e,this.y/=e,this}perpendicular(){const e=this.x,t=this.y;return this.x=-t,this.y=e,this}lerp(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}deltaLerp(e,t,i=1){for(let s=0;s<i;s++)this.lerp(e,t);return this}interp(e,t,i,s=5e3){this.calc||(this.calc=new Vector2),this.calc.subVectors(this,e);const n=Interpolation.convertEase(i)(Math.clamp(Math.range(this.calc.lengthSq(),0,s*s,1,0),0,1)*(t/10));return this.lerp(e,n)}setAngleRadius(e,t){return this.x=Math.cos(e)*t,this.y=Math.sin(e)*t,this}addAngleRadius(e,t){return this.x+=Math.cos(e)*t,this.y+=Math.sin(e)*t,this}dot(e,t=this){return e.x*t.x+e.y*t.y}clone(){return new Vector2(this.x,this.y)}distanceTo(e,t){const i=this.x-e.x,s=this.y-e.y;return t?i*i+s*s:Math.sqrt(i*i+s*s)}solveAngle(e,t=this){return Math.atan2(e.y-t.y,e.x-t.x)}equals(e){return this.x===e.x&&this.y===e.y}toString(e=" "){return this.x+e+this.y}}class Interaction extends Component{constructor(e=Stage){if(!Interaction.initialized){Interaction.CLICK="interaction_click",Interaction.START="interaction_start",Interaction.MOVE="interaction_move",Interaction.DRAG="interaction_drag",Interaction.END="interaction_end";const e={touchstart:[],touchmove:[],touchend:[]},t=t=>e.touchstart.forEach(e=>e(t)),i=t=>e.touchmove.forEach(e=>e(t)),s=t=>e.touchend.forEach(e=>e(t));Interaction.bind=((t,i)=>e[t].push(i)),Interaction.unbind=((t,i)=>e[t].remove(i)),Stage.bind("touchstart",t),Stage.bind("touchmove",i),Stage.bind("touchend",s),Stage.bind("touchcancel",s),Interaction.initialized=!0}super();const t=this;let i,s,n;function a(e){t.isTouching=!0,t.x=e.x,t.y=e.y,t.hold.x=t.last.x=e.x,t.hold.y=t.last.y=e.y,t.delta.x=t.move.x=t.velocity.x=0,t.delta.y=t.move.y=t.velocity.y=0,i=0,t.events.fire(Interaction.START,e,!0),s=n=Render.TIME}function o(e){t.isTouching&&(t.move.x=e.x-t.hold.x,t.move.y=e.y-t.hold.y),t.x=e.x,t.y=e.y,t.delta.x=e.x-t.last.x,t.delta.y=e.y-t.last.y,t.last.x=e.x,t.last.y=e.y,i+=t.delta.length();const s=Math.max(.001,Render.TIME-(n||Render.TIME));n=Render.TIME,t.velocity.x=Math.abs(t.delta.x)/s,t.velocity.y=Math.abs(t.delta.y)/s,t.events.fire(Interaction.MOVE,e,!0),t.isTouching&&t.events.fire(Interaction.DRAG,e,!0)}function r(e){if(!t.isTouching)return;t.isTouching=!1,t.move.x=0,t.move.y=0,Math.max(.001,Render.TIME-(n||Render.TIME))>100&&(t.delta.x=0,t.delta.y=0),t.events.fire(Interaction.END,e,!0),i<20&&Render.TIME-s<2e3&&t.events.fire(Interaction.CLICK,e,!0)}this.x=0,this.y=0,this.hold=new Vector2,this.last=new Vector2,this.delta=new Vector2,this.move=new Vector2,this.velocity=new Vector2,function(){e===Stage?Interaction.bind("touchstart",a):e.bind("touchstart",a);Interaction.bind("touchmove",o),Interaction.bind("touchend",r)}(),this.destroy=(()=>(Interaction.unbind("touchstart",a),Interaction.unbind("touchmove",o),Interaction.unbind("touchend",r),e!==Stage&&e.unbind&&e.unbind("touchstart",a),super.destroy()))}}class Accelerometer{static init(){if(!this.active){this.active=!0,this.x=0,this.y=0,this.z=0,this.alpha=0,this.beta=0,this.gamma=0,this.heading=0,this.rotationRate={},this.rotationRate.alpha=0,this.rotationRate.beta=0,this.rotationRate.gamma=0,this.toRadians="ios"===Device.os?Math.PI/180:1;const e=e=>{switch(window.orientation){case 0:this.x=-e.accelerationIncludingGravity.x,this.y=e.accelerationIncludingGravity.y,this.z=e.accelerationIncludingGravity.z,e.rotationRate&&(this.rotationRate.alpha=e.rotationRate.beta*this.toRadians,this.rotationRate.beta=-e.rotationRate.alpha*this.toRadians,this.rotationRate.gamma=e.rotationRate.gamma*this.toRadians);break;case 180:this.x=e.accelerationIncludingGravity.x,this.y=-e.accelerationIncludingGravity.y,this.z=e.accelerationIncludingGravity.z,e.rotationRate&&(this.rotationRate.alpha=-e.rotationRate.beta*this.toRadians,this.rotationRate.beta=e.rotationRate.alpha*this.toRadians,this.rotationRate.gamma=e.rotationRate.gamma*this.toRadians);break;case 90:this.x=e.accelerationIncludingGravity.y,this.y=e.accelerationIncludingGravity.x,this.z=e.accelerationIncludingGravity.z,e.rotationRate&&(this.rotationRate.alpha=e.rotationRate.alpha*this.toRadians,this.rotationRate.beta=e.rotationRate.beta*this.toRadians,this.rotationRate.gamma=e.rotationRate.gamma*this.toRadians);break;case-90:this.x=-e.accelerationIncludingGravity.y,this.y=-e.accelerationIncludingGravity.x,this.z=e.accelerationIncludingGravity.z,e.rotationRate&&(this.rotationRate.alpha=-e.rotationRate.alpha*this.toRadians,this.rotationRate.beta=-e.rotationRate.beta*this.toRadians,this.rotationRate.gamma=e.rotationRate.gamma*this.toRadians)}},t=e=>{for(let t in e)~t.toLowerCase().indexOf("heading")&&(this.heading=e[t]);switch(window.orientation){case 0:this.alpha=e.beta*this.toRadians,this.beta=-e.alpha*this.toRadians,this.gamma=e.gamma*this.toRadians;break;case 180:this.alpha=-e.beta*this.toRadians,this.beta=e.alpha*this.toRadians,this.gamma=e.gamma*this.toRadians;break;case 90:this.alpha=e.alpha*this.toRadians,this.beta=e.beta*this.toRadians,this.gamma=e.gamma*this.toRadians;break;case-90:this.alpha=-e.alpha*this.toRadians,this.beta=-e.beta*this.toRadians,this.gamma=e.gamma*this.toRadians}this.tilt=e.beta*this.toRadians,this.yaw=e.alpha*this.toRadians,this.roll=-e.gamma*this.toRadians,"Android"===Device.os&&(this.heading=i(e.alpha,e.beta,e.gamma))},i=(e,t,i)=>{const s=Math.PI/180,n=t?t*s:0,a=i?i*s:0,o=e?e*s:0,r=Math.cos(a),l=Math.cos(o),c=Math.sin(n),h=Math.sin(a),u=Math.sin(o),d=-l*h-u*c*r,p=-u*h+l*c*r;let m=Math.atan(d/p);return p<0?m+=Math.PI:d<0&&(m+=2*Math.PI),m*(180/Math.PI)};window.addEventListener("devicemotion",e),window.addEventListener("deviceorientation",t),this.stop=(()=>{this.active=!1,window.removeEventListener("devicemotion",e),window.removeEventListener("deviceorientation",t)})}Stage.Accelerometer=this}}class Mouse{static init(){if(!this.active){this.active=!0,this.x=0,this.y=0,this.normal={x:0,y:0},this.tilt={x:0,y:0},this.inverseNormal={x:0,y:0};const e=e=>{this.x=e.x,this.y=e.y,this.normal.x=e.x/Stage.width,this.normal.y=e.y/Stage.height,this.tilt.x=2*this.normal.x-1,this.tilt.y=1-2*this.normal.y,this.inverseNormal.x=this.normal.x,this.inverseNormal.y=1-this.normal.y};this.input=Stage.initClass(Interaction),Stage.events.add(this.input,Interaction.START,e),Stage.events.add(this.input,Interaction.MOVE,e),e({x:Stage.width/2,y:Stage.height/2}),this.stop=(()=>{this.active=!1,Stage.events.remove(this.input,Interaction.START,e),Stage.events.remove(this.input,Interaction.MOVE,e)})}Stage.Mouse=this}}class AssetLoader extends Component{constructor(e,t){Array.isArray(e)&&(e=e.map(e=>Utils.basename(e)).reduce((t,i,s)=>(t[i]=e[s],t),{})),super();const i=this;let s=Object.keys(e).length,n=0;for(let t in e)a(t,e[t]);function a(e,t){const i=Utils.extension(t);if(!i.includes(["jpg","jpeg","png","gif","svg"]))return i.includes(["mp3","m4a","ogg","wav","aif"])?window.AudioContext&&Stage.WebAudio?void Stage.WebAudio.createSound(e,t,o):o():void window.get(Assets.getPath(t),Assets.OPTIONS).then(t=>{"json"===i&&Assets.storeData(e,t),"js"===i&&window.eval(t.replace("use strict","")),o()}).catch(()=>{o()});Assets.createImage(t,o)}function o(){i.percent=++n/s,i.events.fire(Events.PROGRESS,{percent:i.percent},!0),n===s&&(i.events.fire(Events.COMPLETE,null,!0),t&&t())}this.add=((e=1)=>{s+=e}),this.trigger=((e=1)=>{for(let t=0;t<e;t++)o()})}static loadAssets(e,t){const i=Promise.create();return t||(t=i.resolve),i.loader=new AssetLoader(e,t),i}}class FontLoader extends Component{constructor(e,t){e=e.map(e=>"object"!=typeof e?{style:"normal",variant:"normal",weight:"normal",family:e.replace(/"/g,"'")}:e),super();const i=this;let s,n=0;function a(e){s.font=e,s.fillText("LOAD",0,0)}function o(){i.percent=++n/e.length,i.events.fire(Events.PROGRESS,{percent:i.percent},!0),n===e.length&&(i.events.fire(Events.COMPLETE,null,!0),t&&t())}s=document.createElement("canvas").getContext("2d"),e.forEach(e=>{e.specifier=(({style:e="normal",variant:t="normal",weight:i="normal",family:s})=>`${e} ${t} ${i} 12px "${s}"`)(e)}),document.fonts?e.forEach(e=>{document.fonts.load(e.specifier).then(()=>{a(e.specifier),o()}).catch(()=>{o()})}):(e.forEach(e=>a(e.specifier)),i.delayedCall(()=>{i.percent=1,i.events.fire(Events.PROGRESS,{percent:i.percent},!0),i.events.fire(Events.COMPLETE,null,!0),t&&t()},500))}static loadFonts(e,t){const i=Promise.create();return t||(t=i.resolve),i.loader=new FontLoader(e,t),i}}class StateDispatcher extends Component{constructor(e){super();const t=this;let i,s,n="/";function a(){l(null,r())}function o(e){l(e.state,r())}function r(){return e?location.hash.slice(3):("/"!==n?location.pathname.split(n)[1]:location.pathname.slice(1))||""}function l(a,o){if(o!==i)if(t.locked){if(!i)return;e?location.hash="!/"+i:history.pushState(s,null,n+i)}else i=o,s=a,t.events.fire(Events.UPDATE,{value:a,path:o},!0)}this.locked=!1,e?window.addEventListener("hashchange",a):window.addEventListener("popstate",o),i=r(),this.getState=(()=>{const e=r();return{value:s,path:e}}),this.setRoot=(e=>{n="/"===e.charAt(0)?e:"/"+e}),this.setState=((t,a)=>{"object"!=typeof t&&(a=t,t=null),a!==i&&(i=a,s=t,e?location.hash="!/"+a:history.pushState(t,null,n+a))}),this.replaceState=((t,a)=>{"object"!=typeof t&&(a=t,t=null),a!==i&&(i=a,s=t,e?location.hash="!/"+a:history.replaceState(t,null,n+a))}),this.setTitle=(e=>document.title=e),this.lock=(()=>this.locked=!0),this.unlock=(()=>this.locked=!1),this.useHash=(()=>e=!0),this.destroy=(()=>(window.removeEventListener("hashchange",a),window.removeEventListener("popstate",o),super.destroy()))}}class Storage{static set(e,t){return null!==t&&"object"==typeof t&&(t=JSON.stringify(t)),null===t?window.localStorage.removeItem(e):window.localStorage[e]=t,t}static get(e){let t=window.localStorage[e];if(t){let e;t.charAt&&(e=t.charAt(0)),"{"!==e&&"["!==e||(t=JSON.parse(t)),"true"!==t&&"false"!==t||(t="true"===t)}return t}}window.AudioContext||(window.AudioContext=window.webkitAudioContext||window.mozAudioContext||window.oAudioContext);class WebAudio{static init(){if(!this.active){this.active=!0;const e=this,t={};let i;window.AudioContext&&(i=new AudioContext,this.output=i.createGain(),this.volume=1,this.output.connect(i.destination),this.gain={set value(t){e.volume=t,e.output.gain.linearRampToValueAtTime(t,i.currentTime+.015)},get value(){return e.volume}},this.context=i),this.loadSound=((e,t)=>{const s=Promise.create();t&&s.then(t),t=s.resolve;const n=this.getSound(e);window.fetch(n.path,Assets.OPTIONS).then(e=>{if(!e.ok)return t();e.arrayBuffer().then(e=>{i.decodeAudioData(e,e=>{n.buffer=e,n.complete=!0,t()},()=>{t()})})}).catch(()=>{t()}),n.ready=(()=>s)}),this.createSound=((e,i,s)=>(t[e]=new class{constructor(e){const t=this;this.path=Assets.getPath(e),WebAudio.context.createStereoPanner&&(this.stereo=WebAudio.context.createStereoPanner()),this.output=WebAudio.context.createGain(),this.volume=1,this.rate=1,this.stereo&&this.stereo.connect(this.output),this.output.connect(WebAudio.output),this.output.gain.setValueAtTime(0,WebAudio.context.currentTime),this.gain={set value(e){t.volume=e,t.output.gain.linearRampToValueAtTime(e,WebAudio.context.currentTime+.015)},get value(){return t.volume}},this.playbackRate={set value(e){t.rate=e,t.source&&t.source.playbackRate.linearRampToValueAtTime(e,WebAudio.context.currentTime+.015)},get value(){return t.rate}},this.stereoPan={set value(e){t.pan=e,t.stereo&&t.stereo.pan.linearRampToValueAtTime(e,WebAudio.context.currentTime+.015)},get value(){return t.pan}},this.stop=(()=>{this.source&&(this.source.stop(),this.playing=!1)})}}(i),"ios"===Device.os&&s?s():this.loadSound(e,s),t[e])),this.getSound=(e=>t[e]),this.trigger=(e=>{if(!i)return;"suspended"===i.state&&i.resume();const t=this.getSound(e);t.ready||this.loadSound(e),t.ready().then(()=>{if(t.complete){if(t.stopping&&t.loop)return void(t.stopping=!1);t.playing=!0,t.source=i.createBufferSource(),t.source.buffer=t.buffer,t.source.loop=t.loop,t.source.playbackRate.setValueAtTime(t.rate,i.currentTime),t.source.connect(t.stereo?t.stereo:t.output),t.source.start(),t.output.gain.linearRampToValueAtTime(t.volume,i.currentTime+.015)}})}),this.play=((e,t=1,s)=>{if(!i)return;"boolean"==typeof t&&(s=t,t=1);const n=this.getSound(e);n&&(n.volume=t,n.loop=!!s,this.trigger(e))}),this.fadeInAndPlay=((e,t,s,n,a,o=0)=>{if(!i)return;const r=this.getSound(e);r&&(r.volume=0,r.loop=!!s,this.trigger(e),TweenManager.tween(r.gain,{value:t},n,a,o))}),this.fadeOutAndStop=((e,t,s,n=0)=>{if(!i)return;const a=this.getSound(e);a&&a.playing&&(TweenManager.tween(a.gain,{value:0},t,s,n,()=>{a.stopping&&(a.stopping=!1,a.stop())}),a.stopping=!0)}),this.remove=(e=>{const i=this.getSound(e);i&&i.source&&(i.source.buffer=null,i.source.stop(),i.source.disconnect(),i.source=null,i.playing=!1,delete t[e])}),this.mute=(()=>{i&&TweenManager.tween(this.gain,{value:0},300,"easeOutSine")}),this.unmute=(()=>{i&&TweenManager.tween(this.gain,{value:1},500,"easeOutSine")}),this.stop=(()=>{if(this.active=!1,i){for(let e in t){const i=t[e];i&&i.stop()}i.close()}})}Stage.WebAudio=this}}class CanvasValues{constructor(e){this.styles={},e?this.styled=!1:this.data=new Float32Array(6)}setTRSA(e,t,i,s,n,a){const o=this.data;o[0]=e,o[1]=t,o[2]=i,o[3]=s,o[4]=n,o[5]=a}calculate(e){const t=e.data,i=this.data;i[0]=i[0]+t[0],i[1]=i[1]+t[1],i[2]=i[2]+t[2],i[3]=i[3]*t[3],i[4]=i[4]*t[4],i[5]=i[5]*t[5]}calculateStyle(e){if(!e.styled)return!1;this.styled=!0;const t=e.values;for(let e in t)this.styles[e]||(this.styles[e]=t[e])}set shadowOffsetX(e){this.styled=!0,this.styles.shadowOffsetX=e}get shadowOffsetX(){return this.styles.shadowOffsetX}set shadowOffsetY(e){this.styled=!0,this.styles.shadowOffsetY=e}get shadowOffsetY(){return this.styles.shadowOffsetY}set shadowBlur(e){this.styled=!0,this.styles.shadowBlur=e}get shadowBlur(){return this.styles.shadowBlur}set shadowColor(e){this.styled=!0,this.styles.shadowColor=e}get shadowColor(){return this.styles.shadowColor}get values(){return this.styles}}class CanvasObject{constructor(){this.visible=!0,this.blendMode="source-over",this.x=0,this.y=0,this.px=0,this.py=0,this.clipX=0,this.clipY=0,this.clipWidth=0,this.clipHeight=0,this.width=0,this.height=0,this.rotation=0,this.scale=1,this.opacity=1,this.values=new CanvasValues,this.styles=new CanvasValues(!0),this.children=[]}updateValues(){this.values.setTRSA(this.x,this.y,Math.radians(this.rotation),this.scaleX||this.scale,this.scaleY||this.scale,this.opacity),this.parent.values&&this.values.calculate(this.parent.values),this.parent.styles&&this.styles.calculateStyle(this.parent.styles)}render(e){if(!this.visible)return!1;this.updateValues(),this.draw&&this.draw(e);for(let t=0;t<this.children.length;t++)this.children[t].render(e)}startDraw(e=0,t=0,i){const s=this.canvas.context,n=this.values.data,a=n[0]+e,o=n[1]+t;if(s.save(),i||(s.globalCompositeOperation=this.blendMode),s.translate(a,o),s.rotate(n[2]),s.scale(n[3],n[4]),s.globalAlpha=n[5],this.styles.styled){const e=this.styles.values;for(let t in e)s[t]=e[t]}}endDraw(){this.canvas.context.restore()}add(e){e.setCanvas(this.canvas),e.parent=this,this.children.push(e),e.z=this.children.length}setCanvas(e){this.canvas=e;for(let t=0;t<this.children.length;t++)this.children[t].setCanvas(e)}remove(e){e.canvas=null,e.parent=null,this.children.remove(e)}isMask(){let e=this;for(;e;){if(e.masked)return!0;e=e.parent}return!1}unmask(){this.masked.mask(null),this.masked=null}setZ(e){this.z=e,this.parent.children.sort((e,t)=>e.z-t.z)}follow(e){return this.x=e.x,this.y=e.y,this.px=e.px,this.py=e.py,this.clipX=e.clipX,this.clipY=e.clipY,this.clipWidth=e.clipWidth,this.clipHeight=e.clipHeight,this.width=e.width,this.height=e.height,this.rotation=e.rotation,this.scale=e.scale,this.scaleX=e.scaleX||e.scale,this.scaleY=e.scaleY||e.scale,this}visible(){return this.visible=!0,this}invisible(){return this.visible=!1,this}transform(e){for(let t in e)"number"==typeof e[t]&&(this[t]=e[t]);return this}transformPoint(e,t){return this.px="number"==typeof e?e:this.width*(parseFloat(e)/100),this.py="number"==typeof t?t:this.height*(parseFloat(t)/100),this}clip(e,t,i,s){return this.clipX=e,this.clipY=t,this.clipWidth=i,this.clipHeight=s,this}destroy(){if(this.children)for(let e=this.children.length-1;e>=0;e--)this.children[e].destroy();return Utils.nullObject(this)}}class CanvasGraphics extends CanvasObject{constructor(e=0,t=e){super();const i=this;let s,n=[];this.width=e,this.height=t,this.props={},this.draw=(e=>{if(this.isMask()&&!e)return!1;const t=this.canvas.context;this.startDraw(this.px,this.py,e),function(e){for(let t in i.props)e[t]=i.props[t]}(t),this.clipWidth&&this.clipHeight&&(t.beginPath(),t.rect(this.clipX,this.clipY,this.clipWidth,this.clipHeight),t.clip());for(let e=0;e<n.length;e++){const i=n[e];if(!i)continue;const s=i.shift();t[s].apply(t,i),i.unshift(s)}this.endDraw(),s&&(t.globalCompositeOperation=s.blendMode,s.render(!0))}),this.clear=(()=>{for(let e=n.length-1;e>=0;e--)n[e].length=0;n.length=0}),this.arc=((e=0,t=0,i=this.radius||this.width/2,s=0,a=2*Math.PI,o=!1)=>{e&&!t&&(s=Math.radians(-90),a=e,e=0,t=0),n.push(["arc",e,t,i,s,a,o])}),this.quadraticCurveTo=((e,t,i,s)=>{n.push(["quadraticCurveTo",e,t,i,s])}),this.bezierCurveTo=((e,t,i,s,a,o)=>{n.push(["bezierCurveTo",e,t,i,s,a,o])}),this.fillRect=((e,t,i,s)=>{n.push(["fillRect",e,t,i,s])}),this.clearRect=((e,t,i,s)=>{n.push(["clearRect",e,t,i,s])}),this.strokeRect=((e,t,i,s)=>{n.push(["strokeRect",e,t,i,s])}),this.moveTo=((e,t)=>{n.push(["moveTo",e,t])}),this.lineTo=((e,t)=>{n.push(["lineTo",e,t])}),this.stroke=(()=>{n.push(["stroke"])}),this.fill=(()=>{s||n.push(["fill"])}),this.beginPath=(()=>{n.push(["beginPath"])}),this.closePath=(()=>{n.push(["closePath"])}),this.fillText=((e,t=0,i=0)=>{n.push(["fillText",e,t,i])}),this.strokeText=((e,t=0,i=0)=>{n.push(["strokeText",e,t,i])}),this.setLineDash=(e=>{n.push(["setLineDash",e])}),this.drawImage=((e,t=0,i=0,s=e.width,a=e.height,o=0,r=0,l=e.width,c=e.height)=>{n.push(["drawImage",e,t,i,s,a,o+-this.px,r+-this.py,l,c])}),this.mask=(e=>{if(!e)return s=null;s=e,e.masked=this;for(let e=0;e<n.length;e++)"fill"!==n[e][0]&&"stroke"!==n[e][0]||(n[e].length=0,n.splice(e,1))}),this.clone=(()=>{const e=new CanvasGraphics(this.width,this.height);return e.visible=this.visible,e.blendMode=this.blendMode,e.opacity=this.opacity,e.follow(this),e.props=Utils.cloneObject(this.props),e.setDraw(Utils.cloneArray(n)),e}),this.setDraw=(e=>{n=e})}set strokeStyle(e){this.props.strokeStyle=e}get strokeStyle(){return this.props.strokeStyle}set fillStyle(e){this.props.fillStyle=e}get fillStyle(){return this.props.fillStyle}set lineWidth(e){this.props.lineWidth=e}get lineWidth(){return this.props.lineWidth}set lineCap(e){this.props.lineCap=e}get lineCap(){return this.props.lineCap}set lineDashOffset(e){this.props.lineDashOffset=e}get lineDashOffset(){return this.props.lineDashOffset}set lineJoin(e){this.props.lineJoin=e}get lineJoin(){return this.props.lineJoin}set miterLimit(e){this.props.miterLimit=e}get miterLimit(){return this.props.miterLimit}set font(e){this.props.font=e}get font(){return this.props.font}set textAlign(e){this.props.textAlign=e}get textAlign(){return this.props.textAlign}set textBaseline(e){this.props.textBaseline=e}get textBaseline(){return this.props.textBaseline}}class Canvas{constructor(e,t=e,i,s){"boolean"==typeof t&&(i=t,t=e);const n=this;function a(e,t=e){const a=i?2:1;if(n.element.width=e*a,n.element.height=t*a,n.width=e,n.height=t,n.scale=a,n.object.size(n.width,n.height),n.context.scale(a,a),n.element.style.width=e+"px",n.element.style.height=t+"px",s){const e=new CanvasGraphics(n.width,n.height);e.fillStyle="rgba(255, 255, 255, 0.002)",e.fillRect(0,0,n.width,n.height),e.setCanvas(n),e.parent=n,n.children[0]=e,e.z=1}}this.element=document.createElement("canvas"),this.context=this.element.getContext("2d"),this.object=new Interface(this.element),this.children=[],this.retina=i,a(e,t),this.size=a,this.toDataURL=((e,t)=>this.element.toDataURL(e,t)),this.render=(e=>{"boolean"==typeof e&&e||this.clear();for(let e=0;e<this.children.length;e++)this.children[e].render()}),this.clear=(()=>{this.context.clearRect(0,0,this.element.width,this.element.height)}),this.add=(e=>{e.setCanvas(this),e.parent=this,this.children.push(e),e.z=this.children.length}),this.remove=(e=>{e.canvas=null,e.parent=null,this.children.remove(e)}),this.destroy=(()=>{if(this.children)for(let e=this.children.length-1;e>=0;e--)this.children[e].destroy();return this.object.destroy(),Utils.nullObject(this)}),this.getImageData=((e=0,t=0,i=this.element.width,s=this.element.height)=>(this.imageData=this.context.getImageData(e,t,i,s),this.imageData)),this.getPixel=((e,t,i)=>{this.imageData&&!i||this.getImageData();const s={},n=4*(e+t*this.element.width),a=this.imageData.data;return s.r=a[n],s.g=a[n+1],s.b=a[n+2],s.a=a[n+3],s}),this.putImageData=(e=>{this.context.putImageData(e,0,0)})}}navigator.getUserMedia||(navigator.getUserMedia=navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia);class Shader extends Component{constructor(e,t,i){super();const s=this;function n(e,t){let i;return(e=(i="vs"===t?["precision highp float;","precision highp int;","attribute vec2 uv;","attribute vec3 position;","attribute vec3 normal;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;"].join("\n"):[~e.indexOf("dFdx")?"#extension GL_OES_standard_derivatives : enable":"","precision highp float;","precision highp int;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 modelMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;"].join("\n"))+"\n\n"+e).replace(/#s?chunk\(\s?(\w+)\s?\);/g,(e,t)=>THREE.ShaderChunk[t]+"\n")}this.uniforms={},this.properties={},function(){for(let e in i)void 0!==i[e].value?s.uniforms[e]=i[e]:s.properties[e]=i[e]}(),function(){const i={};i.vertexShader=n(e,"vs"),i.fragmentShader=n(t,"fs"),i.uniforms=s.uniforms;for(let e in s.properties)i[e]=s.properties[e];s.material=new THREE.RawShaderMaterial(i),s.material.shader=s,s.uniforms=s.material.uniforms}(),this.destroy=(()=>(this.material.dispose(),super.destroy()))}}var vertFluidBasic="#define GLSLIFY 1\nvoid main() {\n    gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragFluidPass="#define GLSLIFY 1\n// Based on https://www.shadertoy.com/view/XlsBDf by davidar\n\nuniform float time;\nuniform int frame;\nuniform vec2 resolution;\nuniform vec2 mouse;\nuniform vec2 last;\nuniform vec2 velocity;\nuniform vec2 strength;\nuniform sampler2D texture;\n\n#define MAX_ITERATIONS 5.0\n\n#define T(p) texture2D(texture, (p) / resolution.xy)\n#define length2(p) dot(p, p)\n\n#define dt 0.15\n#define K 0.2\n#define nu 0.5\n#define kappa 0.1\n\nvoid main() {\n    if (frame < 10) {\n        gl_FragColor = vec4(0, 0, 1, 0);\n        return;\n    }\n\n    vec2 p = gl_FragCoord.xy;\n    vec4 c = T(p);\n\n    vec4 n = T(p + vec2(0, 1));\n    vec4 e = T(p + vec2(1, 0));\n    vec4 s = T(p - vec2(0, 1));\n    vec4 w = T(p - vec2(1, 0));\n\n    vec4 laplacian = (n + e + s + w - 4.0 * c);\n\n    vec4 dx = (e - w) / 2.0;\n    vec4 dy = (n - s) / 2.0;\n\n    // velocity field divergence\n    float div = dx.x + dy.y;\n\n    // mass conservation, Euler method step\n    c.z -= dt * (dx.z * c.x + dy.z * c.y + div * c.z);\n\n    // semi-Langrangian advection\n    c.xyw = T(p - dt * c.xy).xyw;\n\n    // viscosity/diffusion\n    c.xyw += dt * vec3(nu, nu, kappa) * laplacian.xyw;\n\n    // nullify divergence with pressure field gradient\n    c.xy -= K * vec2(dx.z, dy.z);\n\n    // external source\n    vec2 pos = last.xy;\n    float iterations = clamp((length(velocity) / 40.0) * MAX_ITERATIONS, 1.0, MAX_ITERATIONS);\n    for (float i = 0.0; i < MAX_ITERATIONS; i += 1.0) {\n        if (i >= iterations) break;\n        pos += (mouse.xy - pos.xy) * ((i + 1.0) / iterations);\n        vec2 m = pos.xy * resolution.xy;\n        c.xyw += dt * exp(-length2(p - m) / strength.x) * vec3(p - m + (velocity.xy * strength.y), 1);\n    }\n\n    // dissipation\n    c.w -= dt * 0.0005;\n\n    c.xyzw = clamp(c.xyzw, vec4(-5, -5, 0.5, 0), vec4(5, 5, 3, 5));\n\n    gl_FragColor = c;\n}\n",fragFluidView="#define GLSLIFY 1\n// Based on https://www.shadertoy.com/view/XlsBDf by davidar\n\nuniform float time;\nuniform vec2 resolution;\nuniform sampler2D texture;\n\n#define PI 3.141592653589793\n\nvoid main() {\n    vec4 c = texture2D(texture, gl_FragCoord.xy / resolution.xy);\n\n    // velocity\n    gl_FragColor.rgb = 0.6 + 0.6 * cos(6.3 * atan(c.y, c.x) / (2.0 * PI) + vec3(0, 23, 21));\n\n    // ink\n    gl_FragColor.rgb *= c.w / 5.0;\n\n    // local fluid density\n    gl_FragColor.rgb += clamp(c.z - 1.0, 0.0, 1.0) / 10.0;\n    gl_FragColor.a = 1.0;\n}\n";Config.UI_COLOR="white",Config.UI_OFFSET=Device.phone?10:20,Config.NAV_WIDTH=320,Config.ABOUT_COPY="Future web framework.",Config.ABOUT_HYDRA_URL="https://medium.com/@activetheory/mira-exploring-the-potential-of-the-future-web-e1f7f326d58e",Config.ABOUT_GITHUB_URL="https://github.com/pschroen/alien.js",Config.ASSETS=["assets/js/lib/three.min.js","assets/sounds/bass_drum.mp3","assets/sounds/deep_spacy_loop.mp3","assets/sounds/water_loop.mp3"],Config.EXAMPLES=[],Global.EXAMPLE_INDEX=0,Global.SOUND=!0,Global.ABOUT_OPEN=!1,Events.START="start",Events.UI_HIDE="ui_hide",Events.UI_SHOW="ui_show",Events.OPEN_NAV="open_nav",Events.CLOSE_NAV="close_nav",Events.OPEN_ABOUT="open_about",Events.CLOSE_ABOUT="close_about",Assets.CORS="anonymous",Assets.OPTIONS={mode:"cors"};class Cursor{static clear(){Stage.element.className=""}static grabbable(){Stage.element.className="grabbable"}static grabbing(){Stage.element.className="grabbing"}static pointer(){Stage.element.className="pointer"}}class Data{static init(){const e=this;function t(t){e.setExample(t.path)}this.dispatcher=Stage.initClass(StateDispatcher,!0),function(e=Config.EXAMPLES){for(let t=0;t<e.length;t++)e[t].index=t}(),Stage.events.add(e.dispatcher,Events.UPDATE,t),this.getExample=(e=>(function(e,t){for(let i=0;i<t.length;i++)if(t[i].path===e)return t[i];return null})(e,Config.EXAMPLES)),this.setExample=(e=>{const t=this.getExample(e);t&&(Global.EXAMPLE_INDEX=t.index,Stage.events.fire(Events.CLOSE_NAV),Stage.events.fire(Events.OPEN_NAV,{direction:-1,item:t}))}),this.getNext=(()=>{Global.EXAMPLE_INDEX++,Global.EXAMPLE_INDEX>Config.EXAMPLES.length-1&&(Global.EXAMPLE_INDEX=0);let e=Config.EXAMPLES[Global.EXAMPLE_INDEX];for(;!e.id&&""!==e.path;)Global.EXAMPLE_INDEX++,Global.EXAMPLE_INDEX>Config.EXAMPLES.length-1&&(Global.EXAMPLE_INDEX=0),e=Config.EXAMPLES[Global.EXAMPLE_INDEX];return e})}}class ExampleLoader extends Component{constructor(e){super();const t=this;function i(){t.events.fire(Events.COMPLETE)}window.get(`https://rawgit.com/pschroen/alien.js/master/${e.path}dist/assets/js/app.js?${Utils.timestamp()}`).then(t=>{window.eval(`(()=>{${t.replace("new Main;",`Global.EXAMPLE=Stage;Global.STAGE.add(Stage);Global.STAGE.element.insertBefore(Stage.element, Global.STAGE.element.firstChild);Assets.CDN='https://rawgit.com/pschroen/alien.js/master/${e.path}dist/';new Main;`)}})();`),Global.EXAMPLE.css({left:0,top:0}),i()}).catch(()=>{i()})}}class AudioController{static init(){const e=WebAudio.getSound("water_loop");let t=0,i=0,s=0,n=0;this.updatePosition=((e=Mouse.x,a=Mouse.y)=>{if(!WebAudio.context)return;const o=function(e,a,o){const r=Math.abs(e-s)+Math.abs(a-n),l=WebAudio.context.currentTime-i;return 0===l?t:(t+=r/l*.01,t*=o,i=WebAudio.context.currentTime,Math.abs(s-e)+Math.abs(n-a)>.2&&(t=0),s=e,n=a,t)}(e/Stage.width,a/Stage.height,.96);this.trigger("mouse_move",o,.8*(e/Stage.width*2-1),Math.abs(1-a/Stage.height))}),this.trigger=((t,...i)=>{switch(t){case"fluid_start":WebAudio.play("water_loop",0,!0),WebAudio.fadeInAndPlay("deep_spacy_loop",.71,!0,2e3,"linear");break;case"fluid_stop":WebAudio.fadeOutAndStop("water_loop",500,"linear"),WebAudio.fadeOutAndStop("deep_spacy_loop",500,"linear");break;case"mouse_move":e&&(TweenManager.tween(e.gain,{value:Math.clamp(i[0],0,1)},100,"linear"),e.stereoPan.value=Math.clamp(i[1],-1,1),e.playbackRate.value=Math.clamp(.8+i[2]/2.5,.8,1.2));break;case"about_section":TweenManager.tween(WebAudio.gain,{value:.3},1e3,"linear");break;case"fluid_section":TweenManager.tween(WebAudio.gain,{value:1},500,"linear");break;case"sound_off":TweenManager.tween(WebAudio.gain,{value:0},300,"linear");break;case"sound_on":TweenManager.tween(WebAudio.gain,{value:1},500,"linear")}}),this.mute=(()=>{this.trigger("sound_off")}),this.unmute=(()=>{this.trigger("sound_on")})}}class About extends Interface{constructor(){super("About");const e=this,t=[];let i,s,n;function a(){Stage.width<800?(i.transform({x:100}),t.forEach(e=>e.css({left:270}))):(i.transform({x:0}),t.forEach(e=>e.css({left:350})))}function o(e){Global.SOUND&&AudioController.mute(),setTimeout(()=>{const t=e.object.title.toLowerCase();getURL(~t.indexOf("source")?Config.ABOUT_GITHUB_URL:Config.ABOUT_HYDRA_URL)},300)}this.alpha=.07,e.size(800,430).center(),(i=e.create(".wrapper")).size(600,350).enable3D(2e3),i.rotationY=0,i.rotationX=0,(s=i.initClass(AlienKitty)).center().css({marginTop:-88}).transform({z:-20}),(n=e.create(".description")).size(260,50),n.fontStyle("Roboto Mono",11,Config.UI_COLOR),n.css({left:350,top:200,fontWeight:"400",lineHeight:18.7,letterSpacing:11*.03}),n.text(Config.ABOUT_COPY),t.push(n),["Source code","Inspiration"].forEach((i,s)=>{const n=e.create(".link");n.size("auto",20),n.fontStyle("Roboto Mono",11,Config.UI_COLOR),n.css({left:350,top:240+27*s,fontWeight:"400",lineHeight:18.7,letterSpacing:11*.03,textDecoration:"underline"}),n.text(i),n.interact(null,o),n.hit.mouseEnabled(!0),n.title=i,t.push(n)}),e.events.add(Events.RESIZE,a),a(),this.update=(()=>{Device.mobile?(i.rotationY+=(Accelerometer.x-i.rotationY)*this.alpha,i.rotationX+=(-Accelerometer.y-i.rotationX)*this.alpha):(i.rotationY+=(Math.range(Mouse.x,0,Stage.width,-5,5)-i.rotationY)*this.alpha,i.rotationX+=(-Math.range(Mouse.y,0,Stage.height,-10,10)-i.rotationX)*this.alpha),i.transform()}),this.animateIn=(()=>{s.ready().then(s.animateIn),t.forEach((e,t)=>e.transform({y:50}).css({opacity:0}).tween({y:0,opacity:e.hit?1:.75},1e3,"easeOutCubic",500+80*t))}),this.animateOut=(e=>{s.animateOut(),t.forEach((e,i)=>e.tween({y:20,opacity:0},500,"easeInCubic",40+40*(t.length-i))),this.delayedCall(e,1e3)})}}class Button extends Interface{constructor(){super("Button");const e=this,t={width:80,height:60,radius:24,posX:52,scale:1,littleCircleScale:0,lineWidth:0,multiTween:!0};let i,s,n,a,o,r;this.needsUpdate=!1,e.size(t.width,t.height),e.css({top:Config.UI_OFFSET+6,right:Config.UI_OFFSET+6,opacity:0}),i=e.initClass(Canvas,t.width,t.height,!0,!0),(s=e.initClass(CanvasGraphics)).x=t.posX,s.y=30,s.radius=9,s.fillStyle="#f00",(n=e.initClass(CanvasGraphics)).blendMode="source-out",n.lineWidth=1.5,n.strokeStyle=Config.UI_COLOR,i.add(s),i.add(n),(a=e.initClass(CanvasGraphics)).x=52,a.y=30,a.radius=t.radius,a.lineWidth=1.5,a.strokeStyle=Config.UI_COLOR,i.add(a),(o=e.initClass(CanvasGraphics)).x=t.posX,o.y=30,o.radius=5*t.littleCircleScale,o.lineWidth=1.5,o.strokeStyle=Config.UI_COLOR,i.add(o),this.update=(()=>{s.x=t.posX,s.clear(),s.beginPath(),s.arc(),s.fill(),n.clear(),n.beginPath(),n.moveTo(52,30),n.lineTo(52*(1-t.lineWidth),30),n.stroke(),a.radius=t.radius,a.clear(),a.beginPath(),a.arc(),a.stroke(),o.x=t.posX,o.radius=5*t.littleCircleScale,o.clear(),t.littleCircleScale>=0&&(o.beginPath(),o.arc(),o.stroke()),i.render()}),this.showButton=(()=>{Timer.clearTimeout(r),TweenManager.clearTween(t),t.posX=52,t.lineWidth=0,t.radius=0,t.scale=0,t.littleCircleScale=0,this.needsUpdate=!0,TweenManager.tween(t,{radius:24,scale:1,littleCircleScale:0},400,"easeOutCubic",()=>this.needsUpdate=!1),this.tween({opacity:1},400,"easeOutCubic")}),this.hideButton=(()=>{this.animatedIn=!1,Timer.clearTimeout(r),TweenManager.clearTween(t),t.posX=52,t.lineWidth=0,this.needsUpdate=!0,TweenManager.tween(t,{radius:0,scale:0,littleCircleScale:0},400,"easeOutCubic",()=>this.needsUpdate=!1),this.tween({opacity:0},400,"easeOutCubic")}),this.animateIn=(()=>{if(this.animatedIn)return;this.animatedIn=!0,Timer.clearTimeout(r),TweenManager.clearTween(t),this.needsUpdate=!0;const e=()=>{TweenManager.tween(t,{scale:0,littleCircleScale:1},400,"easeOutCubic"),TweenManager.tween(t,{lineWidth:1},600,"easeOutQuart",200),TweenManager.tween(t,{radius:18,posX:6},800,"easeOutQuart",()=>{TweenManager.tween(t,{radius:24,posX:52,spring:1,damping:.5},800,"easeOutElastic",500,()=>{r=this.delayedCall(()=>{this.animatedIn&&e()},500)})})};e()}),this.animateOut=(()=>{this.animatedIn=!1,Timer.clearTimeout(r),TweenManager.clearTween(t),this.needsUpdate=!0,TweenManager.tween(t,{posX:52,spring:1,damping:.5},600,"easeOutElastic"),TweenManager.tween(t,{radius:24,spring:1,damping:.5},400,"easeOutElastic",200),TweenManager.tween(t,{scale:1,littleCircleScale:0},400,"easeOutCubic",200),TweenManager.tween(t,{lineWidth:0},400,"easeOutQuart",200,()=>this.needsUpdate=!1)})}}class MuteButton extends Interface{constructor(){super("MuteButton");const e=this,t={points:["0.0048959479406107675,1.0192572485968008","0.7440789483408068,1.1424541571342257","1.3665350510328338,1.5722319717448148","1.8516030710118443,2.161114514098655","2.240878664481656,2.820613552436704","2.5676840288925646,3.514673473755097","2.852586758087085,4.227720074875111","3.1087495131409355,4.952019250371872","3.34491745226601,5.6833491709621455","3.567664418707203,6.419033113515608","3.7818384346752723,7.157364720628305","3.991883208559571,7.89692012231687","4.20161725978479,8.636571274379023","4.414765516613279,9.375206805563112","4.63544224654283,10.111540516820927","4.868521677309701,10.84389177472948","5.119915026729167,11.569934940861607","5.39761872371416,12.285923841396897","5.713181917701164,12.985402709853393","6.084405647772996,13.655730591437308","6.539749114583216,14.269197994950089","7.119419081486065,14.759057858970056","7.833381135450722,14.992018994281448","8.572728856296692,14.870293116359157","9.195338448495015,14.440785522641196","9.680208055209789,13.851743515423879","10.069105540383624,13.192016772217295","10.395484129094136,12.49774462805595","10.679967569881235,11.784536775684892","10.935718523820654,11.060079921712221","11.171497123710282,10.328625192177268","11.393877212794976,9.592821204379307","11.607714300578508,8.854391465042932","11.817437120864248,8.114743171200885","12.026879167662877,7.375006748905537","12.23976162559024,6.636291663928467","12.460198762144124,5.899884115317883","12.693064805060779,5.167449492656206","12.94425974121603,4.441348209381902","13.221791230462259,3.7252818987187086","13.537197191296478,3.0257489622651876","13.908222508104089,2.355292698961461","14.363251508608741,1.7415778212244037","14.942374903123344,1.2510267443085306","15.655824077518226,1.016232894445948","16.396796540942944,1.1306049293101161","17.02729399630583,1.5480186791997996","17.520961172283407,2.12932705736226","17.916597221147896,2.7848665081119037","18.247580495047032,3.4768520761875497","18.535159931485325,4.188764440295052","18.792722810328243,4.9125381796621195","19.029373679851147,5.6437213782868945","19.25191100208862,6.379463437982535","19.46526890312083,7.1180337064741765","19.673999657085446,7.8579706805470435","19.882131427610886,8.598101537217175","20.0932506280392,9.33733538914369","20.311684913718352,10.074372222547858","20.542181228403805,10.807581899228586","20.790759355659176,11.534616867737883","21.065453160862333,12.251819559078669","21.37769574040844,12.95281518967201","21.74512715658105,13.625332467857985","22.19607183875985,14.242202106038283","22.770556855267387,14.73847581597864","23.48079398096972,14.98341765723907","24.236808416010575,14.995504117332072"],width:24,height:16,progress:1,yMultiplier:1};let i,s,n;function a(i){e.animatedIn&&(TweenManager.clearTween(t),e.needsUpdate=!0,"over"===i.action?TweenManager.tween(t,{yMultiplier:Global.SOUND?.75:.25},275,"easeInOutCubic",()=>e.needsUpdate=!1):TweenManager.tween(t,{yMultiplier:Global.SOUND?1:0},275,"easeInOutCubic",()=>e.needsUpdate=!1))}function o(){Global.SOUND?(AudioController.mute(),Global.SOUND=!1,TweenManager.clearTween(t),e.needsUpdate=!0,TweenManager.tween(t,{yMultiplier:0},300,"easeOutCubic",()=>e.needsUpdate=!1)):(AudioController.unmute(),Global.SOUND=!0,TweenManager.clearTween(t),e.needsUpdate=!0,TweenManager.tween(t,{yMultiplier:1},300,"easeOutCubic",()=>e.needsUpdate=!1)),Storage.set("sound",Global.SOUND)}this.enabled=!0,this.needsUpdate=!1,e.size(t.width,t.height),e.css({left:Config.UI_OFFSET+10,bottom:Config.UI_OFFSET+10,opacity:0}),Global.SOUND||(t.yMultiplier=0),i=e.initClass(Canvas,t.width,t.height,!0,!0),(s=e.initClass(CanvasGraphics)).lineWidth=1.5,s.strokeStyle=Config.UI_COLOR,i.add(s),n=t.points.map(e=>e.split(",")),e.interact(a,o),e.hit.size(2*t.width,2*t.height).center(),this.update=(()=>{!function(){const e=n.length*t.progress;let i=!0;s.clear(),s.beginPath();for(let a=0;a<n.length;a++)e>=a&&(i?(i=!1,s.moveTo(n[a][0],Math.max(n[a][1]*t.yMultiplier+.5*t.height*(1-t.yMultiplier),1))):s.lineTo(n[a][0],Math.max(n[a][1]*t.yMultiplier+.5*t.height*(1-t.yMultiplier),1)));s.stroke()}(),i.render()}),this.showButton=(()=>{this.enabled&&(TweenManager.clearTween(t),t.progress=0,this.needsUpdate=!0,TweenManager.tween(t,{progress:1},1020,"easeInOutExpo",()=>{this.needsUpdate=!1,this.animatedIn=!0}),this.tween({opacity:1},400,"easeOutCubic"),this.mouseEnabled(!0))}),this.hideButton=(()=>{this.animatedIn=!1,this.mouseEnabled(!1),TweenManager.clearTween(t),this.needsUpdate=!0,TweenManager.tween(t,{progress:.94},1160,"easeInOutQuart",()=>this.needsUpdate=!1),this.tween({opacity:0},400,"easeOutCubic")})}}class FooterSide extends Interface{constructor(){super("FooterSide");const e=this;let t;e.css({position:"static"}).mouseEnabled(!1),(t=e.create(".title")).size("100%"),t.inner=t.create(".inner"),t.inner.fontStyle("Roboto Mono",11,Config.UI_COLOR),t.inner.css({top:-30,right:6,fontWeight:"400",lineHeight:15,letterSpacing:1,textTransform:"uppercase",whiteSpace:"nowrap"}),t.inner.text(Config.EXAMPLES[Global.EXAMPLE_INDEX].sideTitle),t.inner.element.style.transformOrigin="right center",t.inner.element.style.transform="rotate(-90deg) translateX(100%)",this.update=function(){t.tween({x:-10,opacity:0},300,"easeInSine",()=>{t.inner.text(Config.EXAMPLES[Global.EXAMPLE_INDEX].sideTitle),t.transform({x:10}).tween({x:0,opacity:1},1e3,"easeOutCubic")})}}}class FooterInfo extends Interface{constructor(){super("FooterInfo");const e=this;let t,i;e.css({position:"relative",display:"block",fontWeight:"400",lineHeight:15,letterSpacing:1,whiteSpace:"nowrap",cssFloat:"right"}),(t=e.create(".index")).fontStyle("Roboto Mono",11,Config.UI_COLOR),t.css({position:"relative",display:"block",cssFloat:"left"}),t.text(Utils.pad(Global.EXAMPLE_INDEX+1)),(i=e.create(".length")).fontStyle("Roboto Mono",11,Config.UI_COLOR),i.css({position:"relative",display:"block",cssFloat:"left"}),i.text(`/${Utils.pad(Config.EXAMPLES.length)}`),this.update=function(){t.tween({y:-10,opacity:0},300,"easeInSine",()=>{t.text(Utils.pad(Global.EXAMPLE_INDEX+1)),t.transform({y:10}).tween({y:0,opacity:1},1e3,"easeOutCubic")})}}}class Footer extends Interface{constructor(){super("Footer");const e=this;let t,i;e.css({left:Config.UI_OFFSET+10,right:Config.UI_OFFSET+10,bottom:Config.UI_OFFSET+10}),(t=e.initClass(FooterInfo)).update(),t.transform({x:-10}).css({opacity:0}).tween({x:0,opacity:1},1e3,"easeOutQuart",2700),(i=e.initClass(FooterSide)).transform({x:-10}).css({opacity:0}).tween({x:0,opacity:1},1e3,"easeOutQuart",2900),this.update=(()=>{t.update(),i.update()})}}class HeaderExample extends Interface{constructor(e){super(".HeaderExample");const t=this;let i,s;function n(e){t.animatedIn&&("over"===e.action?(i&&i.tween({scale:1.05,opacity:1},325,"easeOutCubic"),s&&s.tween({scaleX:1.25},275,"easeInOutCubic")):(i&&i.tween({scale:1,opacity:.35},325,"easeOutCubic"),s&&s.tween({scaleX:1},275,"easeInOutCubic")))}function a(){t.events.fire(Events.CLICK,{item:e})}e?e.id||e.path||""===e.path?(t.size("auto",15),t.css({position:"relative",display:"block",cssFloat:"left",clear:"left",padding:"5px 10px"}),(i=t.create(".header-info-source-text")).size("auto",15),i.fontStyle("Roboto Mono",11,Config.UI_COLOR),i.css({position:"relative",fontWeight:"400",lineHeight:15,letterSpacing:1,textTransform:"uppercase",whiteSpace:"nowrap",opacity:0}),i.text(e.title.toUpperCase()),i.transformPoint("left center"),i.size(),t.size(i.width,i.height),t.interact(n,a)):(t.size(40,15),t.css({position:"relative",display:"block",cssFloat:"left",clear:"left"}),(s=t.create(".header-info-source-line")).size(20,1).center(0,1),s.css({left:10,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.25)"}),s.transformPoint("left center").transform({scaleX:0})):(t.size("100%",35),t.css({position:"relative",display:"block",cssFloat:"left",clear:"left",cursor:"pointer"})),this.animateIn=(e=>{s&&s.transform({scaleX:0}).css({opacity:1}).tween({scaleX:1},550,"easeInOutCubic",e,()=>this.animatedIn=!0),i&&i.transform({scale:1.25}).tween({y:0,scale:1,opacity:.35},500,"easeOutQuart",e,()=>this.animatedIn=!0),t.transform({y:-10}).tween({y:0,opacity:1},325,"easeOutQuart",e)}),this.animateOut=((e,n,a,o)=>{this.animatedIn=!1,s&&s.tween({scaleX:0,opacity:0},450,"easeOutCubic",a),i&&i.tween({y:10,opacity:0},400,"easeOutCubic",a),t.tween({y:-10,opacity:0},650,"easeOutCubic",a,()=>{n===o&&e()})})}}class HeaderExamples extends Interface{constructor(){super("HeaderExamples");const e=this,t=[];let i=!1;function s(t){if("HeaderExample"!==t.target.className&&"HeaderExample"!==t.target.parentElement.className){if(!i)return;e.events.fire(Events.UPDATE),n()}}function n(){const s=()=>{e.hide(),i=!1,e.mouseEnabled(!1)};t.forEach((e,i)=>e.animateOut(s,i,50*(t.length-i),t.length-1))}function a(e){Data.setExample(e.item.path)}e.mouseEnabled(!1),function(){e.initClass(HeaderExample);let i=0,s=0;Assets.getData("data").examples.forEach(n=>{const o=e.initClass(HeaderExample,new Example(n));e.events.add(o,Events.CLICK,a),t.push(o),o.width>i&&(i=o.width),s+=o.height}),e.size(i+50,s+50)}(),e.bind("mouseleave",s),e.bind("touchend",s),this.animateIn=function(){i=!0,e.mouseEnabled(!0),e.show(),t.forEach((e,t)=>e.animateIn(100*t))},this.animateOut=n}}class HeaderExamplesButton extends Interface{constructor(e){super("HeaderExamplesButton");const t=this;let i,s,n,a=!1;function o(e){a||"over"===e.action&&(n.animateIn(),t.mouseEnabled(!1),s.forEach((e,t)=>{e.tween({y:-5,opacity:0},125,"easeOutCubic",15*t,()=>{e.transform({y:5}).tween({y:0,opacity:1},300,"easeOutCubic")})}),a=!0)}function r(){a=!1,t.mouseEnabled(!0)}t.css({position:"relative",display:"block",padding:10,cssFloat:"left"}),(i=t.create(".text")).fontStyle("Roboto Mono",11,Config.UI_COLOR),i.css({position:"relative",display:"block",fontWeight:"400",lineHeight:15,letterSpacing:1,textTransform:"uppercase",whiteSpace:"nowrap"}),i.text(e),s=i.split(),(n=t.initClass(HeaderExamples)).height>Stage.height&&t.hide(),t.interact(o,null),t.mouseEnabled(!0),t.events.add(n,Events.UPDATE,r),this.animateIn=(()=>{this.transform({x:-10}).css({opacity:0}).tween({x:0,opacity:1},450,"easeOutCubic",450)})}}class HeaderItem extends Interface{constructor(e){super("HeaderItem");const t=this;let i,s;function n(e){"over"===e.action&&s.forEach((e,t)=>{e.tween({y:-5,opacity:0},125,"easeOutCubic",15*t,()=>{e.transform({y:5}).tween({y:0,opacity:1},300,"easeOutCubic")})})}function a(){t.events.fire(Events.CLICK)}t.css({position:"relative",display:"block",padding:10,cssFloat:"left"}),(i=t.create(".text")).fontStyle("Roboto Mono",11,Config.UI_COLOR),i.css({position:"relative",display:"block",fontWeight:"400",lineHeight:15,letterSpacing:1,textTransform:"uppercase",whiteSpace:"nowrap"}),i.text(e),s=i.split(),t.interact(n,a),t.hit.mouseEnabled(!0)}}class Header extends Interface{constructor(){super("Header");const e=this;let t,i,s;function n(){e.events.fire(Events.OPEN_ABOUT)}function a(){Global.SOUND&&AudioController.mute(),setTimeout(()=>getURL(Config.ABOUT_GITHUB_URL),300)}e.size(260,"auto"),e.css({left:Config.UI_OFFSET,top:Config.UI_OFFSET}),(t=e.initClass(HeaderItem,"About")).transform({x:-10}).css({opacity:0}).tween({x:0,opacity:1},1e3,"easeOutQuart",2100),(i=e.initClass(HeaderExamplesButton,"Examples")).transform({x:-10}).css({opacity:0}).tween({x:0,opacity:1},1e3,"easeOutQuart",2300),(s=e.initClass(HeaderItem,"Source code")).transform({x:-10}).css({opacity:0}).tween({x:0,opacity:1},1e3,"easeOutQuart",2500),e.events.add(t,Events.CLICK,n),e.events.add(s,Events.CLICK,a)}}class NavBackground extends Interface{constructor(e,t,i,s){super(".NavBackground");const n=this,a=new Vector2,o={wobbly:1,expanded:0},r={position:0,scroll:0};let l,c,h,u=i-t,d=u<0?-1:1,p=!1,m=0;function g(){TweenManager.clearTween(r)}function f(){n.enabled&&(g(),m=0,n.tweening=!0,TweenManager.tween(o,{expanded:.15},2e3,"easeOutElastic"),Cursor.grabbing())}function v(){n.enabled&&(p=!0,m+=4*Mouse.input.delta.x,Cursor.grabbing())}function y(){if(!n.enabled)return;p=!1,m=0;const e=(()=>"android"===Device.os?35:25)();TweenManager.tween(o,{expanded:0},2e3,"easeOutElastic"),TweenManager.tween(r,{scroll:r.scroll+Mouse.input.delta.x*e},500,"easeOutQuint"),Cursor.clear()}this.enabled=!1,n.size(e,"100%").mouseEnabled(!1),l=n.initClass(Canvas,e,Stage.height,!0,!0),(c=n.initClass(CanvasGraphics)).fillStyle="#000",l.add(c),function(){h=[];for(let e=0;e<6;e++){const e=new Vector2;e.x=0,h.push(e)}}(),n.events.add(Mouse.input,Interaction.START,f),n.events.add(Mouse.input,Interaction.DRAG,v),n.events.add(Mouse.input,Interaction.END,y),this.startRender(function(){n.enabled&&(a.lerp(Mouse,.1),r.scroll+=.1*(m-r.scroll),Math.abs(r.scroll)<.001&&(r.scroll=0),r.position+=.1*(i-a.x-r.position),(d>0&&r.scroll>u||d<0&&r.scroll<u)&&n.events.fire(Events.OPEN_NAV,{direction:d}));let e=Math.clamp((r.position+r.scroll)/u,0,1.8);if((e=Interpolation.Sine.In(e))>0&&!n.animatedIn||n.tweening||n.redraw){for(let i=0;i<h.length;i++){let n=Math.abs(a.y-h[i].y)/Stage.height;n=Interpolation.Sine.In(n);const r=(Config.NAV_WIDTH*o.wobbly-120*n*o.wobbly)*e*d;h[i].x=t+r+s*o.expanded*d}(function(){let e;for(c.clear(),c.beginPath(),c.moveTo(h[0].x,h[0].y),e=1;e<h.length-2;e++){const t=(h[e].x+h[e+1].x)/2,i=(h[e].y+h[e+1].y)/2;c.quadraticCurveTo(h[e].x,h[e].y,t,i)}c.quadraticCurveTo(h[e].x,h[e].y,h[e+1].x,h[e+1].y)})(),c.lineTo(t,Stage.height),c.lineTo(t,0),c.lineTo(h[0].x,h[0].y),c.fill(),l.render(),n.redraw&&(n.redraw=!1)}}),this.resize=((n,a,o,r)=>{g(),e=n,s=r,d=(u=(i=o)-(t=a))<0?-1:1,this.size(e,"100%"),l.size(e,Stage.height);const c=Stage.height/(h.length-1);for(let e=0;e<h.length;e++)h[e].y=c*e,h[e].x=t;this.redraw=!0}),this.reset=(()=>{g(),this.animatedIn=!1,this.enabled=!1,p=!1,m=0,o.wobbly=1,o.expanded=0,r.position=0,r.scroll=0,this.redraw=!0}),this.animateIn=(e=>{g(),this.animatedIn=!0,this.enabled=!1,p=!1,this.tweening=!0,TweenManager.tween(o,{wobbly:0,expanded:1},e?800:2e3,e?"easeOutCubic":"easeOutElastic",()=>{this.tweening=!1,r.position=0,r.scroll=0,e&&e()})}),this.animateOut=(()=>{p||this.animatedIn||(g(),this.animatedIn=!1,this.enabled=!1,p=!1,m=0,this.tweening=!0,TweenManager.tween(o,{wobbly:1,expanded:0},400,"easeInCubic",()=>this.tweening=!1),TweenManager.tween(r,{position:0,scroll:0},400,"easeInCubic"))})}}class Nav extends Interface{constructor(){super("Nav");const e=this,t=1.5*Config.NAV_WIDTH;function i(){e.right.resize(Stage.width,Stage.width,Stage.width-t,Stage.width+100)}e.css({position:"static"}).mouseEnabled(!1),e.right=e.initClass(NavBackground,Stage.width,Stage.width,Stage.width-t,Stage.width+100),e.events.add(Events.RESIZE,i),i(),this.reset=(()=>{this.right.reset()})}}class UI extends Interface{static instance(){return this.singleton||(this.singleton=new UI),this.singleton}constructor(){super("UI");const e=this,t=[];let i,s,n,a;function o(t){if(e.animatedIn)return;const i=t.object;"over"===t.action||"click"===t.action?(i.noTap=!1,Timer.clearTimeout(i.delay),function(e){e.animateIn(),e.background.enabled=!0}(i),i.timer=e.delayedCall(()=>i.noTap=!0,500)):(Timer.clearTimeout(i.timer),i.noTap?r(i):i.delay=e.delayedCall(()=>r(i),500))}function r(e){e.animateOut(),e.background.animateOut()}function l(){t.forEach(e=>e.hideButton())}function c(){t.forEach(e=>e.showButton())}function h(){e.animatedIn||(e.animatedIn=!0,l(),Cursor.clear())}function u(){e.animatedIn&&(e.animatedIn=!1,i.animateOut(),c())}function d(){Global.ABOUT_OPEN=!0,a=e.initClass(About),n.tween({opacity:.85},2e3,"easeOutSine"),a.animateIn(),n.hit.show(),Global.SOUND&&AudioController.trigger("about_section")}function p(){n.hit.hide(),a&&a.animateOut(()=>{a&&(a=a.destroy()),Global.ABOUT_OPEN=!1}),n.tween({opacity:0},1e3,"easeOutSine"),Global.SOUND&&AudioController.trigger("fluid_section")}function m(e){27===e.keyCode&&p()}Stage.add(e),e.css({position:"static"}).mouseEnabled(!1),i=e.initClass(Nav),e.nav=i,e.initClass(Header),s=e.initClass(Footer),t.push(e.initClass(MuteButton)),t.push(e.initClass(Button)),t[1].background=i.right,(n=e.create(".bg")).size("100%").bg("#000").css({opacity:0}),n.interact(null,p),n.hit.css({cursor:""}),n.hit.mouseEnabled(!0),n.hit.hide(),t[1].interact(o,o),t[1].hit.css({cursor:""}),t[1].hit.mouseEnabled(!0),e.events.add(Events.UI_HIDE,l),e.events.add(Events.UI_SHOW,c),e.events.add(Events.OPEN_NAV,h),e.events.add(Events.CLOSE_NAV,u),e.events.add(Events.OPEN_ABOUT,d),e.events.add(Events.CLOSE_ABOUT,p),e.events.add(Events.KEYBOARD_UP,m),this.startRender(function(){a&&a.update();t.forEach(e=>{e.needsUpdate&&e.update()})}),this.update=(()=>{s.update()}),this.enableMuteButton=(()=>{t[0].enabled=!0}),this.disableMuteButton=(()=>{t[0].enabled=!1}),this.reset=(()=>{e.animatedIn=!1,i.reset()})}}class Fluid extends Component{constructor(){super();const e=this,t={isMove:!1,isDown:!1},i=new Vector2,s=new Vector2,n=new Vector2;let a,o,r,l,c,h,u,d,p,m;function g(){r.setSize(Stage.width*World.dpr,Stage.height*World.dpr),l.setSize(Stage.width*World.dpr,Stage.height*World.dpr)}function f(){t.isDown=!0,v()}function v(){!t.isMove&&e.animatedIn&&(t.isMove=!0),i.set(Mouse.x,Stage.height-Mouse.y),c.uniforms.last.value.copy(c.uniforms.mouse.value),c.uniforms.mouse.value.set(i.x/Stage.width,i.y/Stage.height)}function y(){t.isDown=!1}function b(){n.subVectors(i,s),s.copy(i),c.uniforms.velocity.value.copy(n);const e=Math.min(10,n.length())/10;c.uniforms.strength.value.set(!t.isMove||t.isDown?50:50*e,50*e),c.uniforms.texture.value=r.texture,a.render(u,o,l);const h=r;r=l,l=h,a.render(d,o),AudioController.updatePosition()}a=World.renderer,o=World.camera,function(){const e={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,wrapS:THREE.ClampToEdgeWrapping,wrapT:THREE.ClampToEdgeWrapping,format:THREE.RGBAFormat,type:"ios"===Device.os?THREE.HalfFloatType:THREE.FloatType,depthBuffer:!1,stencilBuffer:!1};r=new THREE.WebGLRenderTarget(Stage.width*World.dpr,Stage.height*World.dpr,e),l=new THREE.WebGLRenderTarget(Stage.width*World.dpr,Stage.height*World.dpr,e)}(),c=e.initClass(Shader,vertFluidBasic,fragFluidPass,{time:World.time,frame:World.frame,resolution:World.resolution,mouse:{value:new THREE.Vector2(Mouse.inverseNormal.x,Mouse.inverseNormal.y)},last:{value:new THREE.Vector2},velocity:{value:new THREE.Vector2},strength:{value:new THREE.Vector2},texture:{value:r.texture}}),u=new THREE.Scene,p=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),c.material),u.add(p),h=e.initClass(Shader,vertFluidBasic,fragFluidView,{time:World.time,resolution:World.resolution,texture:{value:r.texture}}),d=new THREE.Scene,m=new THREE.Mesh(new THREE.PlaneBufferGeometry(2,2),h.material),d.add(m),e.events.add(Events.RESIZE,g),e.events.add(Mouse.input,Interaction.START,f),e.events.add(Mouse.input,Interaction.MOVE,v),e.events.add(Mouse.input,Interaction.END,y),this.animateIn=(()=>{this.animatedIn=!0,this.startRender(b)}),this.destroy=(()=>(r&&r.dispose(),l&&l.dispose(),d.remove(m),m.geometry.dispose(),m.material.dispose(),u.remove(p),p.geometry.dispose(),p.material.dispose(),m=null,p=null,d=null,u=null,super.destroy()))}}class World extends Component{static instance(){return this.singleton||(this.singleton=new World),this.singleton}static destroy(){return this.singleton&&this.singleton.destroy(),Utils.nullObject(this)}constructor(){super();const e=this;let t,i;function s(){t.setSize(Stage.width,Stage.height),World.frame.value=0,World.resolution.value.set(Stage.width*World.dpr,Stage.height*World.dpr)}World.dpr=1,(t=new THREE.WebGLRenderer({powerPreference:"high-performance"})).setPixelRatio(World.dpr),i=new THREE.OrthographicCamera(-1,1,1,-1,0,1),World.renderer=t,World.element=t.domElement,World.camera=i,World.time={value:0},World.frame={value:0},World.resolution={value:new THREE.Vector2},e.events.add(Events.RESIZE,s),s(),this.startRender(function(e,t){World.time.value+=.001*t,World.frame.value++}),this.destroy=(()=>(t.dispose(),t.forceContextLoss(),t.context=null,t.domElement=null,i=null,t=null,Stage.remove(World.element),super.destroy()))}}class AlienKitty extends Interface{constructor(){super("AlienKitty");const e=this;let t,i,s;function n(){t.bg("assets/images/alienkitty.svg"),i.bg("assets/images/alienkitty_eyelid.svg"),s.bg("assets/images/alienkitty_eyelid.svg")}function a(){e.delayedCall(Utils.headsTails(o,r),Utils.random(0,1e4))}function o(){i.tween({scaleY:1.5},120,"easeOutCubic",()=>{i.tween({scaleY:.01},180,"easeOutCubic")}),s.tween({scaleX:1.3,scaleY:1.3},120,"easeOutCubic",()=>{s.tween({scaleX:1,scaleY:.01},180,"easeOutCubic",()=>{a()})})}function r(){i.tween({scaleY:1.5},120,"easeOutCubic",()=>{i.tween({scaleY:.01},180,"easeOutCubic")}),s.tween({scaleX:1.3,scaleY:1.3},180,"easeOutCubic",()=>{s.tween({scaleX:1,scaleY:.01},240,"easeOutCubic",()=>{a()})})}e.size(90,86).css({opacity:0}),t=e.create(".alienkitty").size(90,86),i=t.create(".eyelid1").size(24,14).css({left:35,top:25}).transformPoint("50%",0).transform({scaleX:1.5,scaleY:.01}),s=t.create(".eyelid2").size(24,14).css({left:53,top:26}).transformPoint(0,0).transform({scaleX:1,scaleY:.01}),this.animateIn=(()=>{a(),this.tween({opacity:1},1e3,"easeOutSine")}),this.animateOut=(e=>{this.tween({opacity:0},500,"easeInOutQuad",()=>{this.clearTimers(),e&&e()})}),this.ready=function(){return Promise.all([Assets.loadImage("assets/images/alienkitty.svg"),Assets.loadImage("assets/images/alienkitty_eyelid.svg")]).then(n)}}}class Loader extends Interface{constructor(){super("Loader");const e=this;let t,i,s;function n(t){TweenManager.tween(e,{progress:t.percent},2e3,"easeInOutSine",null,()=>{if(i.inner.text(Math.round(100*e.progress)),1===e.progress){const t=Data.dispatcher.getState(),n=Data.getExample(t.path);n&&""!==n.path?e.events.fire(Events.START,{item:n}):(e.events.fire(Events.COMPLETE),i.tween({opacity:0},200,"easeOutSine",()=>{i.hide(),s.transform({y:10}).css({opacity:0}).tween({y:0,opacity:1},1e3,"easeOutQuart",100),e.events.add(Mouse.input,Interaction.CLICK,a),e.delayedCall(()=>o((Device.mobile?"Tap":"Click")+" anywhere"),7e3),e.delayedCall(()=>o(Device.mobile?"Tap tap!":"Click!"),14e3)}))}})}function a(){e.events.remove(Mouse.input,Interaction.CLICK,a),e.events.fire(Events.START,{click:!0}),WebAudio.trigger("bass_drum")}function o(e){s.tween({y:-10,opacity:0},300,"easeInSine",()=>{s.inner.text(e),s.transform({y:10}).tween({y:0,opacity:1},1e3,"easeOutCubic")})}this.progress=0,e.css({position:"static"}),(t=e.initClass(AlienKitty)).center().css({marginTop:-108}),t.ready().then(t.animateIn),(i=e.create(".number")).size(150,25).center(),i.inner=i.create(".inner"),i.inner.fontStyle("Roboto Mono",11,Config.UI_COLOR),i.inner.css({width:"100%",fontWeight:"400",lineHeight:25,letterSpacing:1,textAlign:"center",whiteSpace:"nowrap",opacity:.35}),i.inner.text(""),(s=e.create(".title")).size(600,25).center().css({opacity:0}),s.inner=s.create(".inner"),s.inner.fontStyle("Roboto Mono",11,Config.UI_COLOR),s.inner.css({width:"100%",fontWeight:"400",lineHeight:25,letterSpacing:1,textAlign:"center",textTransform:"uppercase",whiteSpace:"nowrap",opacity:.35}),s.inner.text(Device.mobile?"Put on your headphones":"Turn up your speakers"),function(){const t=e.initClass(AssetLoader,Config.ASSETS);e.events.add(t,Events.PROGRESS,n)}(),this.animateOut=(e=>{i.tween({opacity:0},200,"easeOutSine"),s.tween({opacity:0},200,"easeOutSine"),t.animateOut(e)})}}class Example{constructor(e){this.id=e.id,this.path=this.id?`examples/${this.id}/`:e.path,this.title=e.title,this.pageTitle=`${this.title} / Alien.js Example`,this.description=e.description,this.sideTitle=this.description?`${this.title} / ${this.description}`:this.title}}class Main{constructor(){if(!Device.webgl)return window.location="fallback.html";let e,t,i,s=Stage.orientation;function n(){AudioController.init(),World.instance(),Stage.add(World),t=Stage.initClass(Fluid)}function a(i){e.animateOut(()=>{if(e=e.destroy(),i.click)t.animateIn(),Global.SOUND&&AudioController.trigger("fluid_start"),UI.instance(),Stage.delayedCall(()=>{Stage.events.fire(Events.UI_SHOW),Data.dispatcher.unlock()},1e3);else{let e=i.item;Global.EXAMPLE_INDEX=e.index,Stage.events.fire(Events.CLOSE_NAV),Stage.events.fire(Events.OPEN_NAV,{direction:-1,item:e})}})}function o(e){if(e.direction<0){Stage.loaded=!1,Stage.destroyed=!1,Data.dispatcher.lock();let s=e.item;s||(s=Data.getNext()),UI.instance().update(),""!==s.path?(i=Stage.initClass(ExampleLoader,s),Stage.events.add(i,Events.COMPLETE,r),UI.instance().disableMuteButton()):(Global.EXAMPLE=null,Stage.loaded=!0,UI.instance().enableMuteButton()),UI.instance().nav.right.animateIn(()=>{t&&(t=t.destroy()),World.singleton&&World.destroy(),Global.LAST_EXAMPLE&&Global.LAST_EXAMPLE.destroy(),AudioController.trigger&&AudioController.trigger("fluid_stop"),""===s.path&&(n(),t.animateIn(),Global.SOUND&&(AudioController.unmute(),AudioController.trigger("fluid_start"))),Stage.destroyed=!0,l()}),Data.dispatcher.setState(s.path),Data.dispatcher.setTitle(s.pageTitle),WebAudio.mute()}}function r(){i=i.destroy(),Stage.loaded=!0,l()}function l(){Stage.destroyed&&Stage.loaded&&(Global.LAST_EXAMPLE=Global.EXAMPLE,UI.instance().reset(),Stage.delayedCall(()=>{Stage.events.fire(Events.UI_SHOW),Data.dispatcher.unlock()},1e3))}function c(){s!==Stage.orientation&&location.reload()}function h(e){"blur"===e.type?WebAudio.mute():Global.SOUND&&(Global.ABOUT_OPEN?AudioController.trigger("about_section"):WebAudio.unmute())}WebAudio.init(),function(){const e=Storage.get("sound");Global.SOUND="boolean"!=typeof e||e,Global.SOUND||(WebAudio.gain.value=0)}(),Stage.size("100%"),Stage.transform({scale:1.3}).css({opacity:0}).tween({scale:1,opacity:1},3e3,"easeOutCubic",()=>{Stage.clearTransform(),Stage.clearOpacity()}),Mouse.init(),Accelerometer.init(),Global.STAGE=Stage,Promise.all([FontLoader.loadFonts(["Roboto Mono","Oswald","Karla"]),AssetLoader.loadAssets([`assets/data/data.json?${Utils.timestamp()}`])]).then(()=>{const t=Assets.getData("data").examples;t.forEach(e=>{(e.id||e.path||""===e.path)&&Config.EXAMPLES.push(new Example(e))}),Data.init(),Data.dispatcher.lock(),e=Stage.initClass(Loader),Stage.events.add(e,Events.COMPLETE,n)}),Stage.events.add(Events.START,a),Stage.events.add(Events.OPEN_NAV,o),Stage.events.add(Events.RESIZE,c),Stage.events.add(Events.VISIBILITY,h)}}new Main;
