!function(global,factory){"object"==typeof exports&&"undefined"!=typeof module?factory(exports):"function"==typeof define&&define.amd?define(["exports"],factory):factory(global.Alien=global.Alien||{})}(this,function(exports){"use strict";window.Events||(window.Events={BROWSER_FOCUS:"browser_focus",COMPLETE:"complete",PROGRESS:"progress",UPDATE:"update",LOADED:"loaded",ERROR:"error",RESIZE:"resize",HOVER:"hover",CLICK:"click"});class EventManager{constructor(){let events=[];this.add=((event,callback)=>{events.push({event:event,callback:callback})}),this.remove=((eventString,callback)=>{for(let i=events.length-1;i>-1;i--)events[i].event===eventString&&events[i].callback===callback&&events.splice(i,1)}),this.fire=((eventString,object={})=>{for(let i=0;i<events.length;i++)events[i].event===eventString&&events[i].callback(object)})}}window.events||(window.events=new EventManager),window.requestAnimationFrame||(window.requestAnimationFrame=(()=>window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||(callback=>{Delayed(callback,1e3/60)}))());class Render{constructor(){this.TIME=Date.now(),this.TARGET_FPS=60;let last,render=[],time=Date.now(),timeSinceRender=0,rendering=!1,focus=e=>{"focus"===e.type&&(last=Date.now())},step=()=>{let t=Date.now(),timeSinceLoad=t-time,diff=0,fps=60;last&&(fps=1e3/(diff=t-last));last=t;this.FPS=fps;this.TIME=t;this.DELTA=diff;this.TSL=timeSinceLoad;for(let i=render.length-1;i>-1;i--){let callback=render[i];if(callback){if(callback.fps){if((timeSinceRender+=diff>200?0:diff)<1e3/callback.fps)continue;timeSinceRender-=1e3/callback.fps}callback(t,timeSinceLoad,diff,fps,callback.frameCount++)}}render.length?window.requestAnimationFrame(step):(rendering=!1,window.events.remove(Events.BROWSER_FOCUS,focus))};this.start=((callback,fps)=>{this.TARGET_FPS<60&&(fps=this.TARGET_FPS);"number"==typeof fps&&(callback.fps=fps);callback.frameCount=0;-1===render.indexOf(callback)&&render.push(callback);render.length&&!rendering&&(rendering=!0,window.requestAnimationFrame(step),window.events.add(Events.BROWSER_FOCUS,focus))}),this.stop=(callback=>{let i=render.indexOf(callback);i>-1&&render.splice(i,1)})}}class Device{constructor(){this.agent=navigator.userAgent.toLowerCase(),this.prefix=(()=>{let pre="",dom="",styles=window.getComputedStyle(document.documentElement,"");pre=(Array.prototype.slice.call(styles).join("").match(/-(moz|webkit|ms)-/)||""===styles.OLink&&["","o"])[1];dom="WebKit|Moz|MS|O".match(new RegExp("("+pre+")","i"))[1];var IE=this.detect("trident");return{unprefixed:IE&&!this.detect("msie 9"),dom:dom,lowercase:pre,css:"-"+pre+"-",js:(IE?pre[0]:pre[0].toUpperCase())+pre.substr(1)}})(),this.transformProperty=(()=>{let pre;switch(this.prefix.lowercase){case"webkit":pre="-webkit-transform";break;case"moz":pre="-moz-transform";break;case"o":pre="-o-transform";break;case"ms":pre="-ms-transform";break;default:pre="transform"}return pre})(),this.system={},this.system.retina=window.devicePixelRatio>1}detect(array){"string"==typeof array&&(array=[array]);for(let i=0;i<array.length;i++)if(this.agent.indexOf(array[i])>-1)return!0;return!1}vendor(style){return this.prefix.js+style}}class Interpolation{constructor(){this.convertEase=(ease=>(()=>{let fn;switch(ease){case"easeInQuad":fn=this.Quad.In;break;case"easeInCubic":fn=this.Cubic.In;break;case"easeInQuart":fn=this.Quart.In;break;case"easeInQuint":fn=this.Quint.In;break;case"easeInSine":fn=this.Sine.In;break;case"easeInExpo":fn=this.Expo.In;break;case"easeInCirc":fn=this.Circ.In;break;case"easeInElastic":fn=this.Elastic.In;break;case"easeInBack":fn=this.Back.In;break;case"easeInBounce":fn=this.Bounce.In;break;case"easeOutQuad":fn=this.Quad.Out;break;case"easeOutCubic":fn=this.Cubic.Out;break;case"easeOutQuart":fn=this.Quart.Out;break;case"easeOutQuint":fn=this.Quint.Out;break;case"easeOutSine":fn=this.Sine.Out;break;case"easeOutExpo":fn=this.Expo.Out;break;case"easeOutCirc":fn=this.Circ.Out;break;case"easeOutElastic":fn=this.Elastic.Out;break;case"easeOutBack":fn=this.Back.Out;break;case"easeOutBounce":fn=this.Bounce.Out;break;case"easeInOutQuad":fn=this.Quad.InOut;break;case"easeInOutCubic":fn=this.Cubic.InOut;break;case"easeInOutQuart":fn=this.Quart.InOut;break;case"easeInOutQuint":fn=this.Quint.InOut;break;case"easeInOutSine":fn=this.Sine.InOut;break;case"easeInOutExpo":fn=this.Expo.InOut;break;case"easeInOutCirc":fn=this.Circ.InOut;break;case"easeInOutElastic":fn=this.Elastic.InOut;break;case"easeInOutBack":fn=this.Back.InOut;break;case"easeInOutBounce":fn=this.Bounce.InOut;break;case"linear":fn=this.Linear.None}return fn})()||this.Cubic.Out),this.Linear={None:k=>k},this.Quad={In:k=>k*k,Out:k=>k*(2-k),InOut:k=>{if((k*=2)<1)return.5*k*k;return-.5*(--k*(k-2)-1)}},this.Cubic={In:k=>k*k*k,Out:k=>--k*k*k+1,InOut:k=>{if((k*=2)<1)return.5*k*k*k;return.5*((k-=2)*k*k+2)}},this.Quart={In:k=>k*k*k*k,Out:k=>1- --k*k*k*k,InOut:k=>{if((k*=2)<1)return.5*k*k*k*k;return-.5*((k-=2)*k*k*k-2)}},this.Quint={In:k=>k*k*k*k*k,Out:k=>--k*k*k*k*k+1,InOut:k=>{if((k*=2)<1)return.5*k*k*k*k*k;return.5*((k-=2)*k*k*k*k+2)}},this.Sine={In:k=>1-Math.cos(k*Math.PI/2),Out:k=>Math.sin(k*Math.PI/2),InOut:k=>.5*(1-Math.cos(Math.PI*k))},this.Expo={In:k=>0===k?0:Math.pow(1024,k-1),Out:k=>1===k?1:1-Math.pow(2,-10*k),InOut:k=>{if(0===k)return 0;if(1===k)return 1;if((k*=2)<1)return.5*Math.pow(1024,k-1);return.5*(2-Math.pow(2,-10*(k-1)))}},this.Circ={In:k=>1-Math.sqrt(1-k*k),Out:k=>Math.sqrt(1- --k*k),InOut:k=>{if((k*=2)<1)return-.5*(Math.sqrt(1-k*k)-1);return.5*(Math.sqrt(1-(k-=2)*k)+1)}},this.Elastic={In:k=>{let s,a=.1,p=.4;if(0===k)return 0;if(1===k)return 1;!a||a<1?(a=1,s=.1):s=p*Math.asin(1/a)/(2*Math.PI);return-a*Math.pow(2,10*(k-=1))*Math.sin((k-s)*(2*Math.PI)/p)},Out:k=>{let s,a=.1,p=.4;if(0===k)return 0;if(1===k)return 1;!a||a<1?(a=1,s=.1):s=p*Math.asin(1/a)/(2*Math.PI);return a*Math.pow(2,-10*k)*Math.sin((k-s)*(2*Math.PI)/p)+1},InOut:k=>{let s,a=.1,p=.4;if(0===k)return 0;if(1===k)return 1;!a||a<1?(a=1,s=.1):s=p*Math.asin(1/a)/(2*Math.PI);if((k*=2)<1)return a*Math.pow(2,10*(k-=1))*Math.sin((k-s)*(2*Math.PI)/p)*-.5;return a*Math.pow(2,-10*(k-=1))*Math.sin((k-s)*(2*Math.PI)/p)*.5+1}},this.Back={In:k=>{let s=1.70158;return k*k*((s+1)*k-s)},Out:k=>{let s=1.70158;return--k*k*((s+1)*k+s)+1},InOut:k=>{let s=2.5949095;if((k*=2)<1)return k*k*((s+1)*k-s)*.5;return.5*((k-=2)*k*((s+1)*k+s)+2)}},this.Bounce={In:k=>1-this.Bounce.Out(1-k),Out:k=>k<1/2.75?7.5625*k*k:k<2/2.75?7.5625*(k-=1.5/2.75)*k+.75:k<2.5/2.75?7.5625*(k-=2.25/2.75)*k+.9375:7.5625*(k-=2.625/2.75)*k+.984375,InOut:k=>{if(k<.5)return.5*this.Bounce.In(2*k);return.5*this.Bounce.Out(2*k-1)+.5}}}}class MathTween{constructor(object,props,time,ease,delay,callback){function initMathTween(){TweenManager.clearTween(object),TweenManager.addMathTween(self),object.mathTween=self,ease=Interpolation.convertEase(ease),startTime=Date.now(),startTime+=delay,endValues=props,startValues={};for(let prop in endValues)"number"==typeof object[prop]&&(startValues[prop]=object[prop])}function clear(stop){if(object.mathTween=null,!stop)for(let prop in endValues)"number"==typeof endValues[prop]&&(object[prop]=endValues[prop]);TweenManager.removeMathTween(self)}let self=this,startTime,startValues,endValues,paused,elapsed;initMathTween(),this.update=(t=>{if(paused||t<startTime)return;elapsed=(t-startTime)/time;elapsed=elapsed>1?1:elapsed;let delta=ease(elapsed);for(let prop in startValues)if("number"==typeof startValues[prop]){let start=startValues[prop],end=endValues[prop];object[prop]=start+(end-start)*delta}1===elapsed&&(clear(),callback&&callback())}),this.pause=(()=>{paused=!0}),this.resume=(()=>{paused=!1;startTime=Date.now()-elapsed*time}),this.stop=(()=>clear(!0))}}class SpringTween{constructor(object,props,friction,ease,delay,callback){function initSpringTween(){TweenManager.clearTween(object),TweenManager.addMathTween(self),object.mathTween=self,startTime=Date.now(),startTime+=delay,endValues={},startValues={},velocityValues={},(props.x||props.y||props.z)&&(void 0===props.x&&(props.x=object.x),void 0===props.y&&(props.y=object.y),void 0===props.z&&(props.z=object.z)),count=0,damping=props.damping||.1,delete props.damping;for(let prop in props)"number"==typeof props[prop]&&(velocityValues[prop]=0,endValues[prop]=props[prop]);for(let prop in props)"number"==typeof object[prop]&&(startValues[prop]=object[prop]||0,props[prop]=startValues[prop])}function clear(stop){if(object.mathTween=null,!stop)for(let prop in endValues)"number"==typeof endValues[prop]&&(object[prop]=endValues[prop]);TweenManager.removeMathTween(self)}let self=this,startTime,velocityValues,endValues,startValues,damping,count,paused;initSpringTween(),this.update=(t=>{if(paused||t<startTime)return;let vel;for(let prop in startValues)if("number"==typeof startValues[prop]){let end=endValues[prop],val=props[prop],d=end-val,a=d*damping;velocityValues[prop]+=a,velocityValues[prop]*=friction,props[prop]+=velocityValues[prop],object[prop]=props[prop],vel=velocityValues[prop]}Math.abs(vel)<.001&&++count>30&&(clear(),callback&&callback())}),this.pause=(()=>{paused=!0}),this.stop=(()=>clear(!0))}}class TweenManager{constructor(){this.TRANSFORMS=["x","y","z","scale","scaleX","scaleY","rotation","rotationX","rotationY","rotationZ","skewX","skewY","perspective"],this.CSS_EASES={easeOutCubic:"cubic-bezier(0.215, 0.610, 0.355, 1.000)",easeOutQuad:"cubic-bezier(0.250, 0.460, 0.450, 0.940)",easeOutQuart:"cubic-bezier(0.165, 0.840, 0.440, 1.000)",easeOutQuint:"cubic-bezier(0.230, 1.000, 0.320, 1.000)",easeOutSine:"cubic-bezier(0.390, 0.575, 0.565, 1.000)",easeOutExpo:"cubic-bezier(0.190, 1.000, 0.220, 1.000)",easeOutCirc:"cubic-bezier(0.075, 0.820, 0.165, 1.000)",easeOutBack:"cubic-bezier(0.175, 0.885, 0.320, 1.275)",easeInCubic:"cubic-bezier(0.550, 0.055, 0.675, 0.190)",easeInQuad:"cubic-bezier(0.550, 0.085, 0.680, 0.530)",easeInQuart:"cubic-bezier(0.895, 0.030, 0.685, 0.220)",easeInQuint:"cubic-bezier(0.755, 0.050, 0.855, 0.060)",easeInSine:"cubic-bezier(0.470, 0.000, 0.745, 0.715)",easeInCirc:"cubic-bezier(0.600, 0.040, 0.980, 0.335)",easeInBack:"cubic-bezier(0.600, -0.280, 0.735, 0.045)",easeInOutCubic:"cubic-bezier(0.645, 0.045, 0.355, 1.000)",easeInOutQuad:"cubic-bezier(0.455, 0.030, 0.515, 0.955)",easeInOutQuart:"cubic-bezier(0.770, 0.000, 0.175, 1.000)",easeInOutQuint:"cubic-bezier(0.860, 0.000, 0.070, 1.000)",easeInOutSine:"cubic-bezier(0.445, 0.050, 0.550, 0.950)",easeInOutExpo:"cubic-bezier(1.000, 0.000, 0.000, 1.000)",easeInOutCirc:"cubic-bezier(0.785, 0.135, 0.150, 0.860)",easeInOutBack:"cubic-bezier(0.680, -0.550, 0.265, 1.550)",easeInOut:"cubic-bezier(0.420, 0.000, 0.580, 1.000)",linear:"linear"};let tweens=[],rendering=!1,updateTweens=t=>{if(tweens.length)for(let i=0;i<tweens.length;i++)tweens[i].update(t);else rendering=!1,Render.stop(updateTweens)};this.addMathTween=(tween=>{tweens.push(tween);rendering||(rendering=!0,Render.start(updateTweens))}),this.removeMathTween=(tween=>{let i=tweens.indexOf(tween);i>-1&&tweens.splice(i,1)})}tween(object,props,time,ease,delay,callback){"number"!=typeof delay&&(callback=delay,delay=0);let promise=null;"undefined"!=typeof Promise&&(promise=Promise.create(),callback&&promise.then(callback),callback=promise.resolve);let tween="spring"===ease?new SpringTween(object,props,time,ease,delay,callback):new MathTween(object,props,time,ease,delay,callback);return promise||tween}clearTween(object){object.mathTween&&object.mathTween.stop()}clearCSSTween(object){object.cssTween&&object.cssTween.stop()}checkTransform(key){return this.TRANSFORMS.indexOf(key)>-1}getEase(name){let eases=this.CSS_EASES;return eases[name]||eases.easeOutCubic}getAllTransforms(object){let obj={};for(let i=this.TRANSFORMS.length-1;i>-1;i--){let key=this.TRANSFORMS[i],val=object[key];0!==val&&"number"==typeof val&&(obj[key]=val)}return obj}parseTransform(props){let transforms="";if(void 0!==props.x||void 0!==props.y||void 0!==props.z){let x=props.x||0,y=props.y||0,z=props.z||0,translate="";translate+=x+"px, ",translate+=y+"px, ",transforms+="translate3d("+(translate+=z+"px")+")"}return void 0!==props.scale?transforms+="scale("+props.scale+")":(void 0!==props.scaleX&&(transforms+="scaleX("+props.scaleX+")"),void 0!==props.scaleY&&(transforms+="scaleY("+props.scaleY+")")),void 0!==props.rotation&&(transforms+="rotate("+props.rotation+"deg)"),void 0!==props.rotationX&&(transforms+="rotateX("+props.rotationX+"deg)"),void 0!==props.rotationY&&(transforms+="rotateY("+props.rotationY+"deg)"),void 0!==props.rotationZ&&(transforms+="rotateZ("+props.rotationZ+"deg)"),void 0!==props.skewX&&(transforms+="skewX("+props.skewX+"deg)"),void 0!==props.skewY&&(transforms+="skewY("+props.skewY+"deg)"),void 0!==props.perspective&&(transforms+="perspective("+props.perspective+"px)"),transforms}}class CSSTransition{constructor(object,props,time,ease,delay,callback){function initProperties(){for(let key in props)TweenManager.checkTransform(key)?(transform.use=!0,transform[key]=props[key],delete props[key]):("number"==typeof props[key]||key.indexOf("-")>-1)&&properties.push(key);transform.use&&properties.push(Device.transformProperty),delete transform.use}function initCSSTween(){TweenManager.clearCSSTween(object),object.cssTween=self;let transition="";for(let i=0;i<properties.length;i++)transition+=(transition.length?", ":"")+properties[i]+" "+time+"ms "+TweenManager.getEase(ease)+" "+delay+"ms";Delayed(()=>{object.element.style[Device.vendor("Transition")]=transition;object.css(props);object.transform(transform);Delayed(()=>{clear();callback&&callback()},time+delay)},50)}function clear(){object.element.style[Device.vendor("Transition")]="",object.cssTween=null}let self=this,transform=TweenManager.getAllTransforms(object),properties=[];initProperties(),initCSSTween(),this.stop=(()=>clear())}}class Interface{constructor(name,node){this.events=new EventManager;let stage=window.Alien&&window.Alien.Stage?window.Alien.Stage:document.body,element=node||document.createElement("div");"."===name[0]?element.className=name.substr(1):element.id=name,element.style.position="absolute",stage.appendChild(element),this.element=element,this.name=name}initClass(object,params){let child=new object(params);return child.element&&this.element.appendChild(child.element),child.parent=this,child}create(name,node){let child=new Interface(name,node);return this.element.appendChild(child.element),child.parent=this,child}destroy(){return this.loop&&Render.stop(this.loop),this.element.parentNode.removeChild(this.element),null}empty(){return this.element.innerHTML="",this}text(text){return void 0!==text?(this.element.textContent=text,this):this.element.textContent}html(text){return void 0!==text?(this.element.innerHTML=text,this):this.element.innerHTML}hide(){return this.element.style.display="none",this}show(){return this.element.style.display="",this}visible(){return this.element.style.visibility="visible",this}invisible(){return this.element.style.visibility="hidden",this}setZ(z){return this.element.style.zIndex=z,this}clearAlpha(){return this.element.style.opacity="",this}size(w,h){return void 0!==w&&(void 0===h&&(h=w),"string"==typeof w?("string"!=typeof h&&(h+="px"),this.element.style.width=w,this.element.style.height=h):(this.element.style.width=w+"px",this.element.style.height=h+"px",this.element.style.backgroundSize=w+"px "+h+"px")),this.width=this.element.offsetWidth,this.height=this.element.offsetHeight,this}enablePointer(bool){return this.element.style.pointerEvents=bool?"auto":"none",this}fontStyle(fontFamily,fontSize,color,fontStyle){return this.css({fontFamily:fontFamily,fontSize:fontSize,color:color,fontStyle:fontStyle}),this}bg(src,x,y,repeat){return-1===src.indexOf(".")?this.element.style.backgroundColor=src:this.element.style.backgroundImage="url("+src+")",void 0!==x&&(x="number"==typeof x?x+"px":x,y="number"==typeof y?y+"px":y,this.element.style.backgroundPosition=x+" "+y),repeat&&(this.element.style.backgroundSize="",this.element.style.backgroundRepeat=repeat),"cover"!==x&&"contain"!==x||(this.element.style.backgroundSize=x,this.element.style.backgroundRepeat="no-repeat",this.element.style.backgroundPosition=void 0!==y?y+" "+repeat:"center"),this}center(x,y,noPos){let css={};return void 0===x?(css.left="50%",css.top="50%",css.marginLeft=-this.width/2,css.marginTop=-this.height/2):(x&&(css.left="50%",css.marginLeft=-this.width/2),y&&(css.top="50%",css.marginTop=-this.height/2)),noPos&&(delete css.left,delete css.top),this.css(css),this}mask(src){return this.element.style[Device.vendor("Mask")]=(src.indexOf(".")>-1?"url("+src+")":src)+" no-repeat",this.element.style[Device.vendor("MaskSize")]="contain",this}blendMode(mode,bg){return this.element.style[bg?"background-blend-mode":"mix-blend-mode"]=mode,this}css(props,value){if("object"!=typeof props){if(value)return this.element.style[props]=value,this;{let style=this.element.style[props];return"number"!=typeof style&&(style.indexOf("px")>-1&&(style=Number(style.slice(0,-2))),"opacity"===props&&(style=isNaN(Number(this.element.style.opacity))?1:Number(this.element.style.opacity))),style||(style=0),style}}for(let key in props){let val=props[key];"string"!=typeof val&&"number"!=typeof val||("string"!=typeof val&&"opacity"!==key&&"zIndex"!==key&&(val+="px"),this.element.style[key]=val)}return this}transform(props){if(props)for(let key in props)"number"==typeof props[key]&&(this[key]=props[key]);else props=this;return this.element.style[Device.vendor("Transform")]=TweenManager.parseTransform(props),this}enable3D(perspective,x,y){return this.element.style[Device.vendor("TransformStyle")]="preserve-3d",perspective&&(this.element.style[Device.vendor("Perspective")]=perspective+"px"),void 0!==x&&(x="number"==typeof x?x+"px":x,y="number"==typeof y?y+"px":y,this.element.style[Device.vendor("PerspectiveOrigin")]=x+" "+y),this}disable3D(){return this.element.style[Device.vendor("TransformStyle")]="",this.element.style[Device.vendor("Perspective")]="",this}transformPoint(x,y,z){let origin="";return void 0!==x&&(origin+="number"==typeof x?x+"px ":x+" "),void 0!==y&&(origin+="number"==typeof y?y+"px ":y+" "),void 0!==z&&(origin+="number"==typeof z?z+"px":z),this.element.style[Device.vendor("TransformOrigin")]=origin,this}tween(props,time,ease,delay,callback){"number"!=typeof delay&&(callback=delay,delay=0);let promise=null;"undefined"!=typeof Promise&&(promise=Promise.create(),callback&&promise.then(callback),callback=promise.resolve);let tween=new CSSTransition(this,props,time,ease,delay,callback);return promise||tween}clearTransform(){return"number"==typeof this.x&&(this.x=0),"number"==typeof this.y&&(this.y=0),"number"==typeof this.z&&(this.z=0),"number"==typeof this.scale&&(this.scale=1),"number"==typeof this.scaleX&&(this.scaleX=1),"number"==typeof this.scaleY&&(this.scaleY=1),"number"==typeof this.rotation&&(this.rotation=0),"number"==typeof this.rotationX&&(this.rotationX=0),"number"==typeof this.rotationY&&(this.rotationY=0),"number"==typeof this.rotationZ&&(this.rotationZ=0),"number"==typeof this.skewX&&(this.skewX=0),"number"==typeof this.skewY&&(this.skewY=0),this.element.style[Device.transformProperty]="",this}stopTween(){return this.cssTween&&this.cssTween.stop(),this.mathTween&&this.mathTween.stop(),this}attr(attr,value){if(attr&&value)""===value?this.element.removeAttribute(attr):this.element.setAttribute(attr,value);else if(attr)return this.element.getAttribute(attr);return this}startRender(callback){this.loop=callback,Render.start(callback)}stopRender(callback){this.loop=null,Render.stop(callback)}click(callback){return this.element.addEventListener("click",e=>{e.object="hit"===this.element.className?this.parent:this;e.action="click";e.pageX||(e.pageX=e.clientX,e.pageY=e.clientY);callback&&callback(e)},!1),this.element.style.cursor="pointer",this}hover(callback){return this.element.addEventListener("mouseover",e=>{e.object="hit"===this.element.className?this.parent:this;e.action="over";callback&&callback(e)},!1),this.element.addEventListener("mouseout",e=>{e.object="hit"===this.element.className?this.parent:this;e.action="out";callback&&callback(e)},!1),this}interact(overCallback,clickCallback){this.hit=this.create(".hit").css({position:"absolute",left:0,top:0,width:"100%",height:"100%",zIndex:99999}).enablePointer(!0).hover(overCallback).click(clickCallback)}split(by=""){let style={position:"relative",display:"block",width:"auto",height:"auto",margin:0,padding:0,cssFloat:"left"},array=[],split=this.text().split(by);this.empty();for(let i=0;i<split.length;i++)" "===split[i]&&(split[i]="&nbsp;"),array.push(this.create(".t",document.createElement("span")).html(split[i]).css(style)),""!==by&&i<split.length-1&&array.push(this.create(".t",document.createElement("span")).html(by).css(style));return array}}class Canvas extends Interface{constructor(name,w,h){super(name,document.createElement("canvas")),this.context=this.element.getContext("2d");let ratio=Device.system.retina?2:1;this.element.width=w*ratio,this.element.height=h*ratio,this.size(w,h),this.context.scale(ratio,ratio)}toDataURL(type,quality){return this.element.toDataURL(type,quality)}getImageData(x=0,y=0,w=this.width,h=this.height){return this.imageData=this.context.getImageData(x,y,w,h),this.imageData}getPixel(x,y,dirty){this.imageData&&!dirty||this.getImageData(0,0,this.width,this.height);let imgData={},index=4*(x+y*this.width),pixels=this.imageData.data;return imgData.r=pixels[index],imgData.g=pixels[index+1],imgData.b=pixels[index+2],imgData.a=pixels[index+3],imgData}}class DynamicObject{constructor(props){for(let key in props)this[key]=props[key];this.lerp=((v,ratio)=>{for(let key in props)this[key]+=(v[key]-this[key])*ratio;return this})}}class Utils{rand(min,max){return new DynamicObject({v:min}).lerp({v:max},Math.random()).v}doRandom(min,max,precision){if("number"==typeof precision){let p=Math.pow(10,precision);return Math.round(this.rand(min,max)*p)/p}return Math.round(this.rand(min-.5,max+.5))}headsTails(heads,tails){return this.doRandom(0,1)?tails:heads}toDegrees(rad){return rad*(180/Math.PI)}toRadians(deg){return deg*(Math.PI/180)}findDistance(p1,p2){let dx=p2.x-p1.x,dy=p2.y-p1.y;return Math.sqrt(dx*dx+dy*dy)}timestamp(){return(Date.now()+this.doRandom(0,99999)).toString()}clamp(num,min,max){return Math.min(Math.max(num,min),max)}constrain(num,min,max){return Math.min(Math.max(num,Math.min(min,max)),Math.max(min,max))}convertRange(oldValue,oldMin,oldMax,newMin,newMax,constrain){let newValue=(oldValue-oldMin)*(newMax-newMin)/(oldMax-oldMin)+newMin;return constrain?this.constrain(newValue,newMin,newMax):newValue}cloneObject(object){return JSON.parse(JSON.stringify(object))}mergeObject(...objects){let object={};for(let obj of objects)for(let key in obj)object[key]=obj[key];return object}queryString(key){return decodeURI(window.location.search.replace(new RegExp("^(?:.*[&\\?]"+encodeURI(key).replace(/[\.\+\*]/g,"\\$&")+"(?:\\=([^&]*))?)?.*$","i"),"$1"))}}class Mouse{constructor(){this.x=0,this.y=0;let moved=e=>{this.x=e.x;this.y=e.y};this.capture=(()=>{this.x=0;this.y=0;window.addEventListener("mousemove",moved,!1)}),this.stop=(()=>{this.x=0;this.y=0;window.removeEventListener("mousemove",moved,!1)})}}class AssetLoader{constructor(assets,callback){function loadAsset(asset){let image=new Image;image.src=asset,image.onload=assetLoaded}function assetLoaded(){percent=++loaded/total,self.events.fire(Events.PROGRESS,{percent:percent}),loaded===total&&(self.complete=!0,self.events.fire(Events.COMPLETE),callback&&callback())}let self=this;this.events=new EventManager,this.CDN=Config.CDN||"";let total=assets.length,loaded=0,percent=0;for(let i=0;i<assets.length;i++)loadAsset(this.CDN+assets[i])}}class XHR{constructor(){this.headers={},this.options={};let serial=[],serialize=(key,data)=>{if("object"==typeof data)for(let i in data){let newKey=key+"["+i+"]";"object"==typeof data[i]?serialize(newKey,data[i]):serial.push(newKey+"="+data[i])}else serial.push(key+"="+data)};this.get=((url,data,callback,type)=>{if("function"==typeof data)type=callback,callback=data,data=null;else if("object"==typeof data){for(let key in data)serialize(key,data[key]);data=(data=(data=serial.join("&")).replace(/\[/g,"%5B")).replace(/\]/g,"%5D"),serial=null,url+="?"+data}let xhr=new XMLHttpRequest;xhr.open("GET",url,!0);"text"===type&&xhr.overrideMimeType("text/plain");"json"===type&&xhr.setRequestHeader("Accept","application/json");for(let key in this.headers)xhr.setRequestHeader(key,this.headers[key]);for(let key in this.options)xhr[key]=this.options[key];let promise=null;"undefined"!=typeof Promise&&(promise=Promise.create(),callback&&promise.then(callback),callback=promise.resolve);xhr.send();xhr.onreadystatechange=(()=>{if(4===xhr.readyState&&200===xhr.status){let data=xhr.responseText;if("text"===type)callback&&callback(data);else try{callback&&callback(JSON.parse(data))}catch(e){throw e}}0!=xhr.status&&400!=xhr.status&&401!=xhr.status&&404!=xhr.status&&500!=xhr.status||callback&&(promise?promise.reject(xhr):callback(xhr))});return promise||xhr}),this.post=((url,data,callback,type)=>{if("function"==typeof data)type=callback,callback=data,data=null;else if("object"==typeof data)if("json"===type)data=JSON.stringify(data);else{for(let key in data)serialize(key,data[key]);data=(data=(data=serial.join("&")).replace(/\[/g,"%5B")).replace(/\]/g,"%5D"),serial=null}let xhr=new XMLHttpRequest;xhr.open("POST",url,!0);"text"===type&&xhr.overrideMimeType("text/plain");"json"===type&&xhr.setRequestHeader("Accept","application/json");xhr.setRequestHeader("Content-Type","json"===type?"application/json":"application/x-www-form-urlencoded");for(let key in this.headers)xhr.setRequestHeader(key,this.headers[key]);for(let key in this.options)xhr[key]=this.options[key];let promise=null;"undefined"!=typeof Promise&&(promise=Promise.create(),callback&&promise.then(callback),callback=promise.resolve);xhr.send();xhr.onreadystatechange=(()=>{if(4===xhr.readyState&&200===xhr.status){let data=xhr.responseText;if("text"===type)callback&&callback(data);else try{callback&&callback(JSON.parse(data))}catch(e){throw e}}0!=xhr.status&&400!=xhr.status&&401!=xhr.status&&404!=xhr.status&&500!=xhr.status||callback&&(promise?promise.reject(xhr):callback(xhr))});return promise||xhr})}}class Stage extends Interface{constructor(){function initHTML(){self.css({overflow:"hidden"})}function addListeners(){window.addEventListener("focus",()=>{"focus"!==last&&(last="focus",window.events.fire(Events.BROWSER_FOCUS,{type:"focus"}))},!1),window.addEventListener("blur",()=>{"blur"!==last&&(last="blur",window.events.fire(Events.BROWSER_FOCUS,{type:"blur"}))},!1),window.addEventListener("resize",()=>{window.events.fire(Events.RESIZE)},!1),window.events.add(Events.RESIZE,resizeHandler)}function resizeHandler(){self.size()}super("Stage");let self=this,last;initHTML(),addListeners(),resizeHandler()}}"undefined"==typeof Promise||Promise.create||(Promise.create=(()=>{let resolve,reject,promise=new Promise((res,rej)=>{resolve=res;reject=rej});promise.resolve=resolve;promise.reject=reject;return promise})),window.getURL||(window.getURL=((url,target="_blank")=>window.open(url,target))),window.Delayed||(window.Delayed=((callback,time=0,params)=>window.setTimeout(()=>{callback&&callback(params)},time))),window.Global||(window.Global={}),window.Config||(window.Config={}),Function((()=>{let instances="";["Render","Utils","Device","Mouse","TweenManager","Interpolation","XHR","Stage"].forEach(i=>{instances+=`try {${i} = new ${i}();} catch(e) {}`});return instances})())(),exports.EventManager=EventManager,exports.Interface=Interface,exports.Canvas=Canvas,exports.Render=Render,exports.DynamicObject=DynamicObject,exports.Utils=Utils,exports.Device=Device,exports.Mouse=Mouse,exports.TweenManager=TweenManager,exports.Interpolation=Interpolation,exports.MathTween=MathTween,exports.SpringTween=SpringTween,exports.AssetLoader=AssetLoader,exports.XHR=XHR,exports.Stage=Stage,Object.defineProperty(exports,"__esModule",{value:!0})});
